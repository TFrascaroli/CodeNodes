{"version":3,"sources":["menu.ts"],"names":[],"mappings":";;AAEA,IAAM,SAAS,GAAG,4BAA4B,CAAC;AAE/C;IAKI,uBAAa,IAAe;QACxB,IAAI,IAAI,GAAG,IAAI,CAAC;QAChB,IAAI,OAAO,GAAW,IAAI,CAAC;QAC3B,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC;QACjB,IAAI,CAAC,CAAC,GAAG,QAAQ,CAAC,eAAe,CAAC,SAAS,EAAE,GAAG,CAAC,CAAC;QAClD,IAAI,CAAC,CAAC,CAAC,SAAS,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC;QAC/B,IAAI,aAAa,GAAW,IAAI,CAAC;QACjC,IAAI,KAAK,GAAG,QAAQ,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC;QAC1C,KAAK,CAAC,SAAS,CAAC,GAAG,CAAC,sBAAsB,CAAC,CAAC;QAC5C,IAAI,CAAC,KAAK,GAAG,KAAK,CAAC;QACnB,IAAI,UAAU,GAAG,QAAQ,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC;QAC/C,UAAU,CAAC,SAAS,CAAC,GAAG,CAAC,OAAO,CAAC,CAAC;QAClC,IAAI,YAAY,GAAG,QAAQ,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC;QACjD,YAAY,CAAC,SAAS,CAAC,GAAG,CAAC,SAAS,CAAC,CAAC;QACtC,IAAI,WAAW,GAAG,QAAQ,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC;QAChD,WAAW,CAAC,SAAS,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC;QACpC,IAAI,UAAU,GAAG,QAAQ,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC;QAC/C,UAAU,CAAC,SAAS,CAAC,GAAG,CAAC,OAAO,CAAC,CAAC;QAClC,IAAI,cAAc,GAAG,QAAQ,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC;QACnD,cAAc,CAAC,SAAS,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC;QACvC,IAAI,kBAAkB,GAAG,QAAQ,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC;QACvD,kBAAkB,CAAC,SAAS,CAAC,GAAG,CAAC,iBAAiB,CAAC,CAAC;QACpD,IAAI,UAAU,GAAG,QAAQ,CAAC,aAAa,CAAC,OAAO,CAAC,CAAC;QACjD,UAAU,CAAC,IAAI,GAAG,MAAM,CAAC;QACzB,IAAI,cAAc,GAAG,QAAQ,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC;QACnD,cAAc,CAAC,SAAS,CAAC,GAAG,CAAC,aAAa,CAAC,CAAC;QAC5C,IAAI,OAAO,GAAG,QAAQ,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC;QAC5C,OAAO,CAAC,SAAS,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC;QAE5B,KAAK,CAAC,WAAW,CAAC,UAAU,CAAC,CAAC;QAC9B,KAAK,CAAC,WAAW,CAAC,WAAW,CAAC,CAAC;QAC/B,WAAW,CAAC,WAAW,CAAC,YAAY,CAAC,CAAC;QACtC,cAAc,CAAC,WAAW,CAAC,UAAU,CAAC,CAAC;QACvC,YAAY,CAAC,WAAW,CAAC,cAAc,CAAC,CAAC;QACzC,kBAAkB,CAAC,WAAW,CAAC,cAAc,CAAC,CAAC;QAC/C,YAAY,CAAC,WAAW,CAAC,kBAAkB,CAAC,CAAC;QAC7C,YAAY,CAAC,WAAW,CAAC,OAAO,CAAC,CAAC;QAClC,QAAQ,CAAC,IAAI,CAAC,WAAW,CAAC,KAAK,CAAC,CAAC;QAEjC,OAAO,CAAC,gBAAgB,CAAC,OAAO,EAAE;YAC9B,IAAI,CAAC,KAAK,EAAE,CAAC;YACb,MAAM,CAAA,CAAC,OAAO,CAAC,CAAC,CAAC;gBACb,KAAK,MAAM;oBACP,IAAI,CAAC,OAAO,CAAC,UAAU,CAAC,KAAK,EAAE,aAAa,CAAC,CAAC;oBAClD,KAAK,CAAC;gBACN,KAAK,YAAY;oBACb,IAAI,CAAC,aAAa,CAAC,UAAU,CAAC,KAAK,EAAE,aAAa,CAAC,CAAC;oBACxD,KAAK,CAAC;YACV,CAAC;QACL,CAAC,CAAC,CAAC;QAEH;YACI,cAAc,CAAC,SAAS,GAAG,EAAE,CAAC;YAC9B,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,UAAU,CAAC;gBAC/B,IAAI,GAAG,GAAG,QAAQ,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC;gBACxC,GAAG,CAAC,SAAS,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC;gBAC5B,IAAI,IAAI,GAAG,QAAQ,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC;gBACzC,IAAI,IAAI,GAAG,QAAQ,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC;gBACzC,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC;gBAC3B,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC;gBAC3B,IAAI,CAAC,WAAW,GAAG,CAAC,CAAC,IAAI,CAAC;gBAC1B,IAAI,CAAC,WAAW,GAAG,CAAC,CAAC,WAAW,CAAC;gBACjC,GAAG,CAAC,WAAW,CAAC,IAAI,CAAC,CAAC;gBACtB,GAAG,CAAC,WAAW,CAAC,IAAI,CAAC,CAAC;gBACtB,GAAG,CAAC,gBAAgB,CAAC,OAAO,EAAE;oBAC1B,EAAE,CAAC,OAAO,CAAC,IAAI,CAAC,cAAc,CAAC,gBAAgB,CAAC,SAAS,CAAC,EAAE,UAAU,CAAC;wBACnE,CAAC,CAAC,SAAS,CAAC,MAAM,CAAC,UAAU,CAAC,CAAC;oBACnC,CAAC,CAAC,CAAC;oBACH,GAAG,CAAC,SAAS,CAAC,GAAG,CAAC,UAAU,CAAC,CAAC;oBAC9B,aAAa,GAAG,CAAC,CAAC,EAAE,CAAC;gBACzB,CAAC,CAAC,CAAC;gBACH,cAAc,CAAC,WAAW,CAAC,GAAG,CAAC,CAAC;YACpC,CAAC,CAAC,CAAC;QACP,CAAC;gCAEQ,CAAC;YACN,IAAI,IAAI,GAAG,QAAQ,CAAC,eAAe,CAAC,SAAS,EAAE,MAAM,CAAC,EAClD,CAAC,GAAG,QAAQ,CAAC,eAAe,CAAC,SAAS,EAAE,MAAM,CAAC,CAAC;YAChD,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC,WAAW,CAAC,CAAC;YAChC,CAAC,CAAC,SAAS,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC;YAC9B,IAAI,CAAC,YAAY,CAAC,GAAG,EAAE,CAAC,CAAC,CAAC,CAAC,QAAQ,EAAE,CAAC,CAAC;YACvC,IAAI,CAAC,YAAY,CAAC,GAAG,EAAE,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC,QAAQ,EAAE,CAAC,CAAC;YAC5C,CAAC,CAAC,YAAY,CAAC,GAAG,EAAE,CAAC,EAAE,CAAC,CAAC,QAAQ,EAAE,CAAC,CAAC;YACrC,CAAC,CAAC,YAAY,CAAC,GAAG,EAAE,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,GAAG,EAAE,CAAC,CAAC,QAAQ,EAAE,CAAC,CAAC;YAChD,IAAI,CAAC,CAAC,CAAC,WAAW,CAAC,IAAI,CAAC,CAAC;YACzB,IAAI,CAAC,CAAC,CAAC,WAAW,CAAC,CAAC,CAAC,CAAC;YAEtB,MAAM,CAAA,CAAC,CAAC,CAAC,CAAC,CAAC;gBACP,KAAK,CAAC;oBACF,CAAC,CAAC,WAAW,GAAG,UAAU,CAAC;oBAC3B,IAAI,CAAC,gBAAgB,CAAC,OAAO,EAAE,UAAU,GAAG;wBACxC,UAAU,CAAC,WAAW,GAAG,CAAC,CAAC,WAAW,CAAC;wBACvC,UAAU,CAAC,KAAK,GAAG,UAAU,CAAC;wBAC9B,UAAU,CAAC,KAAK,EAAE,CAAC;wBACnB,kBAAkB,EAAE,CAAC;wBACrB,OAAO,GAAG,MAAM,CAAC;wBACjB,KAAK,CAAC,SAAS,CAAC,GAAG,CAAC,SAAS,CAAC,CAAC;wBAC/B,GAAG,CAAC,eAAe,EAAE,CAAC;oBAC1B,CAAC,CAAC,CAAC;oBACP,KAAK,CAAC;gBACN,KAAK,CAAC;oBACF,CAAC,CAAC,WAAW,GAAG,gBAAgB,CAAC;oBACjC,IAAI,CAAC,gBAAgB,CAAC,OAAO,EAAE,UAAU,GAAG;wBACxC,UAAU,CAAC,WAAW,GAAG,CAAC,CAAC,WAAW,CAAC;wBACvC,UAAU,CAAC,KAAK,GAAG,gBAAgB,CAAC;wBACpC,UAAU,CAAC,KAAK,EAAE,CAAC;wBACnB,kBAAkB,EAAE,CAAC;wBACrB,OAAO,GAAG,YAAY,CAAC;wBACvB,KAAK,CAAC,SAAS,CAAC,GAAG,CAAC,SAAS,CAAC,CAAC;wBAC/B,GAAG,CAAC,eAAe,EAAE,CAAC;oBAC1B,CAAC,CAAC,CAAC;oBACP,KAAK,CAAC;gBACN,KAAK,CAAC;oBACF,CAAC,CAAC,WAAW,GAAG,QAAQ,CAAC;oBACzB,IAAI,CAAC,gBAAgB,CAAC,OAAO,EAAE,UAAU,GAAG;wBACxC,IAAI,CAAC,MAAM,EAAE,CAAC;wBACd,IAAI,CAAC,KAAK,EAAE,CAAC;wBACb,GAAG,CAAC,eAAe,EAAE,CAAC;oBAC1B,CAAC,CAAC,CAAC;oBACP,KAAK,CAAC;gBACN,KAAK,CAAC;oBACF,CAAC,CAAC,WAAW,GAAG,OAAO,CAAC;oBAC5B,KAAK,CAAC;YACV,CAAC;QACL,CAAC;QAjDD,GAAG,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,CAAC,EAAE,CAAC,EAAE;oBAAjB,CAAC;SAiDT;IACL,CAAC;IACD,4BAAI,GAAJ,UAAM,CAAS,EAAE,CAAS;QACtB,IAAI,CAAC,CAAC,CAAC,SAAS,CAAC,GAAG,CAAC,SAAS,CAAC,CAAC;QAChC,IAAI,CAAC,CAAC,CAAC,YAAY,CAAC,WAAW,EAAE,YAAY,GAAG,CAAC,CAAC,QAAQ,EAAE,GAAG,GAAG,GAAG,CAAC,CAAC,QAAQ,EAAE,GAAG,GAAG,CAAC,CAAA;QACxF,IAAI,CAAC,CAAC,CAAC,SAAS,CAAC,GAAG,CAAC,SAAS,CAAC,CAAC;IACpC,CAAC;IACD,6BAAK,GAAL;QACI,IAAI,CAAC,KAAK,CAAC,SAAS,CAAC,MAAM,CAAC,SAAS,CAAC,CAAC;QACvC,IAAI,CAAC,CAAC,CAAC,SAAS,CAAC,MAAM,CAAC,SAAS,CAAC,CAAC;IACvC,CAAC;IAEL,oBAAC;AAAD,CA7IA,AA6IC,IAAA;AA7IY,sCAAa","file":"menu.js","sourcesContent":["import {CodeNodes} from \"./codenodes\";\r\n\r\nconst namespace = \"http://www.w3.org/2000/svg\";\r\n\r\nexport class CodeNodesMenu {\r\n    public g: SVGGElement;\r\n    private main: CodeNodes;\r\n    private popup: HTMLDivElement;\r\n\r\n    constructor (main: CodeNodes) {\r\n        let self = this;\r\n        let addMode: string = null;\r\n        this.main = main;\r\n        this.g = document.createElementNS(namespace, \"g\");\r\n        this.g.classList.add(\"menu-g\");\r\n        let selectedValue: string = null;\r\n        let popup = document.createElement(\"div\");\r\n        popup.classList.add(\"codenodes-menu-popup\");\r\n        this.popup = popup;\r\n        let popupLayer = document.createElement(\"div\");\r\n        popupLayer.classList.add(\"layer\");\r\n        let popupContent = document.createElement(\"div\");\r\n        popupContent.classList.add(\"content\");\r\n        let popupWraper = document.createElement(\"div\");\r\n        popupWraper.classList.add(\"wraper\");\r\n        let popupTitle = document.createElement(\"div\");\r\n        popupTitle.classList.add(\"title\");\r\n        let entitySelector = document.createElement(\"div\");\r\n        entitySelector.classList.add(\"select\");\r\n        let entitySelectorWrap = document.createElement(\"div\");\r\n        entitySelectorWrap.classList.add(\"entity-selector\");\r\n        let entityName = document.createElement(\"input\");\r\n        entityName.type = \"text\";\r\n        let entityNameWrap = document.createElement(\"div\");\r\n        entityNameWrap.classList.add(\"entity-name\");\r\n        let popupOK = document.createElement(\"div\");\r\n        popupOK.classList.add(\"ok\");\r\n\r\n        popup.appendChild(popupLayer);\r\n        popup.appendChild(popupWraper);\r\n        popupWraper.appendChild(popupContent);\r\n        entityNameWrap.appendChild(entityName);\r\n        popupContent.appendChild(entityNameWrap);\r\n        entitySelectorWrap.appendChild(entitySelector);\r\n        popupContent.appendChild(entitySelectorWrap);\r\n        popupContent.appendChild(popupOK);\r\n        document.body.appendChild(popup);\r\n        \r\n        popupOK.addEventListener(\"click\", function () {\r\n            self.close();\r\n            switch(addMode) {\r\n                case \"node\":\r\n                    main.addNode(entityName.value, selectedValue);\r\n                break;\r\n                case \"collection\":\r\n                    main.addCollection(entityName.value, selectedValue);\r\n                break;\r\n            }\r\n        });\r\n\r\n        function fillEntitySelector () {\r\n            entitySelector.innerHTML = \"\";\r\n            self.main.types.forEach(function (t) {\r\n                let opt = document.createElement(\"div\");\r\n                opt.classList.add(\"option\");\r\n                let name = document.createElement(\"div\");\r\n                let desc = document.createElement(\"div\");\r\n                name.classList.add(\"name\");\r\n                desc.classList.add(\"desc\");\r\n                name.textContent = t.name;\r\n                desc.textContent = t.description;\r\n                opt.appendChild(name);\r\n                opt.appendChild(desc);\r\n                opt.addEventListener(\"click\", function () {\r\n                    [].forEach.call(entitySelector.querySelectorAll(\".option\"), function (o) {\r\n                        o.classList.remove(\"selected\");\r\n                    });\r\n                    opt.classList.add(\"selected\");\r\n                    selectedValue = t.id;\r\n                });\r\n                entitySelector.appendChild(opt);\r\n            });\r\n        }\r\n\r\n        for (let i = 0; i < 4; i++) {\r\n            let rect = document.createElementNS(namespace, \"rect\"),\r\n                t = document.createElementNS(namespace, \"text\");\r\n                rect.classList.add(\"menu-rect\");\r\n                t.classList.add(\"menu-t\");\r\n            rect.setAttribute(\"x\", (5).toString());\r\n            rect.setAttribute(\"y\", (35 * i).toString());\r\n            t.setAttribute(\"x\", (10).toString());\r\n            t.setAttribute(\"y\", ((35 * i) + 19).toString());\r\n            self.g.appendChild(rect);\r\n            self.g.appendChild(t);\r\n            \r\n            switch(i) {\r\n                case 0:\r\n                    t.textContent = \"Add node\";\r\n                    rect.addEventListener(\"click\", function (evt) {\r\n                        popupTitle.textContent = t.textContent;\r\n                        entityName.value = \"New node\";\r\n                        entityName.focus();\r\n                        fillEntitySelector();\r\n                        addMode = \"node\";\r\n                        popup.classList.add(\"visible\");\r\n                        evt.stopPropagation();\r\n                    });\r\n                break;\r\n                case 1:\r\n                    t.textContent = \"Add collection\";\r\n                    rect.addEventListener(\"click\", function (evt) {\r\n                        popupTitle.textContent = t.textContent;\r\n                        entityName.value = \"New collection\";\r\n                        entityName.focus();\r\n                        fillEntitySelector();\r\n                        addMode = \"collection\";\r\n                        popup.classList.add(\"visible\");\r\n                        evt.stopPropagation();\r\n                    });\r\n                break;\r\n                case 2:\r\n                    t.textContent = \"Center\";\r\n                    rect.addEventListener(\"click\", function (evt) {\r\n                        main.center();\r\n                        self.close();\r\n                        evt.stopPropagation();\r\n                    });\r\n                break;\r\n                case 3:\r\n                    t.textContent = \"Reset\";\r\n                break;\r\n            }\r\n        }\r\n    }\r\n    open (x: number, y: number) {\r\n        this.g.classList.add(\"visible\");\r\n        this.g.setAttribute(\"transform\", \"translate(\" + x.toString() + \",\" + y.toString() + \")\")\r\n        this.g.classList.add(\"visible\");\r\n    }\r\n    close () {\r\n        this.popup.classList.remove(\"visible\");\r\n        this.g.classList.remove(\"visible\");\r\n    }\r\n\r\n}"]}