{"version":3,"sources":["codenodes.min.js"],"names":["f","exports","module","define","amd","window","global","self","this","codenodes","e","t","n","r","s","o","u","a","require","i","Error","code","l","call","length","1","SvgPanZoom","./svg-pan-zoom.js","2","SvgUtils","enable","instance","defs","svg","querySelector","document","createElementNS","svgNS","appendChild","style","setAttribute","textContent","zoomGroup","width","height","_createZoomIn","_createZoomReset","_createZoomOut","controlIcons","zoomIn","addEventListener","getPublicInstance","zoomInBackground","zoomInShape","resetPanZoomControl","reset","resetPanZoomControlBackground","resetPanZoomControlShape1","resetPanZoomControlShape2","zoomOut","zoomOutBackground","zoomOutShape","disable","parentNode","removeChild","./svg-utilities","3","Utils","ShadowViewport","viewport","options","init","prototype","originalState","zoom","x","y","activeState","updateCTMCached","proxy","updateCTM","requestAnimationFrame","createRequestAnimationFrame","refreshRate","viewBox","cacheViewBox","newCTM","processCTM","setCTM","svgViewBox","getAttribute","viewBoxValues","split","filter","v","map","parseFloat","Math","min","updateCTMOnNextFrame","removeAttribute","simpleViewBoxCache","bBox","getBBox","getViewBox","extend","getCTM","fit","contain","newScale","max","d","center","offsetX","offsetY","getOriginalState","getState","getZoom","getRelativeZoom","computeRelativeZoom","scale","getPan","safeCTM","createSVGMatrix","b","c","willZoom","isZoomDifferent","willPan","isPanDifferent","beforeZoom","updateCache","onZoom","preventPan","beforePan","preventPanX","preventPanY","isObject","isNumber","onPan","pendingUpdate","ctm","onUpdatedCTM","./utilities","4","Wheel","ControlIcons","optionsDefaults","viewportSelector","panEnabled","controlIconsEnabled","zoomEnabled","dblClickZoomEnabled","mouseWheelZoomEnabled","preventMouseEventsDefault","zoomScaleSensitivity","minZoom","maxZoom","customEventsHandler","eventsListenerElement","that","setupSvgAttributes","state","boundingClientRectNormalized","getBoundingClientRectNormalized","getOrCreateViewport","oldScale","oldPoint","newPoint","point","publicInstance","setBeforeZoom","setOnZoom","setBeforePan","setOnPan","setOnUpdatedCTM","lastMouseWheelEventTime","Date","now","setupHandlers","prevEvt","eventListeners","mousedown","evt","target","SVGSVGElement","result","handleMouseDown","touchstart","mouseup","handleMouseUp","touchend","mousemove","handleMouseMove","touchmove","mouseleave","touchleave","touchcancel","svgElement","haltEventListeners","hasOwnProperty","event","enableMouseWheelZoom","wheelListener","handleMouseWheel","on","disableMouseWheelZoom","off","preventDefault","returnValue","delta","deltaY","timeDelta","divider","deltaMode","wheelDelta","abs","log","inversedScreenCTM","getScreenCTM","inverse","relativeMousePoint","getEventPoint","matrixTransform","pow","zoomAtPoint","zoomScale","zoomAbsolute","oldCTM","relativePoint","modifier","translate","multiply","absolute","getSvgCenterPoint","publicZoom","computeFromRelativeZoom","publicZoomAtPoint","getType","createSVGPoint","resetZoom","resetPan","pan","handleDblClick","indexOf","zoomFactor","shiftKey","mouseAndTouchNormalize","isDblClick","firstEventCTM","stateOrigin","viewportCTM","updateBBox","panBy","resize","disableControlIcons","enableControlIcons","destroy","removeEventListener","instancesStore","pi","enablePan","disablePan","isPanEnabled","fn","enableZoom","disableZoom","isZoomEnabled","isControlIconsEnabled","enableDblClickZoom","disableDblClickZoom","isDblClickZoomEnabled","isMouseWheelZoomEnabled","setZoomScaleSensitivity","setMinZoom","setMaxZoom","zoomBy","zoomAtPointBy","getSizes","realZoom","elementOrSelector","getSvg","push","./control-icons","./shadow-viewport","./uniwheel","5","_browser","documentMode","xmlNS","xmlnsNS","xlinkNS","evNS","clientWidth","clientHeight","getBoundingClientRect","selector","isElement","childNodes","Array","slice","children","el","nodeName","viewportId","toISOString","replace","svgChildren","classNames","join","setAttributeNS","toLowerCase","internetExplorerRedisplayInterval","refreshDefsGlobal","throttle","allDefs","querySelectorAll","allDefsCount","thisDefs","insertBefore","element","matrix","transform","setTimeout","clientX","clientY","6","createCallback","callback","capture","originalEvent","srcElement","type","deltaX","delatZ","support","wheelDeltaX","detail","fns","getCallback","removeCallback","splice","_addWheelListener","elem","eventName","useCapture","cb","_addEventListener","prefix","_removeWheelListener","_removeEventListener","createElement","undefined","onmousewheel","7","requestTimeout","timeout","source","prop","HTMLElement","SVGElement","nodeType","Object","toString","isNaN","isFinite","String","tagName","contentDocument","documentElement","getSVGDocument","context","apply","arguments","changedTouches","pageX","rect","left","pageY","top","timeStampDiff","timeStamp","touchesDistance","sqrt","getTime","func","wait","args","previous","later","leading","remaining","clearTimeout","trailing","floor","8","defineProperty","value","nodecanvas_1","menu_1","CodeNodes","types","nodesCount","canvas","NodeCanvas","menu","CodeNodesMenu","ondblclick","p","rawP","menuPoint","open","onclick","close","getSVG","render","g","collectionTypeOf","id","name","description","builder","collectionBuilder","clone","collectionClone","clonable","outputType","outputMultiple","schema","mode","multiple","addNode","title","isCollection","console","flatten","arr","reduce","flat","toFlatten","concat","isArray","addCollection","ofType","serialize","nodes","getTransform","./menu","./nodecanvas","9","namespace","main","fillEntitySelector","entitySelector","innerHTML","keys","forEach","opt","addMode","classList","add","popup","popupLayer","popupContent","popupWraper","popupTitle","entitySelectorWrap","entityName","entityNameWrap","popupOK","body","focus","stopPropagation","remove","10","nodevalue_1","Node","opts","values","position","nRows","onmousedown","outputConnectors","setValueDefaults","collectionValueOf","NodeValue","parent","outputOffset","rectDownHandler","Function","bind","output","outputDownHandler","outputMousedown","outputText","closeBtn","val","cloneLastValue","every","inputConnector","JSON","parse","stringify","newN","move","con","sp","setPath","updateConectorPosition","valueID","__internalGetValue","nodeTo","end2","valueTo","findValue","len","setValues","vs","__internalSetValue","build","built","valuesArr","getValue","onremove","./nodevalue","11","svgPanZoom","node_1","nodeconnector_1","paths","pt","draggingEntity","currentConnector","diff","zoomingSvg","cursorPoint","offset","convertCoords","setTransform","mouseMoveHandler","p1","mouseUpHandler","mouseMoveConnectorHandler","moveEndPoint","mouseUpConnectorHandler","dots","cc","candidates","dot","pos","parentValue","getDotPosition","dist","sort","candidateDot","end1","entity","parseInt","NodeConnector","path","entPos","ind","findNode","nm","cn","clear","node","getTerminalNodes","./node","./nodeconnector","svg-pan-zoom","12","ep","c1","c2","13","svgEntity","gOffset","ent","fo","name_1","div","input_1","checked","div_select_1","op","div_option","show","save","btn","popup_1","popupTextArea_1","name_2","getSerializedValue"],"mappings":"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","file":"codenodes.min.js","sourcesContent":["(function(f){if(typeof exports===\"object\"&&typeof module!==\"undefined\"){module.exports=f()}else if(typeof define===\"function\"&&define.amd){define([],f)}else{var g;if(typeof window!==\"undefined\"){g=window}else if(typeof global!==\"undefined\"){g=global}else if(typeof self!==\"undefined\"){g=self}else{g=this}g.codenodes = f()}})(function(){var define,module,exports;return (function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){\nvar SvgPanZoom = require('./svg-pan-zoom.js');\n\nmodule.exports = SvgPanZoom;\n\n},{\"./svg-pan-zoom.js\":4}],2:[function(require,module,exports){\nvar SvgUtils = require('./svg-utilities');\n\nmodule.exports = {\n  enable: function(instance) {\n    // Select (and create if necessary) defs\n    var defs = instance.svg.querySelector('defs')\n    if (!defs) {\n      defs = document.createElementNS(SvgUtils.svgNS, 'defs')\n      instance.svg.appendChild(defs)\n    }\n\n    // Check for style element, and create it if it doesn't exist\n    var styleEl = defs.querySelector('style#svg-pan-zoom-controls-styles');\n    if (!styleEl) {\n      var style = document.createElementNS(SvgUtils.svgNS, 'style')\n      style.setAttribute('id', 'svg-pan-zoom-controls-styles')\n      style.setAttribute('type', 'text/css')\n      style.textContent = '.svg-pan-zoom-control { cursor: pointer; fill: black; fill-opacity: 0.333; } .svg-pan-zoom-control:hover { fill-opacity: 0.8; } .svg-pan-zoom-control-background { fill: white; fill-opacity: 0.5; } .svg-pan-zoom-control-background { fill-opacity: 0.8; }'\n      defs.appendChild(style)\n    }\n\n    // Zoom Group\n    var zoomGroup = document.createElementNS(SvgUtils.svgNS, 'g');\n    zoomGroup.setAttribute('id', 'svg-pan-zoom-controls');\n    zoomGroup.setAttribute('transform', 'translate(' + ( instance.width - 70 ) + ' ' + ( instance.height - 76 ) + ') scale(0.75)');\n    zoomGroup.setAttribute('class', 'svg-pan-zoom-control');\n\n    // Control elements\n    zoomGroup.appendChild(this._createZoomIn(instance))\n    zoomGroup.appendChild(this._createZoomReset(instance))\n    zoomGroup.appendChild(this._createZoomOut(instance))\n\n    // Finally append created element\n    instance.svg.appendChild(zoomGroup)\n\n    // Cache control instance\n    instance.controlIcons = zoomGroup\n  }\n\n, _createZoomIn: function(instance) {\n    var zoomIn = document.createElementNS(SvgUtils.svgNS, 'g');\n    zoomIn.setAttribute('id', 'svg-pan-zoom-zoom-in');\n    zoomIn.setAttribute('transform', 'translate(30.5 5) scale(0.015)');\n    zoomIn.setAttribute('class', 'svg-pan-zoom-control');\n    zoomIn.addEventListener('click', function() {instance.getPublicInstance().zoomIn()}, false)\n    zoomIn.addEventListener('touchstart', function() {instance.getPublicInstance().zoomIn()}, false)\n\n    var zoomInBackground = document.createElementNS(SvgUtils.svgNS, 'rect'); // TODO change these background space fillers to rounded rectangles so they look prettier\n    zoomInBackground.setAttribute('x', '0');\n    zoomInBackground.setAttribute('y', '0');\n    zoomInBackground.setAttribute('width', '1500'); // larger than expected because the whole group is transformed to scale down\n    zoomInBackground.setAttribute('height', '1400');\n    zoomInBackground.setAttribute('class', 'svg-pan-zoom-control-background');\n    zoomIn.appendChild(zoomInBackground);\n\n    var zoomInShape = document.createElementNS(SvgUtils.svgNS, 'path');\n    zoomInShape.setAttribute('d', 'M1280 576v128q0 26 -19 45t-45 19h-320v320q0 26 -19 45t-45 19h-128q-26 0 -45 -19t-19 -45v-320h-320q-26 0 -45 -19t-19 -45v-128q0 -26 19 -45t45 -19h320v-320q0 -26 19 -45t45 -19h128q26 0 45 19t19 45v320h320q26 0 45 19t19 45zM1536 1120v-960 q0 -119 -84.5 -203.5t-203.5 -84.5h-960q-119 0 -203.5 84.5t-84.5 203.5v960q0 119 84.5 203.5t203.5 84.5h960q119 0 203.5 -84.5t84.5 -203.5z');\n    zoomInShape.setAttribute('class', 'svg-pan-zoom-control-element');\n    zoomIn.appendChild(zoomInShape);\n\n    return zoomIn\n  }\n\n, _createZoomReset: function(instance){\n    // reset\n    var resetPanZoomControl = document.createElementNS(SvgUtils.svgNS, 'g');\n    resetPanZoomControl.setAttribute('id', 'svg-pan-zoom-reset-pan-zoom');\n    resetPanZoomControl.setAttribute('transform', 'translate(5 35) scale(0.4)');\n    resetPanZoomControl.setAttribute('class', 'svg-pan-zoom-control');\n    resetPanZoomControl.addEventListener('click', function() {instance.getPublicInstance().reset()}, false);\n    resetPanZoomControl.addEventListener('touchstart', function() {instance.getPublicInstance().reset()}, false);\n\n    var resetPanZoomControlBackground = document.createElementNS(SvgUtils.svgNS, 'rect'); // TODO change these background space fillers to rounded rectangles so they look prettier\n    resetPanZoomControlBackground.setAttribute('x', '2');\n    resetPanZoomControlBackground.setAttribute('y', '2');\n    resetPanZoomControlBackground.setAttribute('width', '182'); // larger than expected because the whole group is transformed to scale down\n    resetPanZoomControlBackground.setAttribute('height', '58');\n    resetPanZoomControlBackground.setAttribute('class', 'svg-pan-zoom-control-background');\n    resetPanZoomControl.appendChild(resetPanZoomControlBackground);\n\n    var resetPanZoomControlShape1 = document.createElementNS(SvgUtils.svgNS, 'path');\n    resetPanZoomControlShape1.setAttribute('d', 'M33.051,20.632c-0.742-0.406-1.854-0.609-3.338-0.609h-7.969v9.281h7.769c1.543,0,2.701-0.188,3.473-0.562c1.365-0.656,2.048-1.953,2.048-3.891C35.032,22.757,34.372,21.351,33.051,20.632z');\n    resetPanZoomControlShape1.setAttribute('class', 'svg-pan-zoom-control-element');\n    resetPanZoomControl.appendChild(resetPanZoomControlShape1);\n\n    var resetPanZoomControlShape2 = document.createElementNS(SvgUtils.svgNS, 'path');\n    resetPanZoomControlShape2.setAttribute('d', 'M170.231,0.5H15.847C7.102,0.5,0.5,5.708,0.5,11.84v38.861C0.5,56.833,7.102,61.5,15.847,61.5h154.384c8.745,0,15.269-4.667,15.269-10.798V11.84C185.5,5.708,178.976,0.5,170.231,0.5z M42.837,48.569h-7.969c-0.219-0.766-0.375-1.383-0.469-1.852c-0.188-0.969-0.289-1.961-0.305-2.977l-0.047-3.211c-0.03-2.203-0.41-3.672-1.142-4.406c-0.732-0.734-2.103-1.102-4.113-1.102h-7.05v13.547h-7.055V14.022h16.524c2.361,0.047,4.178,0.344,5.45,0.891c1.272,0.547,2.351,1.352,3.234,2.414c0.731,0.875,1.31,1.844,1.737,2.906s0.64,2.273,0.64,3.633c0,1.641-0.414,3.254-1.242,4.84s-2.195,2.707-4.102,3.363c1.594,0.641,2.723,1.551,3.387,2.73s0.996,2.98,0.996,5.402v2.32c0,1.578,0.063,2.648,0.19,3.211c0.19,0.891,0.635,1.547,1.333,1.969V48.569z M75.579,48.569h-26.18V14.022h25.336v6.117H56.454v7.336h16.781v6H56.454v8.883h19.125V48.569z M104.497,46.331c-2.44,2.086-5.887,3.129-10.34,3.129c-4.548,0-8.125-1.027-10.731-3.082s-3.909-4.879-3.909-8.473h6.891c0.224,1.578,0.662,2.758,1.316,3.539c1.196,1.422,3.246,2.133,6.15,2.133c1.739,0,3.151-0.188,4.236-0.562c2.058-0.719,3.087-2.055,3.087-4.008c0-1.141-0.504-2.023-1.512-2.648c-1.008-0.609-2.607-1.148-4.796-1.617l-3.74-0.82c-3.676-0.812-6.201-1.695-7.576-2.648c-2.328-1.594-3.492-4.086-3.492-7.477c0-3.094,1.139-5.664,3.417-7.711s5.623-3.07,10.036-3.07c3.685,0,6.829,0.965,9.431,2.895c2.602,1.93,3.966,4.73,4.093,8.402h-6.938c-0.128-2.078-1.057-3.555-2.787-4.43c-1.154-0.578-2.587-0.867-4.301-0.867c-1.907,0-3.428,0.375-4.565,1.125c-1.138,0.75-1.706,1.797-1.706,3.141c0,1.234,0.561,2.156,1.682,2.766c0.721,0.406,2.25,0.883,4.589,1.43l6.063,1.43c2.657,0.625,4.648,1.461,5.975,2.508c2.059,1.625,3.089,3.977,3.089,7.055C108.157,41.624,106.937,44.245,104.497,46.331z M139.61,48.569h-26.18V14.022h25.336v6.117h-18.281v7.336h16.781v6h-16.781v8.883h19.125V48.569z M170.337,20.14h-10.336v28.43h-7.266V20.14h-10.383v-6.117h27.984V20.14z');\n    resetPanZoomControlShape2.setAttribute('class', 'svg-pan-zoom-control-element');\n    resetPanZoomControl.appendChild(resetPanZoomControlShape2);\n\n    return resetPanZoomControl\n  }\n\n, _createZoomOut: function(instance){\n    // zoom out\n    var zoomOut = document.createElementNS(SvgUtils.svgNS, 'g');\n    zoomOut.setAttribute('id', 'svg-pan-zoom-zoom-out');\n    zoomOut.setAttribute('transform', 'translate(30.5 70) scale(0.015)');\n    zoomOut.setAttribute('class', 'svg-pan-zoom-control');\n    zoomOut.addEventListener('click', function() {instance.getPublicInstance().zoomOut()}, false);\n    zoomOut.addEventListener('touchstart', function() {instance.getPublicInstance().zoomOut()}, false);\n\n    var zoomOutBackground = document.createElementNS(SvgUtils.svgNS, 'rect'); // TODO change these background space fillers to rounded rectangles so they look prettier\n    zoomOutBackground.setAttribute('x', '0');\n    zoomOutBackground.setAttribute('y', '0');\n    zoomOutBackground.setAttribute('width', '1500'); // larger than expected because the whole group is transformed to scale down\n    zoomOutBackground.setAttribute('height', '1400');\n    zoomOutBackground.setAttribute('class', 'svg-pan-zoom-control-background');\n    zoomOut.appendChild(zoomOutBackground);\n\n    var zoomOutShape = document.createElementNS(SvgUtils.svgNS, 'path');\n    zoomOutShape.setAttribute('d', 'M1280 576v128q0 26 -19 45t-45 19h-896q-26 0 -45 -19t-19 -45v-128q0 -26 19 -45t45 -19h896q26 0 45 19t19 45zM1536 1120v-960q0 -119 -84.5 -203.5t-203.5 -84.5h-960q-119 0 -203.5 84.5t-84.5 203.5v960q0 119 84.5 203.5t203.5 84.5h960q119 0 203.5 -84.5 t84.5 -203.5z');\n    zoomOutShape.setAttribute('class', 'svg-pan-zoom-control-element');\n    zoomOut.appendChild(zoomOutShape);\n\n    return zoomOut\n  }\n\n, disable: function(instance) {\n    if (instance.controlIcons) {\n      instance.controlIcons.parentNode.removeChild(instance.controlIcons)\n      instance.controlIcons = null\n    }\n  }\n}\n\n},{\"./svg-utilities\":5}],3:[function(require,module,exports){\nvar SvgUtils = require('./svg-utilities')\n  , Utils = require('./utilities')\n  ;\n\nvar ShadowViewport = function(viewport, options){\n  this.init(viewport, options)\n}\n\n/**\n * Initialization\n *\n * @param  {SVGElement} viewport\n * @param  {Object} options\n */\nShadowViewport.prototype.init = function(viewport, options) {\n  // DOM Elements\n  this.viewport = viewport\n  this.options = options\n\n  // State cache\n  this.originalState = {zoom: 1, x: 0, y: 0}\n  this.activeState = {zoom: 1, x: 0, y: 0}\n\n  this.updateCTMCached = Utils.proxy(this.updateCTM, this)\n\n  // Create a custom requestAnimationFrame taking in account refreshRate\n  this.requestAnimationFrame = Utils.createRequestAnimationFrame(this.options.refreshRate)\n\n  // ViewBox\n  this.viewBox = {x: 0, y: 0, width: 0, height: 0}\n  this.cacheViewBox()\n\n  // Process CTM\n  var newCTM = this.processCTM()\n\n  // Update viewport CTM and cache zoom and pan\n  this.setCTM(newCTM)\n\n  // Update CTM in this frame\n  this.updateCTM()\n}\n\n/**\n * Cache initial viewBox value\n * If no viewBox is defined, then use viewport size/position instead for viewBox values\n */\nShadowViewport.prototype.cacheViewBox = function() {\n  var svgViewBox = this.options.svg.getAttribute('viewBox')\n\n  if (svgViewBox) {\n    var viewBoxValues = svgViewBox.split(/[\\s\\,]/).filter(function(v){return v}).map(parseFloat)\n\n    // Cache viewbox x and y offset\n    this.viewBox.x = viewBoxValues[0]\n    this.viewBox.y = viewBoxValues[1]\n    this.viewBox.width = viewBoxValues[2]\n    this.viewBox.height = viewBoxValues[3]\n\n    var zoom = Math.min(this.options.width / this.viewBox.width, this.options.height / this.viewBox.height)\n\n    // Update active state\n    this.activeState.zoom = zoom\n    this.activeState.x = (this.options.width - this.viewBox.width * zoom) / 2\n    this.activeState.y = (this.options.height - this.viewBox.height * zoom) / 2\n\n    // Force updating CTM\n    this.updateCTMOnNextFrame()\n\n    this.options.svg.removeAttribute('viewBox')\n  } else {\n    this.simpleViewBoxCache()\n  }\n}\n\n/**\n * Recalculate viewport sizes and update viewBox cache\n */\nShadowViewport.prototype.simpleViewBoxCache = function() {\n  var bBox = this.viewport.getBBox()\n\n  this.viewBox.x = bBox.x\n  this.viewBox.y = bBox.y\n  this.viewBox.width = bBox.width\n  this.viewBox.height = bBox.height\n}\n\n/**\n * Returns a viewbox object. Safe to alter\n *\n * @return {Object} viewbox object\n */\nShadowViewport.prototype.getViewBox = function() {\n  return Utils.extend({}, this.viewBox)\n}\n\n/**\n * Get initial zoom and pan values. Save them into originalState\n * Parses viewBox attribute to alter initial sizes\n *\n * @return {CTM} CTM object based on options\n */\nShadowViewport.prototype.processCTM = function() {\n  var newCTM = this.getCTM()\n\n  if (this.options.fit || this.options.contain) {\n    var newScale;\n    if (this.options.fit) {\n      newScale = Math.min(this.options.width/this.viewBox.width, this.options.height/this.viewBox.height);\n    } else {\n      newScale = Math.max(this.options.width/this.viewBox.width, this.options.height/this.viewBox.height);\n    }\n\n    newCTM.a = newScale; //x-scale\n    newCTM.d = newScale; //y-scale\n    newCTM.e = -this.viewBox.x * newScale; //x-transform\n    newCTM.f = -this.viewBox.y * newScale; //y-transform\n  }\n\n  if (this.options.center) {\n    var offsetX = (this.options.width - (this.viewBox.width + this.viewBox.x * 2) * newCTM.a) * 0.5\n      , offsetY = (this.options.height - (this.viewBox.height + this.viewBox.y * 2) * newCTM.a) * 0.5\n\n    newCTM.e = offsetX\n    newCTM.f = offsetY\n  }\n\n  // Cache initial values. Based on activeState and fix+center opitons\n  this.originalState.zoom = newCTM.a\n  this.originalState.x = newCTM.e\n  this.originalState.y = newCTM.f\n\n  return newCTM\n}\n\n/**\n * Return originalState object. Safe to alter\n *\n * @return {Object}\n */\nShadowViewport.prototype.getOriginalState = function() {\n  return Utils.extend({}, this.originalState)\n}\n\n/**\n * Return actualState object. Safe to alter\n *\n * @return {Object}\n */\nShadowViewport.prototype.getState = function() {\n  return Utils.extend({}, this.activeState)\n}\n\n/**\n * Get zoom scale\n *\n * @return {Float} zoom scale\n */\nShadowViewport.prototype.getZoom = function() {\n  return this.activeState.zoom\n}\n\n/**\n * Get zoom scale for pubilc usage\n *\n * @return {Float} zoom scale\n */\nShadowViewport.prototype.getRelativeZoom = function() {\n  return this.activeState.zoom / this.originalState.zoom\n}\n\n/**\n * Compute zoom scale for pubilc usage\n *\n * @return {Float} zoom scale\n */\nShadowViewport.prototype.computeRelativeZoom = function(scale) {\n  return scale / this.originalState.zoom\n}\n\n/**\n * Get pan\n *\n * @return {Object}\n */\nShadowViewport.prototype.getPan = function() {\n  return {x: this.activeState.x, y: this.activeState.y}\n}\n\n/**\n * Return cached viewport CTM value that can be safely modified\n *\n * @return {SVGMatrix}\n */\nShadowViewport.prototype.getCTM = function() {\n  var safeCTM = this.options.svg.createSVGMatrix()\n\n  // Copy values manually as in FF they are not itterable\n  safeCTM.a = this.activeState.zoom\n  safeCTM.b = 0\n  safeCTM.c = 0\n  safeCTM.d = this.activeState.zoom\n  safeCTM.e = this.activeState.x\n  safeCTM.f = this.activeState.y\n\n  return safeCTM\n}\n\n/**\n * Set a new CTM\n *\n * @param {SVGMatrix} newCTM\n */\nShadowViewport.prototype.setCTM = function(newCTM) {\n  var willZoom = this.isZoomDifferent(newCTM)\n    , willPan = this.isPanDifferent(newCTM)\n\n  if (willZoom || willPan) {\n    // Before zoom\n    if (willZoom) {\n      // If returns false then cancel zooming\n      if (this.options.beforeZoom(this.getRelativeZoom(), this.computeRelativeZoom(newCTM.a)) === false) {\n        newCTM.a = newCTM.d = this.activeState.zoom\n        willZoom = false\n      } else {\n        this.updateCache(newCTM);\n        this.options.onZoom(this.getRelativeZoom())\n      }\n    }\n\n    // Before pan\n    if (willPan) {\n      var preventPan = this.options.beforePan(this.getPan(), {x: newCTM.e, y: newCTM.f})\n          // If prevent pan is an object\n        , preventPanX = false\n        , preventPanY = false\n\n      // If prevent pan is Boolean false\n      if (preventPan === false) {\n        // Set x and y same as before\n        newCTM.e = this.getPan().x\n        newCTM.f = this.getPan().y\n\n        preventPanX = preventPanY = true\n      } else if (Utils.isObject(preventPan)) {\n        // Check for X axes attribute\n        if (preventPan.x === false) {\n          // Prevent panning on x axes\n          newCTM.e = this.getPan().x\n          preventPanX = true\n        } else if (Utils.isNumber(preventPan.x)) {\n          // Set a custom pan value\n          newCTM.e = preventPan.x\n        }\n\n        // Check for Y axes attribute\n        if (preventPan.y === false) {\n          // Prevent panning on x axes\n          newCTM.f = this.getPan().y\n          preventPanY = true\n        } else if (Utils.isNumber(preventPan.y)) {\n          // Set a custom pan value\n          newCTM.f = preventPan.y\n        }\n      }\n\n      // Update willPan flag\n      // Check if newCTM is still different\n      if ((preventPanX && preventPanY) || !this.isPanDifferent(newCTM)) {\n        willPan = false\n      } else {\n        this.updateCache(newCTM);\n        this.options.onPan(this.getPan());\n      }\n    }\n\n    // Check again if should zoom or pan\n    if (willZoom || willPan) {\n      this.updateCTMOnNextFrame()\n    }\n  }\n}\n\nShadowViewport.prototype.isZoomDifferent = function(newCTM) {\n  return this.activeState.zoom !== newCTM.a\n}\n\nShadowViewport.prototype.isPanDifferent = function(newCTM) {\n  return this.activeState.x !== newCTM.e || this.activeState.y !== newCTM.f\n}\n\n\n/**\n * Update cached CTM and active state\n *\n * @param {SVGMatrix} newCTM\n */\nShadowViewport.prototype.updateCache = function(newCTM) {\n  this.activeState.zoom = newCTM.a\n  this.activeState.x = newCTM.e\n  this.activeState.y = newCTM.f\n}\n\nShadowViewport.prototype.pendingUpdate = false\n\n/**\n * Place a request to update CTM on next Frame\n */\nShadowViewport.prototype.updateCTMOnNextFrame = function() {\n  if (!this.pendingUpdate) {\n    // Lock\n    this.pendingUpdate = true\n\n    // Throttle next update\n    this.requestAnimationFrame.call(window, this.updateCTMCached)\n  }\n}\n\n/**\n * Update viewport CTM with cached CTM\n */\nShadowViewport.prototype.updateCTM = function() {\n  var ctm = this.getCTM()\n\n  // Updates SVG element\n  SvgUtils.setCTM(this.viewport, ctm, this.defs)\n\n  // Free the lock\n  this.pendingUpdate = false\n\n  // Notify about the update\n  if(this.options.onUpdatedCTM) {\n    this.options.onUpdatedCTM(ctm)\n  }\n}\n\nmodule.exports = function(viewport, options){\n  return new ShadowViewport(viewport, options)\n}\n\n},{\"./svg-utilities\":5,\"./utilities\":7}],4:[function(require,module,exports){\nvar Wheel = require('./uniwheel')\n, ControlIcons = require('./control-icons')\n, Utils = require('./utilities')\n, SvgUtils = require('./svg-utilities')\n, ShadowViewport = require('./shadow-viewport')\n\nvar SvgPanZoom = function(svg, options) {\n  this.init(svg, options)\n}\n\nvar optionsDefaults = {\n  viewportSelector: '.svg-pan-zoom_viewport' // Viewport selector. Can be querySelector string or SVGElement\n, panEnabled: true // enable or disable panning (default enabled)\n, controlIconsEnabled: false // insert icons to give user an option in addition to mouse events to control pan/zoom (default disabled)\n, zoomEnabled: true // enable or disable zooming (default enabled)\n, dblClickZoomEnabled: true // enable or disable zooming by double clicking (default enabled)\n, mouseWheelZoomEnabled: true // enable or disable zooming by mouse wheel (default enabled)\n, preventMouseEventsDefault: true // enable or disable preventDefault for mouse events\n, zoomScaleSensitivity: 0.1 // Zoom sensitivity\n, minZoom: 0.5 // Minimum Zoom level\n, maxZoom: 10 // Maximum Zoom level\n, fit: true // enable or disable viewport fit in SVG (default true)\n, contain: false // enable or disable viewport contain the svg (default false)\n, center: true // enable or disable viewport centering in SVG (default true)\n, refreshRate: 'auto' // Maximum number of frames per second (altering SVG's viewport)\n, beforeZoom: null\n, onZoom: null\n, beforePan: null\n, onPan: null\n, customEventsHandler: null\n, eventsListenerElement: null\n, onUpdatedCTM: null\n}\n\nSvgPanZoom.prototype.init = function(svg, options) {\n  var that = this\n\n  this.svg = svg\n  this.defs = svg.querySelector('defs')\n\n  // Add default attributes to SVG\n  SvgUtils.setupSvgAttributes(this.svg)\n\n  // Set options\n  this.options = Utils.extend(Utils.extend({}, optionsDefaults), options)\n\n  // Set default state\n  this.state = 'none'\n\n  // Get dimensions\n  var boundingClientRectNormalized = SvgUtils.getBoundingClientRectNormalized(svg)\n  this.width = boundingClientRectNormalized.width\n  this.height = boundingClientRectNormalized.height\n\n  // Init shadow viewport\n  this.viewport = ShadowViewport(SvgUtils.getOrCreateViewport(this.svg, this.options.viewportSelector), {\n    svg: this.svg\n  , width: this.width\n  , height: this.height\n  , fit: this.options.fit\n  , contain: this.options.contain\n  , center: this.options.center\n  , refreshRate: this.options.refreshRate\n  // Put callbacks into functions as they can change through time\n  , beforeZoom: function(oldScale, newScale) {\n      if (that.viewport && that.options.beforeZoom) {return that.options.beforeZoom(oldScale, newScale)}\n    }\n  , onZoom: function(scale) {\n      if (that.viewport && that.options.onZoom) {return that.options.onZoom(scale)}\n    }\n  , beforePan: function(oldPoint, newPoint) {\n      if (that.viewport && that.options.beforePan) {return that.options.beforePan(oldPoint, newPoint)}\n    }\n  , onPan: function(point) {\n      if (that.viewport && that.options.onPan) {return that.options.onPan(point)}\n    }\n  , onUpdatedCTM: function(ctm) {\n      if (that.viewport && that.options.onUpdatedCTM) {return that.options.onUpdatedCTM(ctm)}\n    }\n  })\n\n  // Wrap callbacks into public API context\n  var publicInstance = this.getPublicInstance()\n  publicInstance.setBeforeZoom(this.options.beforeZoom)\n  publicInstance.setOnZoom(this.options.onZoom)\n  publicInstance.setBeforePan(this.options.beforePan)\n  publicInstance.setOnPan(this.options.onPan)\n  publicInstance.setOnUpdatedCTM(this.options.onUpdatedCTM)\n\n  if (this.options.controlIconsEnabled) {\n    ControlIcons.enable(this)\n  }\n\n  // Init events handlers\n  this.lastMouseWheelEventTime = Date.now()\n  this.setupHandlers()\n}\n\n/**\n * Register event handlers\n */\nSvgPanZoom.prototype.setupHandlers = function() {\n  var that = this\n    , prevEvt = null // use for touchstart event to detect double tap\n    ;\n\n  this.eventListeners = {\n    // Mouse down group\n    mousedown: function(evt) {\n\t\tif (!(evt.target instanceof SVGSVGElement)) return;\n      var result = that.handleMouseDown(evt, prevEvt);\n      prevEvt = evt\n      return result;\n    }\n  , touchstart: function(evt) {\n\t\tif (!(evt.target instanceof SVGSVGElement)) return;\n      var result = that.handleMouseDown(evt, prevEvt);\n      prevEvt = evt\n      return result;\n    }\n\n    // Mouse up group\n  , mouseup: function(evt) {\n\t\tif (!(evt.target instanceof SVGSVGElement)) return;\n      return that.handleMouseUp(evt);\n    }\n  , touchend: function(evt) {\n\t\tif (!(evt.target instanceof SVGSVGElement)) return;\n      return that.handleMouseUp(evt);\n    }\n\n    // Mouse move group\n  , mousemove: function(evt) {\n\t\tif (!(evt.target instanceof SVGSVGElement)) return;\n      return that.handleMouseMove(evt);\n    }\n  , touchmove: function(evt) {\n\t\tif (!(evt.target instanceof SVGSVGElement)) return;\n      return that.handleMouseMove(evt);\n    }\n\n    // Mouse leave group\n  , mouseleave: function(evt) {\n\t\tif (!(evt.target instanceof SVGSVGElement)) return;\n      return that.handleMouseUp(evt);\n    }\n  , touchleave: function(evt) {\n\t\tif (!(evt.target instanceof SVGSVGElement)) return;\n      return that.handleMouseUp(evt);\n    }\n  , touchcancel: function(evt) {\n\t\tif (!(evt.target instanceof SVGSVGElement)) return;\n      return that.handleMouseUp(evt);\n    }\n  }\n\n  // Init custom events handler if available\n  if (this.options.customEventsHandler != null) { // jshint ignore:line\n    this.options.customEventsHandler.init({\n      svgElement: this.svg\n    , eventsListenerElement: this.options.eventsListenerElement\n    , instance: this.getPublicInstance()\n    })\n\n    // Custom event handler may halt builtin listeners\n    var haltEventListeners = this.options.customEventsHandler.haltEventListeners\n    if (haltEventListeners && haltEventListeners.length) {\n      for (var i = haltEventListeners.length - 1; i >= 0; i--) {\n        if (this.eventListeners.hasOwnProperty(haltEventListeners[i])) {\n          delete this.eventListeners[haltEventListeners[i]]\n        }\n      }\n    }\n  }\n\n  // Bind eventListeners\n  for (var event in this.eventListeners) {\n    // Attach event to eventsListenerElement or SVG if not available\n    (this.options.eventsListenerElement || this.svg)\n      .addEventListener(event, this.eventListeners[event], false)\n  }\n\n  // Zoom using mouse wheel\n  if (this.options.mouseWheelZoomEnabled) {\n    this.options.mouseWheelZoomEnabled = false // set to false as enable will set it back to true\n    this.enableMouseWheelZoom()\n  }\n}\n\n/**\n * Enable ability to zoom using mouse wheel\n */\nSvgPanZoom.prototype.enableMouseWheelZoom = function() {\n  if (!this.options.mouseWheelZoomEnabled) {\n    var that = this\n\n    // Mouse wheel listener\n    this.wheelListener = function(evt) {\n      return that.handleMouseWheel(evt);\n    }\n\n    // Bind wheelListener\n    Wheel.on(this.options.eventsListenerElement || this.svg, this.wheelListener, false)\n\n    this.options.mouseWheelZoomEnabled = true\n  }\n}\n\n/**\n * Disable ability to zoom using mouse wheel\n */\nSvgPanZoom.prototype.disableMouseWheelZoom = function() {\n  if (this.options.mouseWheelZoomEnabled) {\n    Wheel.off(this.options.eventsListenerElement || this.svg, this.wheelListener, false)\n    this.options.mouseWheelZoomEnabled = false\n  }\n}\n\n/**\n * Handle mouse wheel event\n *\n * @param  {Event} evt\n */\nSvgPanZoom.prototype.handleMouseWheel = function(evt) {\n  if (!this.options.zoomEnabled || this.state !== 'none') {\n    return;\n  }\n\n  if (this.options.preventMouseEventsDefault){\n    if (evt.preventDefault) {\n      evt.preventDefault();\n    } else {\n      evt.returnValue = false;\n    }\n  }\n\n  // Default delta in case that deltaY is not available\n  var delta = evt.deltaY || 1\n    , timeDelta = Date.now() - this.lastMouseWheelEventTime\n    , divider = 3 + Math.max(0, 30 - timeDelta)\n\n  // Update cache\n  this.lastMouseWheelEventTime = Date.now()\n\n  // Make empirical adjustments for browsers that give deltaY in pixels (deltaMode=0)\n  if ('deltaMode' in evt && evt.deltaMode === 0 && evt.wheelDelta) {\n    delta = evt.deltaY === 0 ? 0 :  Math.abs(evt.wheelDelta) / evt.deltaY\n  }\n\n  delta = -0.3 < delta && delta < 0.3 ? delta : (delta > 0 ? 1 : -1) * Math.log(Math.abs(delta) + 10) / divider\n\n  var inversedScreenCTM = this.svg.getScreenCTM().inverse()\n    , relativeMousePoint = SvgUtils.getEventPoint(evt, this.svg).matrixTransform(inversedScreenCTM)\n    , zoom = Math.pow(1 + this.options.zoomScaleSensitivity, (-1) * delta); // multiplying by neg. 1 so as to make zoom in/out behavior match Google maps behavior\n\n  this.zoomAtPoint(zoom, relativeMousePoint)\n}\n\n/**\n * Zoom in at a SVG point\n *\n * @param  {SVGPoint} point\n * @param  {Float} zoomScale    Number representing how much to zoom\n * @param  {Boolean} zoomAbsolute Default false. If true, zoomScale is treated as an absolute value.\n *                                Otherwise, zoomScale is treated as a multiplied (e.g. 1.10 would zoom in 10%)\n */\nSvgPanZoom.prototype.zoomAtPoint = function(zoomScale, point, zoomAbsolute) {\n  var originalState = this.viewport.getOriginalState()\n\n  if (!zoomAbsolute) {\n    // Fit zoomScale in set bounds\n    if (this.getZoom() * zoomScale < this.options.minZoom * originalState.zoom) {\n      zoomScale = (this.options.minZoom * originalState.zoom) / this.getZoom()\n    } else if (this.getZoom() * zoomScale > this.options.maxZoom * originalState.zoom) {\n      zoomScale = (this.options.maxZoom * originalState.zoom) / this.getZoom()\n    }\n  } else {\n    // Fit zoomScale in set bounds\n    zoomScale = Math.max(this.options.minZoom * originalState.zoom, Math.min(this.options.maxZoom * originalState.zoom, zoomScale))\n    // Find relative scale to achieve desired scale\n    zoomScale = zoomScale/this.getZoom()\n  }\n\n  var oldCTM = this.viewport.getCTM()\n    , relativePoint = point.matrixTransform(oldCTM.inverse())\n    , modifier = this.svg.createSVGMatrix().translate(relativePoint.x, relativePoint.y).scale(zoomScale).translate(-relativePoint.x, -relativePoint.y)\n    , newCTM = oldCTM.multiply(modifier)\n\n  if (newCTM.a !== oldCTM.a) {\n    this.viewport.setCTM(newCTM)\n  }\n}\n\n/**\n * Zoom at center point\n *\n * @param  {Float} scale\n * @param  {Boolean} absolute Marks zoom scale as relative or absolute\n */\nSvgPanZoom.prototype.zoom = function(scale, absolute) {\n  this.zoomAtPoint(scale, SvgUtils.getSvgCenterPoint(this.svg, this.width, this.height), absolute)\n}\n\n/**\n * Zoom used by public instance\n *\n * @param  {Float} scale\n * @param  {Boolean} absolute Marks zoom scale as relative or absolute\n */\nSvgPanZoom.prototype.publicZoom = function(scale, absolute) {\n  if (absolute) {\n    scale = this.computeFromRelativeZoom(scale)\n  }\n\n  this.zoom(scale, absolute)\n}\n\n/**\n * Zoom at point used by public instance\n *\n * @param  {Float} scale\n * @param  {SVGPoint|Object} point    An object that has x and y attributes\n * @param  {Boolean} absolute Marks zoom scale as relative or absolute\n */\nSvgPanZoom.prototype.publicZoomAtPoint = function(scale, point, absolute) {\n  if (absolute) {\n    // Transform zoom into a relative value\n    scale = this.computeFromRelativeZoom(scale)\n  }\n\n  // If not a SVGPoint but has x and y then create a SVGPoint\n  if (Utils.getType(point) !== 'SVGPoint') {\n    if('x' in point && 'y' in point) {\n      point = SvgUtils.createSVGPoint(this.svg, point.x, point.y)\n    } else {\n      throw new Error('Given point is invalid')\n    }\n  }\n\n  this.zoomAtPoint(scale, point, absolute)\n}\n\n/**\n * Get zoom scale\n *\n * @return {Float} zoom scale\n */\nSvgPanZoom.prototype.getZoom = function() {\n  return this.viewport.getZoom()\n}\n\n/**\n * Get zoom scale for public usage\n *\n * @return {Float} zoom scale\n */\nSvgPanZoom.prototype.getRelativeZoom = function() {\n  return this.viewport.getRelativeZoom()\n}\n\n/**\n * Compute actual zoom from public zoom\n *\n * @param  {Float} zoom\n * @return {Float} zoom scale\n */\nSvgPanZoom.prototype.computeFromRelativeZoom = function(zoom) {\n  return zoom * this.viewport.getOriginalState().zoom\n}\n\n/**\n * Set zoom to initial state\n */\nSvgPanZoom.prototype.resetZoom = function() {\n  var originalState = this.viewport.getOriginalState()\n\n  this.zoom(originalState.zoom, true);\n}\n\n/**\n * Set pan to initial state\n */\nSvgPanZoom.prototype.resetPan = function() {\n  this.pan(this.viewport.getOriginalState());\n}\n\n/**\n * Set pan and zoom to initial state\n */\nSvgPanZoom.prototype.reset = function() {\n  this.resetZoom()\n  this.resetPan()\n}\n\n/**\n * Handle double click event\n * See handleMouseDown() for alternate detection method\n *\n * @param {Event} evt\n */\nSvgPanZoom.prototype.handleDblClick = function(evt) {\n  if (this.options.preventMouseEventsDefault) {\n    if (evt.preventDefault) {\n      evt.preventDefault()\n    } else {\n      evt.returnValue = false\n    }\n  }\n\n  // Check if target was a control button\n  if (this.options.controlIconsEnabled) {\n    var targetClass = evt.target.getAttribute('class') || ''\n    if (targetClass.indexOf('svg-pan-zoom-control') > -1) {\n      return false\n    }\n  }\n\n  var zoomFactor\n\n  if (evt.shiftKey) {\n    zoomFactor = 1/((1 + this.options.zoomScaleSensitivity) * 2) // zoom out when shift key pressed\n  } else {\n    zoomFactor = (1 + this.options.zoomScaleSensitivity) * 2\n  }\n\n  var point = SvgUtils.getEventPoint(evt, this.svg).matrixTransform(this.svg.getScreenCTM().inverse())\n  this.zoomAtPoint(zoomFactor, point)\n}\n\n/**\n * Handle click event\n *\n * @param {Event} evt\n */\nSvgPanZoom.prototype.handleMouseDown = function(evt, prevEvt) {\n  if (this.options.preventMouseEventsDefault) {\n    if (evt.preventDefault) {\n      evt.preventDefault()\n    } else {\n      evt.returnValue = false\n    }\n  }\n\n  Utils.mouseAndTouchNormalize(evt, this.svg)\n\n  // Double click detection; more consistent than ondblclick\n  if (this.options.dblClickZoomEnabled && Utils.isDblClick(evt, prevEvt)){\n    this.handleDblClick(evt)\n  } else {\n    // Pan mode\n    this.state = 'pan'\n    this.firstEventCTM = this.viewport.getCTM()\n    this.stateOrigin = SvgUtils.getEventPoint(evt, this.svg).matrixTransform(this.firstEventCTM.inverse())\n  }\n}\n\n/**\n * Handle mouse move event\n *\n * @param  {Event} evt\n */\nSvgPanZoom.prototype.handleMouseMove = function(evt) {\n  if (this.options.preventMouseEventsDefault) {\n    if (evt.preventDefault) {\n      evt.preventDefault()\n    } else {\n      evt.returnValue = false\n    }\n  }\n\n  if (this.state === 'pan' && this.options.panEnabled) {\n    // Pan mode\n    var point = SvgUtils.getEventPoint(evt, this.svg).matrixTransform(this.firstEventCTM.inverse())\n      , viewportCTM = this.firstEventCTM.translate(point.x - this.stateOrigin.x, point.y - this.stateOrigin.y)\n\n    this.viewport.setCTM(viewportCTM)\n  }\n}\n\n/**\n * Handle mouse button release event\n *\n * @param {Event} evt\n */\nSvgPanZoom.prototype.handleMouseUp = function(evt) {\n  if (this.options.preventMouseEventsDefault) {\n    if (evt.preventDefault) {\n      evt.preventDefault()\n    } else {\n      evt.returnValue = false\n    }\n  }\n\n  if (this.state === 'pan') {\n    // Quit pan mode\n    this.state = 'none'\n  }\n}\n\n/**\n * Adjust viewport size (only) so it will fit in SVG\n * Does not center image\n */\nSvgPanZoom.prototype.fit = function() {\n  var viewBox = this.viewport.getViewBox()\n    , newScale = Math.min(this.width/viewBox.width, this.height/viewBox.height)\n\n  this.zoom(newScale, true)\n}\n\n/**\n * Adjust viewport size (only) so it will contain the SVG\n * Does not center image\n */\nSvgPanZoom.prototype.contain = function() {\n  var viewBox = this.viewport.getViewBox()\n    , newScale = Math.max(this.width/viewBox.width, this.height/viewBox.height)\n\n  this.zoom(newScale, true)\n}\n\n/**\n * Adjust viewport pan (only) so it will be centered in SVG\n * Does not zoom/fit/contain image\n */\nSvgPanZoom.prototype.center = function() {\n  var viewBox = this.viewport.getViewBox()\n    , offsetX = (this.width - (viewBox.width + viewBox.x * 2) * this.getZoom()) * 0.5\n    , offsetY = (this.height - (viewBox.height + viewBox.y * 2) * this.getZoom()) * 0.5\n\n  this.getPublicInstance().pan({x: offsetX, y: offsetY})\n}\n\n/**\n * Update content cached BorderBox\n * Use when viewport contents change\n */\nSvgPanZoom.prototype.updateBBox = function() {\n  this.viewport.simpleViewBoxCache()\n}\n\n/**\n * Pan to a rendered position\n *\n * @param  {Object} point {x: 0, y: 0}\n */\nSvgPanZoom.prototype.pan = function(point) {\n  var viewportCTM = this.viewport.getCTM()\n  viewportCTM.e = point.x\n  viewportCTM.f = point.y\n  this.viewport.setCTM(viewportCTM)\n}\n\n/**\n * Relatively pan the graph by a specified rendered position vector\n *\n * @param  {Object} point {x: 0, y: 0}\n */\nSvgPanZoom.prototype.panBy = function(point) {\n  var viewportCTM = this.viewport.getCTM()\n  viewportCTM.e += point.x\n  viewportCTM.f += point.y\n  this.viewport.setCTM(viewportCTM)\n}\n\n/**\n * Get pan vector\n *\n * @return {Object} {x: 0, y: 0}\n */\nSvgPanZoom.prototype.getPan = function() {\n  var state = this.viewport.getState()\n\n  return {x: state.x, y: state.y}\n}\n\n/**\n * Recalculates cached svg dimensions and controls position\n */\nSvgPanZoom.prototype.resize = function() {\n  // Get dimensions\n  var boundingClientRectNormalized = SvgUtils.getBoundingClientRectNormalized(this.svg)\n  this.width = boundingClientRectNormalized.width\n  this.height = boundingClientRectNormalized.height\n\n  // Recalculate original state\n  var viewport = this.viewport\n  viewport.options.width = this.width\n  viewport.options.height = this.height\n  viewport.processCTM()\n\n  // Reposition control icons by re-enabling them\n  if (this.options.controlIconsEnabled) {\n    this.getPublicInstance().disableControlIcons()\n    this.getPublicInstance().enableControlIcons()\n  }\n}\n\n/**\n * Unbind mouse events, free callbacks and destroy public instance\n */\nSvgPanZoom.prototype.destroy = function() {\n  var that = this\n\n  // Free callbacks\n  this.beforeZoom = null\n  this.onZoom = null\n  this.beforePan = null\n  this.onPan = null\n  this.onUpdatedCTM = null\n\n  // Destroy custom event handlers\n  if (this.options.customEventsHandler != null) { // jshint ignore:line\n    this.options.customEventsHandler.destroy({\n      svgElement: this.svg\n    , eventsListenerElement: this.options.eventsListenerElement\n    , instance: this.getPublicInstance()\n    })\n  }\n\n  // Unbind eventListeners\n  for (var event in this.eventListeners) {\n    (this.options.eventsListenerElement || this.svg)\n      .removeEventListener(event, this.eventListeners[event], false)\n  }\n\n  // Unbind wheelListener\n  this.disableMouseWheelZoom()\n\n  // Remove control icons\n  this.getPublicInstance().disableControlIcons()\n\n  // Reset zoom and pan\n  this.reset()\n\n  // Remove instance from instancesStore\n  instancesStore = instancesStore.filter(function(instance){\n    return instance.svg !== that.svg\n  })\n\n  // Delete options and its contents\n  delete this.options\n\n  // Delete viewport to make public shadow viewport functions uncallable\n  delete this.viewport\n\n  // Destroy public instance and rewrite getPublicInstance\n  delete this.publicInstance\n  delete this.pi\n  this.getPublicInstance = function(){\n    return null\n  }\n}\n\n/**\n * Returns a public instance object\n *\n * @return {Object} Public instance object\n */\nSvgPanZoom.prototype.getPublicInstance = function() {\n  var that = this\n\n  // Create cache\n  if (!this.publicInstance) {\n    this.publicInstance = this.pi = {\n      // Pan\n      enablePan: function() {that.options.panEnabled = true; return that.pi}\n    , disablePan: function() {that.options.panEnabled = false; return that.pi}\n    , isPanEnabled: function() {return !!that.options.panEnabled}\n    , pan: function(point) {that.pan(point); return that.pi}\n    , panBy: function(point) {that.panBy(point); return that.pi}\n    , getPan: function() {return that.getPan()}\n      // Pan event\n    , setBeforePan: function(fn) {that.options.beforePan = fn === null ? null : Utils.proxy(fn, that.publicInstance); return that.pi}\n    , setOnPan: function(fn) {that.options.onPan = fn === null ? null : Utils.proxy(fn, that.publicInstance); return that.pi}\n      // Zoom and Control Icons\n    , enableZoom: function() {that.options.zoomEnabled = true; return that.pi}\n    , disableZoom: function() {that.options.zoomEnabled = false; return that.pi}\n    , isZoomEnabled: function() {return !!that.options.zoomEnabled}\n    , enableControlIcons: function() {\n        if (!that.options.controlIconsEnabled) {\n          that.options.controlIconsEnabled = true\n          ControlIcons.enable(that)\n        }\n        return that.pi\n      }\n    , disableControlIcons: function() {\n        if (that.options.controlIconsEnabled) {\n          that.options.controlIconsEnabled = false;\n          ControlIcons.disable(that)\n        }\n        return that.pi\n      }\n    , isControlIconsEnabled: function() {return !!that.options.controlIconsEnabled}\n      // Double click zoom\n    , enableDblClickZoom: function() {that.options.dblClickZoomEnabled = true; return that.pi}\n    , disableDblClickZoom: function() {that.options.dblClickZoomEnabled = false; return that.pi}\n    , isDblClickZoomEnabled: function() {return !!that.options.dblClickZoomEnabled}\n      // Mouse wheel zoom\n    , enableMouseWheelZoom: function() {that.enableMouseWheelZoom(); return that.pi}\n    , disableMouseWheelZoom: function() {that.disableMouseWheelZoom(); return that.pi}\n    , isMouseWheelZoomEnabled: function() {return !!that.options.mouseWheelZoomEnabled}\n      // Zoom scale and bounds\n    , setZoomScaleSensitivity: function(scale) {that.options.zoomScaleSensitivity = scale; return that.pi}\n    , setMinZoom: function(zoom) {that.options.minZoom = zoom; return that.pi}\n    , setMaxZoom: function(zoom) {that.options.maxZoom = zoom; return that.pi}\n      // Zoom event\n    , setBeforeZoom: function(fn) {that.options.beforeZoom = fn === null ? null : Utils.proxy(fn, that.publicInstance); return that.pi}\n    , setOnZoom: function(fn) {that.options.onZoom = fn === null ? null : Utils.proxy(fn, that.publicInstance); return that.pi}\n      // Zooming\n    , zoom: function(scale) {that.publicZoom(scale, true); return that.pi}\n    , zoomBy: function(scale) {that.publicZoom(scale, false); return that.pi}\n    , zoomAtPoint: function(scale, point) {that.publicZoomAtPoint(scale, point, true); return that.pi}\n    , zoomAtPointBy: function(scale, point) {that.publicZoomAtPoint(scale, point, false); return that.pi}\n    , zoomIn: function() {this.zoomBy(1 + that.options.zoomScaleSensitivity); return that.pi}\n    , zoomOut: function() {this.zoomBy(1 / (1 + that.options.zoomScaleSensitivity)); return that.pi}\n    , getZoom: function() {return that.getRelativeZoom()}\n      // CTM update\n    , setOnUpdatedCTM: function(fn) {that.options.onUpdatedCTM = fn === null ? null : Utils.proxy(fn, that.publicInstance); return that.pi}\n      // Reset\n    , resetZoom: function() {that.resetZoom(); return that.pi}\n    , resetPan: function() {that.resetPan(); return that.pi}\n    , reset: function() {that.reset(); return that.pi}\n      // Fit, Contain and Center\n    , fit: function() {that.fit(); return that.pi}\n    , contain: function() {that.contain(); return that.pi}\n    , center: function() {that.center(); return that.pi}\n      // Size and Resize\n    , updateBBox: function() {that.updateBBox(); return that.pi}\n    , resize: function() {that.resize(); return that.pi}\n    , getSizes: function() {\n        return {\n          width: that.width\n        , height: that.height\n        , realZoom: that.getZoom()\n        , viewBox: that.viewport.getViewBox()\n        }\n      }\n      // Destroy\n    , destroy: function() {that.destroy(); return that.pi}\n    }\n  }\n\n  return this.publicInstance\n}\n\n/**\n * Stores pairs of instances of SvgPanZoom and SVG\n * Each pair is represented by an object {svg: SVGSVGElement, instance: SvgPanZoom}\n *\n * @type {Array}\n */\nvar instancesStore = []\n\nvar svgPanZoom = function(elementOrSelector, options){\n  var svg = Utils.getSvg(elementOrSelector)\n\n  if (svg === null) {\n    return null\n  } else {\n    // Look for existent instance\n    for(var i = instancesStore.length - 1; i >= 0; i--) {\n      if (instancesStore[i].svg === svg) {\n        return instancesStore[i].instance.getPublicInstance()\n      }\n    }\n\n    // If instance not found - create one\n    instancesStore.push({\n      svg: svg\n    , instance: new SvgPanZoom(svg, options)\n    })\n\n    // Return just pushed instance\n    return instancesStore[instancesStore.length - 1].instance.getPublicInstance()\n  }\n}\n\nmodule.exports = svgPanZoom;\n\n},{\"./control-icons\":2,\"./shadow-viewport\":3,\"./svg-utilities\":5,\"./uniwheel\":6,\"./utilities\":7}],5:[function(require,module,exports){\nvar Utils = require('./utilities')\n  , _browser = 'unknown'\n  ;\n\n// http://stackoverflow.com/questions/9847580/how-to-detect-safari-chrome-ie-firefox-and-opera-browser\nif (/*@cc_on!@*/false || !!document.documentMode) { // internet explorer\n  _browser = 'ie';\n}\n\nmodule.exports = {\n  svgNS:  'http://www.w3.org/2000/svg'\n, xmlNS:  'http://www.w3.org/XML/1998/namespace'\n, xmlnsNS:  'http://www.w3.org/2000/xmlns/'\n, xlinkNS:  'http://www.w3.org/1999/xlink'\n, evNS:  'http://www.w3.org/2001/xml-events'\n\n  /**\n   * Get svg dimensions: width and height\n   *\n   * @param  {SVGSVGElement} svg\n   * @return {Object}     {width: 0, height: 0}\n   */\n, getBoundingClientRectNormalized: function(svg) {\n    if (svg.clientWidth && svg.clientHeight) {\n      return {width: svg.clientWidth, height: svg.clientHeight}\n    } else if (!!svg.getBoundingClientRect()) {\n      return svg.getBoundingClientRect();\n    } else {\n      throw new Error('Cannot get BoundingClientRect for SVG.');\n    }\n  }\n\n  /**\n   * Gets g element with class of \"viewport\" or creates it if it doesn't exist\n   *\n   * @param  {SVGSVGElement} svg\n   * @return {SVGElement}     g (group) element\n   */\n, getOrCreateViewport: function(svg, selector) {\n    var viewport = null\n\n    if (Utils.isElement(selector)) {\n      viewport = selector\n    } else {\n      viewport = svg.querySelector(selector)\n    }\n\n    // Check if there is just one main group in SVG\n    if (!viewport) {\n      var childNodes = Array.prototype.slice.call(svg.childNodes || svg.children).filter(function(el){\n        return el.nodeName !== 'defs' && el.nodeName !== '#text'\n      })\n\n      // Node name should be SVGGElement and should have no transform attribute\n      // Groups with transform are not used as viewport because it involves parsing of all transform possibilities\n      if (childNodes.length === 1 && childNodes[0].nodeName === 'g' && childNodes[0].getAttribute('transform') === null) {\n        viewport = childNodes[0]\n      }\n    }\n\n    // If no favorable group element exists then create one\n    if (!viewport) {\n      var viewportId = 'viewport-' + new Date().toISOString().replace(/\\D/g, '');\n      viewport = document.createElementNS(this.svgNS, 'g');\n      viewport.setAttribute('id', viewportId);\n\n      // Internet Explorer (all versions?) can't use childNodes, but other browsers prefer (require?) using childNodes\n      var svgChildren = svg.childNodes || svg.children;\n      if (!!svgChildren && svgChildren.length > 0) {\n        for (var i = svgChildren.length; i > 0; i--) {\n          // Move everything into viewport except defs\n          if (svgChildren[svgChildren.length - i].nodeName !== 'defs') {\n            viewport.appendChild(svgChildren[svgChildren.length - i]);\n          }\n        }\n      }\n      svg.appendChild(viewport);\n    }\n\n    // Parse class names\n    var classNames = [];\n    if (viewport.getAttribute('class')) {\n      classNames = viewport.getAttribute('class').split(' ')\n    }\n\n    // Set class (if not set already)\n    if (!~classNames.indexOf('svg-pan-zoom_viewport')) {\n      classNames.push('svg-pan-zoom_viewport')\n      viewport.setAttribute('class', classNames.join(' '))\n    }\n\n    return viewport\n  }\n\n  /**\n   * Set SVG attributes\n   *\n   * @param  {SVGSVGElement} svg\n   */\n  , setupSvgAttributes: function(svg) {\n    // Setting default attributes\n    svg.setAttribute('xmlns', this.svgNS);\n    svg.setAttributeNS(this.xmlnsNS, 'xmlns:xlink', this.xlinkNS);\n    svg.setAttributeNS(this.xmlnsNS, 'xmlns:ev', this.evNS);\n\n    // Needed for Internet Explorer, otherwise the viewport overflows\n    if (svg.parentNode !== null) {\n      var style = svg.getAttribute('style') || '';\n      if (style.toLowerCase().indexOf('overflow') === -1) {\n        svg.setAttribute('style', 'overflow: hidden; ' + style);\n      }\n    }\n  }\n\n/**\n * How long Internet Explorer takes to finish updating its display (ms).\n */\n, internetExplorerRedisplayInterval: 300\n\n/**\n * Forces the browser to redisplay all SVG elements that rely on an\n * element defined in a 'defs' section. It works globally, for every\n * available defs element on the page.\n * The throttling is intentionally global.\n *\n * This is only needed for IE. It is as a hack to make markers (and 'use' elements?)\n * visible after pan/zoom when there are multiple SVGs on the page.\n * See bug report: https://connect.microsoft.com/IE/feedback/details/781964/\n * also see svg-pan-zoom issue: https://github.com/ariutta/svg-pan-zoom/issues/62\n */\n, refreshDefsGlobal: Utils.throttle(function() {\n    var allDefs = document.querySelectorAll('defs');\n    var allDefsCount = allDefs.length;\n    for (var i = 0; i < allDefsCount; i++) {\n      var thisDefs = allDefs[i];\n      thisDefs.parentNode.insertBefore(thisDefs, thisDefs);\n    }\n  }, this.internetExplorerRedisplayInterval)\n\n  /**\n   * Sets the current transform matrix of an element\n   *\n   * @param {SVGElement} element\n   * @param {SVGMatrix} matrix  CTM\n   * @param {SVGElement} defs\n   */\n, setCTM: function(element, matrix, defs) {\n    var that = this\n      , s = 'matrix(' + matrix.a + ',' + matrix.b + ',' + matrix.c + ',' + matrix.d + ',' + matrix.e + ',' + matrix.f + ')';\n\n    element.setAttributeNS(null, 'transform', s);\n    if ('transform' in element.style) {\n      element.style.transform = s;\n    } else if ('-ms-transform' in element.style) {\n      element.style['-ms-transform'] = s;\n    } else if ('-webkit-transform' in element.style) {\n      element.style['-webkit-transform'] = s;\n    }\n\n    // IE has a bug that makes markers disappear on zoom (when the matrix \"a\" and/or \"d\" elements change)\n    // see http://stackoverflow.com/questions/17654578/svg-marker-does-not-work-in-ie9-10\n    // and http://srndolha.wordpress.com/2013/11/25/svg-line-markers-may-disappear-in-internet-explorer-11/\n    if (_browser === 'ie' && !!defs) {\n      // this refresh is intended for redisplaying the SVG during zooming\n      defs.parentNode.insertBefore(defs, defs);\n      // this refresh is intended for redisplaying the other SVGs on a page when panning a given SVG\n      // it is also needed for the given SVG itself, on zoomEnd, if the SVG contains any markers that\n      // are located under any other element(s).\n      window.setTimeout(function() {\n        that.refreshDefsGlobal();\n      }, that.internetExplorerRedisplayInterval);\n    }\n  }\n\n  /**\n   * Instantiate an SVGPoint object with given event coordinates\n   *\n   * @param {Event} evt\n   * @param  {SVGSVGElement} svg\n   * @return {SVGPoint}     point\n   */\n, getEventPoint: function(evt, svg) {\n    var point = svg.createSVGPoint()\n\n    Utils.mouseAndTouchNormalize(evt, svg)\n\n    point.x = evt.clientX\n    point.y = evt.clientY\n\n    return point\n  }\n\n  /**\n   * Get SVG center point\n   *\n   * @param  {SVGSVGElement} svg\n   * @return {SVGPoint}\n   */\n, getSvgCenterPoint: function(svg, width, height) {\n    return this.createSVGPoint(svg, width / 2, height / 2)\n  }\n\n  /**\n   * Create a SVGPoint with given x and y\n   *\n   * @param  {SVGSVGElement} svg\n   * @param  {Number} x\n   * @param  {Number} y\n   * @return {SVGPoint}\n   */\n, createSVGPoint: function(svg, x, y) {\n    var point = svg.createSVGPoint()\n    point.x = x\n    point.y = y\n\n    return point\n  }\n}\n\n},{\"./utilities\":7}],6:[function(require,module,exports){\n// uniwheel 0.1.2 (customized)\n// A unified cross browser mouse wheel event handler\n// https://github.com/teemualap/uniwheel\n\nmodule.exports = (function(){\n\n  //Full details: https://developer.mozilla.org/en-US/docs/Web/Reference/Events/wheel\n\n  var prefix = \"\", _addEventListener, _removeEventListener, onwheel, support, fns = [];\n\n  // detect event model\n  if ( window.addEventListener ) {\n    _addEventListener = \"addEventListener\";\n    _removeEventListener = \"removeEventListener\";\n  } else {\n    _addEventListener = \"attachEvent\";\n    _removeEventListener = \"detachEvent\";\n    prefix = \"on\";\n  }\n\n  // detect available wheel event\n  support = \"onwheel\" in document.createElement(\"div\") ? \"wheel\" : // Modern browsers support \"wheel\"\n            document.onmousewheel !== undefined ? \"mousewheel\" : // Webkit and IE support at least \"mousewheel\"\n            \"DOMMouseScroll\"; // let's assume that remaining browsers are older Firefox\n\n\n  function createCallback(element,callback,capture) {\n\n    var fn = function(originalEvent) {\n\n      !originalEvent && ( originalEvent = window.event );\n\n      // create a normalized event object\n      var event = {\n        // keep a ref to the original event object\n        originalEvent: originalEvent,\n        target: originalEvent.target || originalEvent.srcElement,\n        type: \"wheel\",\n        deltaMode: originalEvent.type == \"MozMousePixelScroll\" ? 0 : 1,\n        deltaX: 0,\n        delatZ: 0,\n        preventDefault: function() {\n          originalEvent.preventDefault ?\n            originalEvent.preventDefault() :\n            originalEvent.returnValue = false;\n        }\n      };\n\n      // calculate deltaY (and deltaX) according to the event\n      if ( support == \"mousewheel\" ) {\n        event.deltaY = - 1/40 * originalEvent.wheelDelta;\n        // Webkit also support wheelDeltaX\n        originalEvent.wheelDeltaX && ( event.deltaX = - 1/40 * originalEvent.wheelDeltaX );\n      } else {\n        event.deltaY = originalEvent.detail;\n      }\n\n      // it's time to fire the callback\n      return callback( event );\n\n    };\n\n    fns.push({\n      element: element,\n      fn: fn,\n      capture: capture\n    });\n\n    return fn;\n  }\n\n  function getCallback(element,capture) {\n    for (var i = 0; i < fns.length; i++) {\n      if (fns[i].element === element && fns[i].capture === capture) {\n        return fns[i].fn;\n      }\n    }\n    return function(){};\n  }\n\n  function removeCallback(element,capture) {\n    for (var i = 0; i < fns.length; i++) {\n      if (fns[i].element === element && fns[i].capture === capture) {\n        return fns.splice(i,1);\n      }\n    }\n  }\n\n  function _addWheelListener( elem, eventName, callback, useCapture ) {\n\n    var cb;\n\n    if (support === \"wheel\") {\n      cb = callback;\n    } else {\n      cb = createCallback(elem,callback,useCapture);\n    }\n\n    elem[ _addEventListener ]( prefix + eventName, cb, useCapture || false );\n\n  }\n\n  function _removeWheelListener( elem, eventName, callback, useCapture ) {\n\n    var cb;\n\n    if (support === \"wheel\") {\n      cb = callback;\n    } else {\n      cb = getCallback(elem,useCapture);\n    }\n\n    elem[ _removeEventListener ]( prefix + eventName, cb, useCapture || false );\n\n    removeCallback(elem,useCapture);\n\n  }\n\n  function addWheelListener( elem, callback, useCapture ) {\n    _addWheelListener( elem, support, callback, useCapture );\n\n    // handle MozMousePixelScroll in older Firefox\n    if( support == \"DOMMouseScroll\" ) {\n        _addWheelListener( elem, \"MozMousePixelScroll\", callback, useCapture);\n    }\n  }\n\n  function removeWheelListener(elem,callback,useCapture){\n    _removeWheelListener(elem,support,callback,useCapture);\n\n    // handle MozMousePixelScroll in older Firefox\n    if( support == \"DOMMouseScroll\" ) {\n        _removeWheelListener(elem, \"MozMousePixelScroll\", callback, useCapture);\n    }\n  }\n\n  return {\n    on: addWheelListener,\n    off: removeWheelListener\n  };\n\n})();\n\n},{}],7:[function(require,module,exports){\nmodule.exports = {\n  /**\n   * Extends an object\n   *\n   * @param  {Object} target object to extend\n   * @param  {Object} source object to take properties from\n   * @return {Object}        extended object\n   */\n  extend: function(target, source) {\n    target = target || {};\n    for (var prop in source) {\n      // Go recursively\n      if (this.isObject(source[prop])) {\n        target[prop] = this.extend(target[prop], source[prop])\n      } else {\n        target[prop] = source[prop]\n      }\n    }\n    return target;\n  }\n\n  /**\n   * Checks if an object is a DOM element\n   *\n   * @param  {Object}  o HTML element or String\n   * @return {Boolean}   returns true if object is a DOM element\n   */\n, isElement: function(o){\n    return (\n      o instanceof HTMLElement || o instanceof SVGElement || o instanceof SVGSVGElement || //DOM2\n      (o && typeof o === 'object' && o !== null && o.nodeType === 1 && typeof o.nodeName === 'string')\n    );\n  }\n\n  /**\n   * Checks if an object is an Object\n   *\n   * @param  {Object}  o Object\n   * @return {Boolean}   returns true if object is an Object\n   */\n, isObject: function(o){\n    return Object.prototype.toString.call(o) === '[object Object]';\n  }\n\n  /**\n   * Checks if variable is Number\n   *\n   * @param  {Integer|Float}  n\n   * @return {Boolean}   returns true if variable is Number\n   */\n, isNumber: function(n) {\n    return !isNaN(parseFloat(n)) && isFinite(n);\n  }\n\n  /**\n   * Search for an SVG element\n   *\n   * @param  {Object|String} elementOrSelector DOM Element or selector String\n   * @return {Object|Null}                   SVG or null\n   */\n, getSvg: function(elementOrSelector) {\n    var element\n      , svg;\n\n    if (!this.isElement(elementOrSelector)) {\n      // If selector provided\n      if (typeof elementOrSelector === 'string' || elementOrSelector instanceof String) {\n        // Try to find the element\n        element = document.querySelector(elementOrSelector)\n\n        if (!element) {\n          throw new Error('Provided selector did not find any elements. Selector: ' + elementOrSelector)\n          return null\n        }\n      } else {\n        throw new Error('Provided selector is not an HTML object nor String')\n        return null\n      }\n    } else {\n      element = elementOrSelector\n    }\n\n    if (element.tagName.toLowerCase() === 'svg') {\n      svg = element;\n    } else {\n      if (element.tagName.toLowerCase() === 'object') {\n        svg = element.contentDocument.documentElement;\n      } else {\n        if (element.tagName.toLowerCase() === 'embed') {\n          svg = element.getSVGDocument().documentElement;\n        } else {\n          if (element.tagName.toLowerCase() === 'img') {\n            throw new Error('Cannot script an SVG in an \"img\" element. Please use an \"object\" element or an in-line SVG.');\n          } else {\n            throw new Error('Cannot get SVG.');\n          }\n          return null\n        }\n      }\n    }\n\n    return svg\n  }\n\n  /**\n   * Attach a given context to a function\n   * @param  {Function} fn      Function\n   * @param  {Object}   context Context\n   * @return {Function}           Function with certain context\n   */\n, proxy: function(fn, context) {\n    return function() {\n      return fn.apply(context, arguments)\n    }\n  }\n\n  /**\n   * Returns object type\n   * Uses toString that returns [object SVGPoint]\n   * And than parses object type from string\n   *\n   * @param  {Object} o Any object\n   * @return {String}   Object type\n   */\n, getType: function(o) {\n    return Object.prototype.toString.apply(o).replace(/^\\[object\\s/, '').replace(/\\]$/, '')\n  }\n\n  /**\n   * If it is a touch event than add clientX and clientY to event object\n   *\n   * @param  {Event} evt\n   * @param  {SVGSVGElement} svg\n   */\n, mouseAndTouchNormalize: function(evt, svg) {\n    // If no cilentX and but touch objects are available\n    if (evt.clientX === void 0 || evt.clientX === null) {\n      // Fallback\n      evt.clientX = 0\n      evt.clientY = 0\n\n      // If it is a touch event\n      if (evt.changedTouches !== void 0 && evt.changedTouches.length) {\n        // If touch event has changedTouches\n        if (evt.changedTouches[0].clientX !== void 0) {\n          evt.clientX = evt.changedTouches[0].clientX\n          evt.clientY = evt.changedTouches[0].clientY\n        }\n        // If changedTouches has pageX attribute\n        else if (evt.changedTouches[0].pageX !== void 0) {\n          var rect = svg.getBoundingClientRect();\n\n          evt.clientX = evt.changedTouches[0].pageX - rect.left\n          evt.clientY = evt.changedTouches[0].pageY - rect.top\n        }\n      // If it is a custom event\n      } else if (evt.originalEvent !== void 0) {\n        if (evt.originalEvent.clientX !== void 0) {\n          evt.clientX = evt.originalEvent.clientX\n          evt.clientY = evt.originalEvent.clientY\n        }\n      }\n    }\n  }\n\n  /**\n   * Check if an event is a double click/tap\n   * TODO: For touch gestures use a library (hammer.js) that takes in account other events\n   * (touchmove and touchend). It should take in account tap duration and traveled distance\n   *\n   * @param  {Event}  evt\n   * @param  {Event}  prevEvt Previous Event\n   * @return {Boolean}\n   */\n, isDblClick: function(evt, prevEvt) {\n    // Double click detected by browser\n    if (evt.detail === 2) {\n      return true;\n    }\n    // Try to compare events\n    else if (prevEvt !== void 0 && prevEvt !== null) {\n      var timeStampDiff = evt.timeStamp - prevEvt.timeStamp // should be lower than 250 ms\n        , touchesDistance = Math.sqrt(Math.pow(evt.clientX - prevEvt.clientX, 2) + Math.pow(evt.clientY - prevEvt.clientY, 2))\n\n      return timeStampDiff < 250 && touchesDistance < 10\n    }\n\n    // Nothing found\n    return false;\n  }\n\n  /**\n   * Returns current timestamp as an integer\n   *\n   * @return {Number}\n   */\n, now: Date.now || function() {\n    return new Date().getTime();\n  }\n\n  // From underscore.\n  // Returns a function, that, when invoked, will only be triggered at most once\n  // during a given window of time. Normally, the throttled function will run\n  // as much as it can, without ever going more than once per `wait` duration;\n  // but if you'd like to disable the execution on the leading edge, pass\n  // `{leading: false}`. To disable execution on the trailing edge, ditto.\n// jscs:disable\n// jshint ignore:start\n, throttle: function(func, wait, options) {\n    var that = this;\n    var context, args, result;\n    var timeout = null;\n    var previous = 0;\n    if (!options) options = {};\n    var later = function() {\n      previous = options.leading === false ? 0 : that.now();\n      timeout = null;\n      result = func.apply(context, args);\n      if (!timeout) context = args = null;\n    };\n    return function() {\n      var now = that.now();\n      if (!previous && options.leading === false) previous = now;\n      var remaining = wait - (now - previous);\n      context = this;\n      args = arguments;\n      if (remaining <= 0 || remaining > wait) {\n        clearTimeout(timeout);\n        timeout = null;\n        previous = now;\n        result = func.apply(context, args);\n        if (!timeout) context = args = null;\n      } else if (!timeout && options.trailing !== false) {\n        timeout = setTimeout(later, remaining);\n      }\n      return result;\n    };\n  }\n// jshint ignore:end\n// jscs:enable\n\n  /**\n   * Create a requestAnimationFrame simulation\n   *\n   * @param  {Number|String} refreshRate\n   * @return {Function}\n   */\n, createRequestAnimationFrame: function(refreshRate) {\n    var timeout = null\n\n    // Convert refreshRate to timeout\n    if (refreshRate !== 'auto' && refreshRate < 60 && refreshRate > 1) {\n      timeout = Math.floor(1000 / refreshRate)\n    }\n\n    if (timeout === null) {\n      return window.requestAnimationFrame || requestTimeout(33)\n    } else {\n      return requestTimeout(timeout)\n    }\n  }\n}\n\n/**\n * Create a callback that will execute after a given timeout\n *\n * @param  {Function} timeout\n * @return {Function}\n */\nfunction requestTimeout(timeout) {\n  return function(callback) {\n    window.setTimeout(callback, timeout)\n  }\n}\n\n},{}],8:[function(require,module,exports){\n\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar nodecanvas_1 = require(\"./nodecanvas\");\nvar menu_1 = require(\"./menu\");\nvar CodeNodes = (function () {\n    function CodeNodes(types) {\n        this.nodesCount = 0;\n        var self = this;\n        this.canvas = new nodecanvas_1.NodeCanvas();\n        this.types = types;\n        this.menu = new menu_1.CodeNodesMenu(this);\n        this.canvas.ondblclick = function (p, rawP) {\n            self.menuPoint = p;\n            self.menu.open(rawP.x + 20, rawP.y - 70);\n        };\n        this.canvas.onclick = function () {\n            self.menu.close();\n        };\n    }\n    ;\n    CodeNodes.prototype.getSVG = function () {\n        this.canvas.render();\n        return this.canvas.svg;\n    };\n    ;\n    CodeNodes.prototype.init = function () {\n        this.canvas.init();\n        this.canvas.svg.appendChild(this.menu.g);\n    };\n    ;\n    CodeNodes.prototype.center = function () {\n        this.canvas.center();\n    };\n    CodeNodes.prototype.collectionTypeOf = function (t) {\n        return {\n            id: t.id,\n            name: t.name,\n            description: \"(Collection) \" + t.description,\n            builder: this.collectionBuilder,\n            clone: this.collectionClone,\n            clonable: t.clonable,\n            outputType: t.outputType,\n            outputMultiple: true,\n            schema: [\n                {\n                    name: \" - \" + t,\n                    type: t.id,\n                    mode: \"in\",\n                    options: null,\n                    multiple: false\n                }\n            ]\n        };\n    };\n    CodeNodes.prototype.addNode = function (name, type) {\n        var t = this.types[type];\n        if (t) {\n            var outputType = t.outputType || type;\n            var ot = this.types[outputType];\n            if (ot) {\n                var p = this.menuPoint || { x: 10, y: 10 };\n                this.canvas.addNode({\n                    id: this.nodesCount++,\n                    title: name,\n                    type: t,\n                    isCollection: false,\n                    x: p.x,\n                    y: p.y\n                });\n            }\n            else {\n                console.log(\"There is no type \" + outputType + \" registered. Can not assign output type.\");\n            }\n        }\n        else {\n            console.log(\"There is no type \" + type + \" registered\");\n        }\n    };\n    ;\n    CodeNodes.prototype.collectionBuilder = function () {\n        function flatten(arr) {\n            return arr.reduce(function (flat, toFlatten) {\n                return flat.concat(Array.isArray(toFlatten) ? flatten(toFlatten) : toFlatten);\n            }, []);\n        }\n        return flatten(arguments).filter(function (v) {\n            return typeof v !== \"undefined\";\n        });\n    };\n    ;\n    CodeNodes.prototype.collectionClone = function (arr) {\n        return arr;\n        // return arr.map(function (e) {\n        //     return e.clone()\n        // }); TODO: Arreglar aix\n    };\n    ;\n    CodeNodes.prototype.addCollection = function (name, ofType) {\n        var t = this.types[ofType];\n        if (t) {\n            var outputType = t.outputType || ofType;\n            var ot = this.types[outputType];\n            if (ot) {\n                var p = this.menuPoint || { x: 10, y: 10 };\n                //name, this.collectionBuilder, collectionSchema, ofType, ot.clonable || false, this.collectionClone, true, outputType, p.x, p.y\n                this.canvas.addNode({\n                    id: this.nodesCount++,\n                    title: name,\n                    type: this.collectionTypeOf(t),\n                    isCollection: true,\n                    x: p.x,\n                    y: p.y\n                });\n            }\n            else {\n                console.log(\"There is no type \" + outputType + \" registered. Can not assign output type.\");\n            }\n        }\n        else {\n            console.log(\"There is no type \" + ofType + \" registered\");\n        }\n    };\n    ;\n    CodeNodes.prototype.serialize = function () {\n        return {\n            nodes: this.canvas.serialize(),\n            transform: this.canvas.getTransform()\n        };\n    };\n    return CodeNodes;\n}());\nexports.CodeNodes = CodeNodes;\n\n\n\n},{\"./menu\":9,\"./nodecanvas\":11}],9:[function(require,module,exports){\n\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar namespace = \"http://www.w3.org/2000/svg\";\nvar CodeNodesMenu = (function () {\n    function CodeNodesMenu(main) {\n        var self = this;\n        var addMode = null;\n        this.main = main;\n        this.g = document.createElementNS(namespace, \"g\");\n        this.g.classList.add(\"menu-g\");\n        var popup = document.createElement(\"div\");\n        popup.classList.add(\"codenodes-menu-popup\");\n        this.popup = popup;\n        var popupLayer = document.createElement(\"div\");\n        popupLayer.classList.add(\"layer\");\n        var popupContent = document.createElement(\"div\");\n        popupContent.classList.add(\"content\");\n        var popupWraper = document.createElement(\"div\");\n        popupWraper.classList.add(\"wraper\");\n        var popupTitle = document.createElement(\"div\");\n        popupTitle.classList.add(\"title\");\n        var entitySelector = document.createElement(\"select\");\n        var entitySelectorWrap = document.createElement(\"div\");\n        entitySelectorWrap.classList.add(\"entity-selector\");\n        var entityName = document.createElement(\"input\");\n        var entityNameWrap = document.createElement(\"div\");\n        entitySelectorWrap.classList.add(\"entity-name\");\n        var popupOK = document.createElement(\"div\");\n        popupOK.classList.add(\"ok\");\n        popup.appendChild(popupLayer);\n        popup.appendChild(popupWraper);\n        popupWraper.appendChild(popupContent);\n        entityNameWrap.appendChild(entityName);\n        popupContent.appendChild(entityNameWrap);\n        entitySelectorWrap.appendChild(entitySelector);\n        popupContent.appendChild(entitySelectorWrap);\n        popupContent.appendChild(popupOK);\n        document.body.appendChild(popup);\n        popupOK.addEventListener(\"click\", function () {\n            self.close();\n            switch (addMode) {\n                case \"node\":\n                    main.addNode(entityName.value, entitySelector.value);\n                    break;\n                case \"collection\":\n                    main.addCollection(entityName.value, entitySelector.value);\n                    break;\n            }\n        });\n        function fillEntitySelector() {\n            entitySelector.innerHTML = \"\";\n            entitySelector.value = \"\";\n            var types = Object.keys(self.main.types).filter(function (p) { return self.main.types.hasOwnProperty(p); });\n            types.forEach(function (t) {\n                var opt = document.createElement(\"option\");\n                opt.textContent = t;\n                opt.value = t;\n                entitySelector.appendChild(opt);\n            });\n        }\n        var _loop_1 = function (i) {\n            var rect = document.createElementNS(namespace, \"rect\"), t = document.createElementNS(namespace, \"text\");\n            rect.classList.add(\"menu-rect\");\n            t.classList.add(\"menu-t\");\n            rect.setAttribute(\"x\", (5).toString());\n            rect.setAttribute(\"y\", (35 * i).toString());\n            t.setAttribute(\"x\", (10).toString());\n            t.setAttribute(\"y\", ((35 * i) + 19).toString());\n            self.g.appendChild(rect);\n            self.g.appendChild(t);\n            switch (i) {\n                case 0:\n                    t.textContent = \"Add node\";\n                    rect.addEventListener(\"click\", function (evt) {\n                        popupTitle.textContent = t.textContent;\n                        entityName.value = \"New node\";\n                        entityName.focus();\n                        fillEntitySelector();\n                        addMode = \"node\";\n                        popup.classList.add(\"visible\");\n                        evt.stopPropagation();\n                    });\n                    break;\n                case 1:\n                    t.textContent = \"Add collection\";\n                    rect.addEventListener(\"click\", function (evt) {\n                        popupTitle.textContent = t.textContent;\n                        entityName.value = \"New collection\";\n                        entityName.focus();\n                        fillEntitySelector();\n                        addMode = \"collection\";\n                        popup.classList.add(\"visible\");\n                        evt.stopPropagation();\n                    });\n                    break;\n                case 2:\n                    t.textContent = \"Center\";\n                    rect.addEventListener(\"click\", function (evt) {\n                        main.center();\n                        self.close();\n                        evt.stopPropagation();\n                    });\n                    break;\n                case 3:\n                    t.textContent = \"Reset\";\n                    break;\n            }\n        };\n        for (var i = 0; i < 4; i++) {\n            _loop_1(i);\n        }\n    }\n    CodeNodesMenu.prototype.open = function (x, y) {\n        this.g.classList.add(\"visible\");\n        this.g.setAttribute(\"transform\", \"translate(\" + x.toString() + \",\" + y.toString() + \")\");\n        this.g.classList.add(\"visible\");\n    };\n    CodeNodesMenu.prototype.close = function () {\n        this.popup.classList.remove(\"visible\");\n        this.g.classList.remove(\"visible\");\n    };\n    return CodeNodesMenu;\n}());\nexports.CodeNodesMenu = CodeNodesMenu;\n\n\n\n},{}],10:[function(require,module,exports){\n\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar nodevalue_1 = require(\"./nodevalue\");\nvar namespace = \"http://www.w3.org/2000/svg\";\nvar ROW_HEIGHT = 38;\nvar Node = (function () {\n    function Node(opts) {\n        var self = this;\n        this.options = opts;\n        this.values = [];\n        this.position = {\n            x: this.options.x,\n            y: this.options.y\n        };\n        this.nRows = this.options.type.schema.length + 2;\n        this.onmousedown = null;\n        this.outputConnectors = [];\n        this.options.type.schema.forEach(function (prop) {\n            self.setValueDefaults(prop);\n            var p = prop;\n            if (self.options.isCollection) {\n                p = self.collectionValueOf(p);\n            }\n            self.values.push(new nodevalue_1.NodeValue(p, self));\n        });\n    }\n    ;\n    Node.prototype.setValueDefaults = function (v) {\n        v.options = v.options || [];\n        v.multiple = v.multiple || false;\n    };\n    Node.prototype.collectionValueOf = function (v) {\n        return {\n            id: v.id,\n            name: v.name + \" 0\",\n            type: v.type,\n            mode: v.mode,\n            options: v.options,\n            multiple: v.multiple\n        };\n    };\n    Node.prototype.render = function (parent) {\n        var self = this;\n        if (!this.g) {\n            this.g = document.createElementNS(namespace, \"g\");\n            this.g.setAttribute(\"transform\", \"translate(\" + this.position.x + \",\" + this.position.y + \")\");\n            this.g.setAttribute(\"class\", \"entity\");\n            this.outputOffset = {\n                x: 130,\n                y: (this.nRows * ROW_HEIGHT) - 10\n            };\n            this.rect = document.createElementNS(namespace, \"rect\");\n            this.rect.setAttribute(\"width\", this.outputOffset.x.toString());\n            this.rect.setAttribute(\"rx\", \"3\");\n            this.rect.setAttribute(\"height\", ((this.nRows * ROW_HEIGHT) + 2).toString());\n            this.rect.setAttribute(\"class\", \"draggable\");\n            this.rectDownHandler = function (evt) {\n                if (this.onmousedown instanceof Function) {\n                    this.onmousedown(evt, this);\n                }\n            }.bind(this);\n            this.rect.addEventListener(\"mousedown\", this.rectDownHandler);\n            var t = document.createElementNS(namespace, \"text\");\n            t.textContent = this.options.title;\n            t.classList.add(\"title\");\n            t.setAttribute(\"x\", \"5\");\n            t.setAttribute(\"y\", \"15\");\n            this.g.appendChild(this.rect);\n            this.g.appendChild(t);\n            var output = document.createElementNS(namespace, \"circle\");\n            this.output = output;\n            output.setAttribute(\"cx\", (this.outputOffset.x).toString());\n            output.setAttribute(\"cy\", (this.outputOffset.y).toString());\n            output.setAttribute(\"r\", \"6\");\n            output.setAttribute(\"class\", \"output\");\n            this.outputDownHandler = function (evt) {\n                if (this.outputMousedown instanceof Function) {\n                    this.outputMousedown(evt, this);\n                }\n            }.bind(this);\n            output.addEventListener(\"mousedown\", this.outputDownHandler);\n            var outputType = document.createElementNS(namespace, \"text\");\n            this.outputText = outputType;\n            if (this.options.type.outputMultiple) {\n                outputType.textContent = \"[\" + this.options.type.outputType + \"]\";\n            }\n            else {\n                outputType.textContent = this.options.type.outputType;\n            }\n            outputType.classList.add(\"output-type\");\n            outputType.setAttribute(\"x\", (this.outputOffset.x - 10).toString());\n            outputType.setAttribute(\"y\", (this.outputOffset.y).toString());\n            this.g.appendChild(output);\n            this.g.appendChild(outputType);\n            this.closeBtn = document.createElementNS(namespace, \"circle\");\n            this.closeBtn.classList.add(\"close-btn\");\n            this.closeBtn.setAttribute(\"cx\", (this.outputOffset.x - 10).toString());\n            this.closeBtn.setAttribute(\"r\", \"6\");\n            this.closeBtn.setAttribute(\"cy\", \"15\");\n            this.close = function () {\n                this.remove();\n            }.bind(this);\n            this.closeBtn.addEventListener(\"click\", this.close);\n            this.g.appendChild(this.closeBtn);\n            parent.appendChild(this.g);\n        }\n        var i = 1;\n        this.values.forEach(function (val) {\n            val.render(self.g, i++);\n        });\n    };\n    ;\n    Node.prototype.cloneLastValue = function () {\n        var self = this;\n        if (this.options.isCollection) {\n            var schema = this.options.type.schema, full = self.values.every(function (val) {\n                return val.inputConnector !== null;\n            });\n            if (full) {\n                var prop = JSON.parse(JSON.stringify(schema[schema.length - 1])), name_1 = prop.name + \" \" + schema.length;\n                schema.push(prop);\n                this.nRows++;\n                var newN = new nodevalue_1.NodeValue(prop, self);\n                self.values.push(newN);\n                newN.render(self.g, schema.length);\n                this.outputOffset.y = (this.nRows * ROW_HEIGHT) - 10;\n                this.output.setAttribute(\"cx\", (this.outputOffset.x).toString());\n                this.output.setAttribute(\"cy\", (this.outputOffset.y).toString());\n                this.outputText.setAttribute(\"y\", (this.outputOffset.y).toString());\n                this.rect.setAttribute(\"height\", ((this.nRows * ROW_HEIGHT) + 2).toString());\n            }\n        }\n    };\n    ;\n    Node.prototype.move = function (x, y) {\n        var self = this;\n        this.position = {\n            x: x,\n            y: y\n        };\n        this.outputConnectors.forEach(function (con) {\n            con.sp = {\n                x: x + self.outputOffset.x,\n                y: y + self.outputOffset.y\n            };\n            con.setPath();\n        });\n        this.values.forEach(function (val) {\n            val.updateConectorPosition();\n        });\n        this.g.setAttribute(\"transform\", \"translate(\" + this.position.x + \",\" + this.position.y + \")\");\n    };\n    ;\n    Node.prototype.serialize = function () {\n        var self = this, model = {\n            arguments: JSON.parse(JSON.stringify(this.options)),\n            values: this.values.map(function (v) {\n                return {\n                    valueID: v.options.id,\n                    value: v.__internalGetValue()\n                };\n            }),\n            outputConnectors: this.outputConnectors.map(function (c) {\n                return {\n                    nodeTo: c.end2.parentNode.options.id,\n                    valueTo: c.end2.options.id\n                };\n            })\n        };\n        return model;\n    };\n    ;\n    Node.prototype.findValue = function (id) {\n        var i, len = this.values.length;\n        for (i = 0; i < len; i += 1) {\n            if (this.values[i].options.id === id)\n                return this.values[i];\n        }\n        return null;\n    };\n    Node.prototype.setValues = function (vs) {\n        var self = this;\n        if (!this.options.isCollection) {\n            vs.forEach(function (v) {\n                var value = self.values.filter(function (val) {\n                    return val.options.id === v.valueID;\n                })[0];\n                if (value.__internalSetValue instanceof Function) {\n                    value.__internalSetValue(v.value);\n                }\n            });\n        }\n    };\n    ;\n    Node.prototype.build = function () {\n        if (!this.built) {\n            var schema = this.options.type.schema, valuesArr = [], self = this;\n            valuesArr = this.values.map(function (v) {\n                return v.getValue();\n            });\n            this.built = this.options.type.builder.apply(this, valuesArr);\n            return this.built;\n        }\n        else {\n            if (this.options.type.clonable) {\n                return this.options.type.clone(this.built);\n            }\n            else {\n                return this.built;\n            }\n        }\n    };\n    ;\n    Node.prototype.remove = function () {\n        var self = this;\n        this.values.forEach(function (val) {\n            if (val.inputConnector) {\n                val.inputConnector.remove();\n            }\n            ;\n        });\n        [].concat(this.outputConnectors).forEach(function (con) {\n            con.remove();\n        });\n        if (this.onremove instanceof Function) {\n            this.onremove();\n        }\n        this.closeBtn.removeEventListener(\"click\", this.close);\n        this.rect.removeEventListener(\"mousedown\", this.rectDownHandler);\n        this.output.addEventListener(\"mousedown\", this.outputDownHandler);\n    };\n    ;\n    return Node;\n}());\nexports.Node = Node;\n\n\n\n},{\"./nodevalue\":13}],11:[function(require,module,exports){\n\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar svgPanZoom = require(\"svg-pan-zoom\");\nvar node_1 = require(\"./node\");\nvar nodeconnector_1 = require(\"./nodeconnector\");\nvar namespace = \"http://www.w3.org/2000/svg\";\nvar NodeCanvas = (function () {\n    function NodeCanvas() {\n        this.svg = null;\n        this.g = null;\n        this.paths = null;\n        this.nodes = [];\n        this.pt = null;\n        this.draggingEntity = null;\n        this.currentConnector = null;\n        this.diff = null;\n    }\n    NodeCanvas.prototype.center = function () {\n        this.zoomingSvg.reset();\n    };\n    NodeCanvas.prototype.cursorPoint = function (evt) {\n        this.pt.x = evt.clientX;\n        this.pt.y = evt.clientY;\n        return this.pt.matrixTransform(this.svg.getScreenCTM().inverse());\n    };\n    ;\n    NodeCanvas.prototype.render = function () {\n        var self = this;\n        if (!this.svg) {\n            this.svg = document.createElementNS(namespace, \"svg\");\n            this.svg.setAttribute(\"class\", \"codenodes\");\n            this.pt = this.svg.createSVGPoint();\n            this.svg.setAttributeNS(\"http://www.w3.org/2000/xmlns/\", \"xmlns\", namespace);\n            this.svg.setAttributeNS(\"http://www.w3.org/2000/xmlns/\", \"xmlns:xlink\", \"http://www.w3.org/1999/xlink\");\n            this.svg.setAttribute(\"width\", \"100%\");\n            this.svg.setAttribute(\"height\", \"100%\");\n            this.g = document.createElementNS(namespace, \"g\");\n            this.paths = document.createElementNS(namespace, \"g\");\n            this.g.classList.add(\"svg-pan-zoom_viewport\");\n            this.g.setAttribute(\"transform\", \"matrix(1,1,1,1,0,0)\");\n            this.g.appendChild(this.paths);\n            this.svg.appendChild(this.g);\n            this.svg.addEventListener(\"dblclick\", function (evt) {\n                if (!(evt.target instanceof SVGSVGElement))\n                    return;\n                var p = self.cursorPoint(evt);\n                self.ctm = self.g.getCTM().inverse();\n                self.offset = self.svg.getBoundingClientRect();\n                self.ondblclick(self.convertCoords(p), p);\n            });\n            this.svg.addEventListener(\"click\", function (evt) {\n                self.onclick();\n            });\n        }\n        ;\n    };\n    ;\n    NodeCanvas.prototype.getTransform = function () {\n        return this.g.getAttribute(\"transform\");\n    };\n    ;\n    NodeCanvas.prototype.setTransform = function (transform) {\n        this.g.setAttribute(\"transform\", transform);\n    };\n    NodeCanvas.prototype.convertCoords = function (o) {\n        var x = o.x, y = o.y;\n        return {\n            x: (this.ctm.a * x) + (this.ctm.c * y) + this.ctm.e,\n            y: (this.ctm.b * x) + (this.ctm.d * y) + this.ctm.f //- this.offset.top\n        };\n    };\n    NodeCanvas.prototype.addNode = function (opts) {\n        var n = new node_1.Node(opts), self = this;\n        function mouseMoveHandler(evt) {\n            if (self.draggingEntity) {\n                var p = self.cursorPoint(evt);\n                p.x = p.x - self.diff.x;\n                p.y = p.y - self.diff.y;\n                var p1 = self.convertCoords(p);\n                self.draggingEntity.move(p1.x, p1.y);\n            }\n        }\n        function mouseUpHandler(evt) {\n            self.svg.removeEventListener(\"mousemove\", mouseMoveHandler);\n            self.svg.removeEventListener(\"mouseup\", mouseUpHandler);\n            mouseMoveHandler(evt);\n            self.draggingEntity = null;\n        }\n        function mouseMoveConnectorHandler(evt) {\n            var p = self.convertCoords(self.cursorPoint(evt));\n            self.currentConnector.moveEndPoint(p);\n        }\n        function mouseUpConnectorHandler(evt) {\n            var p = self.convertCoords(self.cursorPoint(evt));\n            self.svg.removeEventListener(\"mousemove\", mouseMoveConnectorHandler);\n            self.svg.removeEventListener(\"mouseup\", mouseUpConnectorHandler);\n            var dots = [].slice.call(document.querySelectorAll(\".codenodes .dot\"));\n            var cc = self.currentConnector;\n            var candidates = dots.map(function (dot) {\n                var pos = dot.parentValue.getDotPosition();\n                var dist = Math.sqrt(Math.pow(p.x - pos.x, 2) + Math.pow(p.y - pos.y, 2));\n                return {\n                    dist: dist,\n                    dot: dot\n                };\n            }).filter(function (dot) {\n                return dot.dist <= 30;\n            }).sort(function (a, b) {\n                return a.dist - b.dist;\n            });\n            if (candidates.length > 0) {\n                var candidateDot = candidates[0].dot;\n                if (candidateDot.parentValue.inputConnector) {\n                    candidateDot.parentValue.inputConnector.remove();\n                }\n                candidateDot.parentValue.inputConnector = cc;\n                cc.end2 = candidateDot.parentValue;\n                if (cc.end1 === candidateDot.parentValue.parentNode) {\n                    cc.remove();\n                    return;\n                }\n                if (cc.end2.options.type !== \"any\" && cc.end2.options.type !== cc.end1.options.type.outputType) {\n                    cc.remove();\n                    return;\n                }\n                if (cc.end2.parentNode.options.isCollection) {\n                    cc.end2.parentNode.cloneLastValue();\n                }\n                candidateDot.parentValue.updateConectorPosition();\n            }\n            else {\n                cc.remove();\n            }\n            self.currentConnector = null;\n        }\n        this.nodes.push(n);\n        n.outputMousedown = function (evt, entity) {\n            var p = self.cursorPoint(evt);\n            self.ctm = self.g.getCTM().inverse();\n            self.offset = self.svg.getBoundingClientRect();\n            var p1 = {\n                x: entity.position.x + parseInt(entity.output.getAttribute(\"cx\")),\n                y: entity.position.y + parseInt(entity.output.getAttribute(\"cy\"))\n            };\n            self.currentConnector = new nodeconnector_1.NodeConnector(p1, entity);\n            entity.outputConnectors.push(self.currentConnector);\n            self.paths.appendChild(self.currentConnector.path);\n            self.svg.addEventListener(\"mousemove\", mouseMoveConnectorHandler);\n            self.svg.addEventListener(\"mouseup\", mouseUpConnectorHandler);\n            evt.stopPropagation();\n        };\n        n.onmousedown = function (evt, entity) {\n            var p = self.cursorPoint(evt);\n            self.ctm = self.g.getCTM();\n            self.offset = self.svg.getBoundingClientRect();\n            var entPos = self.convertCoords(entity.position);\n            self.diff = {\n                x: p.x - entPos.x,\n                y: p.y - entPos.y\n            };\n            self.ctm = self.ctm.inverse();\n            evt.stopPropagation();\n            self.draggingEntity = entity;\n            if (self.draggingEntity) {\n                self.svg.addEventListener(\"mousemove\", mouseMoveHandler);\n                self.svg.addEventListener(\"mouseup\", mouseUpHandler);\n            }\n        }.bind(this);\n        n.onremove = function () {\n            n.outputMousedown = null;\n            n.onmousedown = null;\n            var ind = self.nodes.indexOf(n);\n            if (ind >= 0) {\n                self.nodes.splice(ind, 1);\n            }\n            self.g.removeChild(n.g);\n        };\n        n.render(self.g);\n        return n;\n    };\n    ;\n    NodeCanvas.prototype.init = function () {\n        this.svg.setAttribute(\"viewBox\", \"0 0 \" + this.svg.clientWidth + \" \" + this.svg.clientHeight);\n        this.zoomingSvg = svgPanZoom(this.svg, {\n            zoomScaleSensitivity: 0.4,\n            dblClickZoomEnabled: false\n        });\n    };\n    ;\n    NodeCanvas.prototype.serialize = function () {\n        return this.nodes.map(function (n) {\n            return n.serialize();\n        });\n    };\n    NodeCanvas.prototype.findNode = function (id) {\n        var i, len = this.nodes.length;\n        for (i = 0; i < len; i += 1) {\n            if (this.nodes[i].options.id === id)\n                return this.nodes[i];\n        }\n        return null;\n    };\n    NodeCanvas.prototype.parse = function (nodes) {\n        var self = this;\n        nodes.forEach(function (nm) {\n            var n = self.addNode(nm.arguments);\n            n.setValues(nm.values);\n        });\n        nodes.forEach(function (nm) {\n            var n = self.findNode(nm.arguments.id);\n            nm.outputConnectors.forEach(function (cn) {\n                var end2 = self.findNode(cn.nodeTo);\n                if (end2.options.isCollection) {\n                    end2.cloneLastValue();\n                }\n                end2.findValue(cn.valueTo).inputConnector;\n            });\n        });\n    };\n    NodeCanvas.prototype.clear = function () {\n        //Alert the user about the action being irreversible\n        var nds = [].concat(this.nodes);\n        nds.forEach(function (node) {\n            node.remove();\n        });\n    };\n    ;\n    NodeCanvas.prototype.getTerminalNodes = function () {\n        return this.nodes.filter(function (n) {\n            return n.outputConnectors.length === 0;\n        });\n    };\n    ;\n    return NodeCanvas;\n}());\nexports.NodeCanvas = NodeCanvas;\n\n\n\n},{\"./node\":10,\"./nodeconnector\":12,\"svg-pan-zoom\":1}],12:[function(require,module,exports){\n\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar namespace = \"http://www.w3.org/2000/svg\";\nvar NodeConnector = (function () {\n    function NodeConnector(sp, node) {\n        this.sp = sp;\n        this.ep = sp;\n        this.end1 = node;\n        this.end2 = null;\n        this.path = document.createElementNS(namespace, \"path\");\n        this.setPath();\n    }\n    ;\n    NodeConnector.prototype.setPath = function () {\n        var c1 = {\n            x: ((this.ep.x - this.sp.x) / 3) + this.sp.x,\n            y: this.sp.y\n        }, c2 = {\n            x: -((this.ep.x - this.sp.x) / 3) + this.ep.x,\n            y: this.ep.y\n        };\n        this.path.setAttribute(\"d\", \"M\" + this.sp.x + \",\" + this.sp.y + \" C\" + c1.x + \",\" + c1.y + \" \" + c2.x + \",\" + c2.y + \" \" + this.ep.x + \",\" + this.ep.y);\n    };\n    ;\n    NodeConnector.prototype.remove = function () {\n        if (this.end1) {\n            var ind = this.end1.outputConnectors.indexOf(this);\n            if (ind >= 0) {\n                this.end1.outputConnectors.splice(ind, 1);\n            }\n            this.end1 = null;\n        }\n        if (this.end2) {\n            this.end2.inputConnector = null;\n        }\n        if (this.path) {\n            this.path.parentNode.removeChild(this.path);\n            this.path = null;\n        }\n    };\n    ;\n    NodeConnector.prototype.moveEndPoint = function (point) {\n        this.ep = point;\n        this.setPath();\n    };\n    return NodeConnector;\n}());\nexports.NodeConnector = NodeConnector;\n\n\n\n},{}],13:[function(require,module,exports){\n\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar namespace = \"http://www.w3.org/2000/svg\";\nvar ROW_HEIGHT = 38;\nvar NodeValue = (function () {\n    function NodeValue(opts, node) {\n        this.options = opts;\n        this.inputConnector = null;\n        this.__internalGetValue = null;\n        this.svgEntity = null;\n        this.gOffset = null;\n        this.parentNode = node;\n    }\n    NodeValue.prototype.render = function (parent, position) {\n        var self = this;\n        if (!this.svgEntity) {\n            var ent = document.createElementNS(namespace, \"g\");\n            this.gOffset = {\n                x: 1,\n                y: ((position * ROW_HEIGHT) + 1)\n            };\n            ent.setAttribute(\"transform\", \"translate(\" + this.gOffset.x + \", \" + this.gOffset.y + \")\");\n            ent.setAttribute(\"class\", \"row\");\n            if (this.options.mode === \"edit\") {\n                var rect = document.createElementNS(namespace, \"rect\"), fo = document.createElementNS(namespace, \"foreignObject\"), name_1 = document.createElementNS(namespace, \"text\"), div = document.createElementNS(\"http://www.w3.org/1999/xhtml\", \"div\");\n                name_1.textContent = this.options.name;\n                name_1.setAttribute(\"x\", \"10\");\n                name_1.setAttribute(\"y\", \"6\");\n                rect.setAttribute(\"x\", \"1\");\n                div.setAttribute(\"xmlns\", \"http://www.w3.org/1999/xhtml\");\n                var input_1 = document.createElement(\"input\");\n                switch (this.options.type) {\n                    case \"range\":\n                        input_1.min = this.options[0];\n                        input_1.max = this.options[1];\n                    case \"text\":\n                    case \"number\":\n                    case \"email\":\n                    case \"date\":\n                    case \"color\":\n                        this.__internalGetValue = function () {\n                            return input_1.value;\n                        };\n                        this.__internalSetValue = function (v) {\n                            input_1.value = v;\n                        };\n                        input_1.type = this.options.type;\n                        div.appendChild(input_1);\n                        break;\n                    case \"boolean\":\n                        this.__internalGetValue = function () {\n                            return input_1.checked;\n                        };\n                        this.__internalSetValue = function (v) {\n                            input_1.checked = v;\n                        };\n                        input_1.type = \"checkbox\";\n                        div.appendChild(input_1);\n                        break;\n                    case \"select\":\n                        var div_select_1 = document.createElement(\"select\");\n                        this.options.options.forEach(function (op) {\n                            var div_option = document.createElement(\"option\");\n                            div_option.textContent = op.show.toString();\n                            div_option.setAttribute(\"value\", op.save);\n                            div_select_1.appendChild(div_option);\n                        });\n                        this.__internalGetValue = function () {\n                            return div_select_1.value;\n                        };\n                        this.__internalSetValue = function (v) {\n                            input_1.value = v;\n                        };\n                        div.appendChild(div_select_1);\n                        break;\n                    case \"popup\":\n                        var btn = document.createElement(\"button\");\n                        btn.classList.add(\"popup-btn\");\n                        btn.textContent = \"*Edit\";\n                        var popup_1 = document.createElement(\"div\");\n                        popup_1.classList.add(\"codenodes-popup\");\n                        var popupLayer = document.createElement(\"div\");\n                        popupLayer.classList.add(\"layer\");\n                        var popupContent = document.createElement(\"div\");\n                        popupContent.classList.add(\"content\");\n                        var popupWraper = document.createElement(\"div\");\n                        popupWraper.classList.add(\"wraper\");\n                        var popupTextArea_1 = document.createElement(\"div\");\n                        popupTextArea_1.classList.add(\"text\");\n                        popupTextArea_1.setAttribute(\"contenteditable\", \"true\");\n                        var popupOK = document.createElement(\"div\");\n                        popupOK.classList.add(\"ok\");\n                        btn.addEventListener(\"click\", function () {\n                            popup_1.classList.add(\"visible\");\n                        });\n                        var fnClose = function () {\n                            popup_1.classList.remove(\"visible\");\n                        };\n                        popup_1.appendChild(popupLayer);\n                        popup_1.appendChild(popupWraper);\n                        popupWraper.appendChild(popupContent);\n                        popupContent.appendChild(popupTextArea_1);\n                        popupContent.appendChild(popupOK);\n                        popupOK.addEventListener(\"click\", fnClose);\n                        this.__internalGetValue = function () {\n                            return popupTextArea_1.textContent;\n                        };\n                        this.__internalSetValue = function (v) {\n                            popupTextArea_1.textContent = v;\n                        };\n                        document.body.appendChild(popup_1);\n                        div.appendChild(btn);\n                        break;\n                }\n                fo.appendChild(div);\n                fo.setAttribute(\"transform\", \"translate(0,13)\");\n                //ent.appendChild(rect);\n                ent.appendChild(name_1);\n                ent.appendChild(fo);\n            }\n            if (this.options.mode === \"in\") {\n                var name_2 = document.createElementNS(namespace, \"text\"), type = document.createElementNS(namespace, \"text\"), dot = document.createElementNS(namespace, \"circle\");\n                dot.setAttribute(\"cx\", \"-1\");\n                dot.setAttribute(\"cy\", \"16\");\n                dot.setAttribute(\"r\", \"4\");\n                dot.setAttribute(\"class\", \"dot\");\n                dot.addEventListener(\"click\", function (evt) {\n                    if (self.inputConnector) {\n                        self.inputConnector.remove();\n                    }\n                    evt.stopPropagation();\n                });\n                dot[\"parentValue\"] = this;\n                name_2.textContent = this.options.name;\n                name_2.setAttribute(\"x\", \"10\");\n                name_2.setAttribute(\"y\", \"8\");\n                if (this.options.multiple) {\n                    type.textContent = \"[\" + this.options.type + \"]\";\n                }\n                else {\n                    type.textContent = this.options.type;\n                }\n                type.classList.add(\"value-type\");\n                type.setAttribute(\"x\", \"10\");\n                type.setAttribute(\"y\", \"25\");\n                this.__internalGetValue = function () {\n                    if (self.inputConnector) {\n                        var built = self.inputConnector.end1.build();\n                        if (self.options.multiple && !self.inputConnector.end1.options.type.outputMultiple) {\n                            return [built];\n                        }\n                        else {\n                            return built;\n                        }\n                    }\n                    return undefined;\n                };\n                ent.appendChild(name_2);\n                ent.appendChild(type);\n                ent.appendChild(dot);\n            }\n            this.svgEntity = ent;\n            parent.appendChild(ent);\n        }\n    };\n    ;\n    NodeValue.prototype.getSerializedValue = function () {\n        if (this.options.mode === \"edit\" && this.__internalGetValue instanceof Function) {\n            return this.__internalGetValue();\n        }\n        return null;\n    };\n    NodeValue.prototype.getDotPosition = function () {\n        return {\n            x: this.parentNode.position.x + this.gOffset.x - 1,\n            y: this.parentNode.position.y + this.gOffset.y + 16\n        };\n    };\n    ;\n    NodeValue.prototype.updateConectorPosition = function () {\n        if (this.inputConnector) {\n            this.inputConnector.ep = this.getDotPosition();\n            this.inputConnector.setPath();\n        }\n    };\n    NodeValue.prototype.getValue = function () {\n        if (this.__internalGetValue instanceof Function) {\n            return this.__internalGetValue();\n        }\n        return null;\n    };\n    return NodeValue;\n}());\nexports.NodeValue = NodeValue;\n\n\n\n},{}]},{},[8])(8)\n});"]}