{"version":3,"sources":["codenodes.min.js"],"names":["f","exports","module","define","amd","window","global","self","this","codenodes","e","t","n","r","s","o","u","a","require","i","Error","code","l","call","length","1","SvgPanZoom","./svg-pan-zoom.js","2","SvgUtils","enable","instance","defs","svg","querySelector","document","createElementNS","svgNS","appendChild","style","setAttribute","textContent","zoomGroup","width","height","_createZoomIn","_createZoomReset","_createZoomOut","controlIcons","zoomIn","addEventListener","getPublicInstance","zoomInBackground","zoomInShape","resetPanZoomControl","reset","resetPanZoomControlBackground","resetPanZoomControlShape1","resetPanZoomControlShape2","zoomOut","zoomOutBackground","zoomOutShape","disable","parentNode","removeChild","./svg-utilities","3","Utils","ShadowViewport","viewport","options","init","prototype","originalState","zoom","x","y","activeState","updateCTMCached","proxy","updateCTM","requestAnimationFrame","createRequestAnimationFrame","refreshRate","viewBox","cacheViewBox","newCTM","processCTM","setCTM","svgViewBox","getAttribute","viewBoxValues","split","filter","v","map","parseFloat","Math","min","updateCTMOnNextFrame","removeAttribute","simpleViewBoxCache","bBox","getBBox","getViewBox","extend","getCTM","fit","contain","newScale","max","d","center","offsetX","offsetY","getOriginalState","getState","getZoom","getRelativeZoom","computeRelativeZoom","scale","getPan","safeCTM","createSVGMatrix","b","c","willZoom","isZoomDifferent","willPan","isPanDifferent","beforeZoom","updateCache","onZoom","preventPan","beforePan","preventPanX","preventPanY","isObject","isNumber","onPan","pendingUpdate","ctm","onUpdatedCTM","./utilities","4","Wheel","ControlIcons","optionsDefaults","viewportSelector","panEnabled","controlIconsEnabled","zoomEnabled","dblClickZoomEnabled","mouseWheelZoomEnabled","preventMouseEventsDefault","zoomScaleSensitivity","minZoom","maxZoom","customEventsHandler","eventsListenerElement","that","setupSvgAttributes","state","boundingClientRectNormalized","getBoundingClientRectNormalized","getOrCreateViewport","oldScale","oldPoint","newPoint","point","publicInstance","setBeforeZoom","setOnZoom","setBeforePan","setOnPan","setOnUpdatedCTM","lastMouseWheelEventTime","Date","now","setupHandlers","prevEvt","eventListeners","mousedown","evt","result","handleMouseDown","touchstart","mouseup","handleMouseUp","touchend","mousemove","handleMouseMove","touchmove","mouseleave","touchleave","touchcancel","svgElement","haltEventListeners","hasOwnProperty","event","enableMouseWheelZoom","wheelListener","handleMouseWheel","on","disableMouseWheelZoom","off","preventDefault","returnValue","delta","deltaY","timeDelta","divider","deltaMode","wheelDelta","abs","log","inversedScreenCTM","getScreenCTM","inverse","relativeMousePoint","getEventPoint","matrixTransform","pow","zoomAtPoint","zoomScale","zoomAbsolute","oldCTM","relativePoint","modifier","translate","multiply","absolute","getSvgCenterPoint","publicZoom","computeFromRelativeZoom","publicZoomAtPoint","getType","createSVGPoint","resetZoom","resetPan","pan","handleDblClick","target","indexOf","zoomFactor","shiftKey","mouseAndTouchNormalize","isDblClick","firstEventCTM","stateOrigin","viewportCTM","updateBBox","panBy","resize","disableControlIcons","enableControlIcons","destroy","removeEventListener","instancesStore","pi","enablePan","disablePan","isPanEnabled","fn","enableZoom","disableZoom","isZoomEnabled","isControlIconsEnabled","enableDblClickZoom","disableDblClickZoom","isDblClickZoomEnabled","isMouseWheelZoomEnabled","setZoomScaleSensitivity","setMinZoom","setMaxZoom","zoomBy","zoomAtPointBy","getSizes","realZoom","elementOrSelector","getSvg","push","./control-icons","./shadow-viewport","./uniwheel","5","_browser","documentMode","xmlNS","xmlnsNS","xlinkNS","evNS","clientWidth","clientHeight","getBoundingClientRect","selector","isElement","childNodes","Array","slice","children","el","nodeName","viewportId","toISOString","replace","svgChildren","classNames","join","setAttributeNS","toLowerCase","internetExplorerRedisplayInterval","refreshDefsGlobal","throttle","allDefs","querySelectorAll","allDefsCount","thisDefs","insertBefore","element","matrix","transform","setTimeout","clientX","clientY","6","createCallback","callback","capture","originalEvent","srcElement","type","deltaX","delatZ","support","wheelDeltaX","detail","fns","getCallback","removeCallback","splice","_addWheelListener","elem","eventName","useCapture","cb","_addEventListener","prefix","_removeWheelListener","_removeEventListener","createElement","undefined","onmousewheel","7","requestTimeout","timeout","source","prop","HTMLElement","SVGElement","SVGSVGElement","nodeType","Object","toString","isNaN","isFinite","String","tagName","contentDocument","documentElement","getSVGDocument","context","apply","arguments","changedTouches","pageX","rect","left","pageY","top","timeStampDiff","timeStamp","touchesDistance","sqrt","getTime","func","wait","args","previous","later","leading","remaining","clearTimeout","trailing","floor","8","__export","m","p","defineProperty","value","nodecanvas_1","menu_1","CodeNodes","types","nodesCount","canvas","NodeCanvas","sort","name","localeCompare","reverse","menu","CodeNodesMenu","ondblclick","rawP","menuPoint","open","onclick","close","getSVG","render","g","clear","findType","tID","len","id","collectionTypeOf","description","builder","collectionBuilder","clone","collectionClone","clonable","outputType","outputMultiple","schema","mode","multiple","addNode","ot","title","isCollection","console","flatten","arr","reduce","flat","toFlatten","concat","isArray","addCollection","ofType","serialize","nodes","getTransform","parse","model","setTransform","getOfType","./menu","./node","./nodecanvas","./nodeconnector","./nodevalue","./point","9","namespace","main","fillEntitySelector","entitySelector","innerHTML","forEach","opt","classList","add","desc","remove","selectedValue","addMode","popup","popupLayer","popupContent","popupWraper","popupTitle","entitySelectorWrap","entityName","entityNameWrap","popupOK","body","focus","stopPropagation","10","nodevalue_1","Node","opts","values","position","nRows","onmousedown","outputConnectors","setValueDefaults","collectionValueOf","NodeValue","parent","outputOffset","rectDownHandler","Function","bind","output","outputDownHandler","outputMousedown","outputText","closeBtn","val","cloneLastValue","every","inputConnector","JSON","stringify","newN","move","con","sp","setPath","updateConectorPosition","valueID","__internalGetValue","nodeTo","end2","valueTo","findValue","setValues","vs","__internalSetValue","build","built","valuesArr","getValue","onremove","11","svgPanZoom","node_1","nodeconnector_1","paths","pt","draggingEntity","currentConnector","diff","zoomingSvg","cursorPoint","offset","convertCoords","mouseMoveHandler","p1","mouseUpHandler","mouseMoveConnectorHandler","moveEndPoint","mouseUpConnectorHandler","dots","cc","candidates","dot","pos","parentValue","getDotPosition","dist","candidateDot","end1","entity","parseInt","NodeConnector","path","entPos","ind","findNode","nm","cn","conn","node","getTerminalNodes","svg-pan-zoom","12","ep","c1","c2","13","svgEntity","gOffset","ent","fo","name_1","div","input_1","checked","div_select_1","op","div_option","show","save","btn","popup_1","popupTextArea_1","name_2","serializing","getSerializedValue","14","Point"],"mappings":"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","file":"codenodes.min.js","sourcesContent":["(function(f){if(typeof exports===\"object\"&&typeof module!==\"undefined\"){module.exports=f()}else if(typeof define===\"function\"&&define.amd){define([],f)}else{var g;if(typeof window!==\"undefined\"){g=window}else if(typeof global!==\"undefined\"){g=global}else if(typeof self!==\"undefined\"){g=self}else{g=this}g.codenodes = f()}})(function(){var define,module,exports;return (function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){\nvar SvgPanZoom = require('./svg-pan-zoom.js');\n\nmodule.exports = SvgPanZoom;\n\n},{\"./svg-pan-zoom.js\":4}],2:[function(require,module,exports){\nvar SvgUtils = require('./svg-utilities');\n\nmodule.exports = {\n  enable: function(instance) {\n    // Select (and create if necessary) defs\n    var defs = instance.svg.querySelector('defs')\n    if (!defs) {\n      defs = document.createElementNS(SvgUtils.svgNS, 'defs')\n      instance.svg.appendChild(defs)\n    }\n\n    // Check for style element, and create it if it doesn't exist\n    var styleEl = defs.querySelector('style#svg-pan-zoom-controls-styles');\n    if (!styleEl) {\n      var style = document.createElementNS(SvgUtils.svgNS, 'style')\n      style.setAttribute('id', 'svg-pan-zoom-controls-styles')\n      style.setAttribute('type', 'text/css')\n      style.textContent = '.svg-pan-zoom-control { cursor: pointer; fill: black; fill-opacity: 0.333; } .svg-pan-zoom-control:hover { fill-opacity: 0.8; } .svg-pan-zoom-control-background { fill: white; fill-opacity: 0.5; } .svg-pan-zoom-control-background { fill-opacity: 0.8; }'\n      defs.appendChild(style)\n    }\n\n    // Zoom Group\n    var zoomGroup = document.createElementNS(SvgUtils.svgNS, 'g');\n    zoomGroup.setAttribute('id', 'svg-pan-zoom-controls');\n    zoomGroup.setAttribute('transform', 'translate(' + ( instance.width - 70 ) + ' ' + ( instance.height - 76 ) + ') scale(0.75)');\n    zoomGroup.setAttribute('class', 'svg-pan-zoom-control');\n\n    // Control elements\n    zoomGroup.appendChild(this._createZoomIn(instance))\n    zoomGroup.appendChild(this._createZoomReset(instance))\n    zoomGroup.appendChild(this._createZoomOut(instance))\n\n    // Finally append created element\n    instance.svg.appendChild(zoomGroup)\n\n    // Cache control instance\n    instance.controlIcons = zoomGroup\n  }\n\n, _createZoomIn: function(instance) {\n    var zoomIn = document.createElementNS(SvgUtils.svgNS, 'g');\n    zoomIn.setAttribute('id', 'svg-pan-zoom-zoom-in');\n    zoomIn.setAttribute('transform', 'translate(30.5 5) scale(0.015)');\n    zoomIn.setAttribute('class', 'svg-pan-zoom-control');\n    zoomIn.addEventListener('click', function() {instance.getPublicInstance().zoomIn()}, false)\n    zoomIn.addEventListener('touchstart', function() {instance.getPublicInstance().zoomIn()}, false)\n\n    var zoomInBackground = document.createElementNS(SvgUtils.svgNS, 'rect'); // TODO change these background space fillers to rounded rectangles so they look prettier\n    zoomInBackground.setAttribute('x', '0');\n    zoomInBackground.setAttribute('y', '0');\n    zoomInBackground.setAttribute('width', '1500'); // larger than expected because the whole group is transformed to scale down\n    zoomInBackground.setAttribute('height', '1400');\n    zoomInBackground.setAttribute('class', 'svg-pan-zoom-control-background');\n    zoomIn.appendChild(zoomInBackground);\n\n    var zoomInShape = document.createElementNS(SvgUtils.svgNS, 'path');\n    zoomInShape.setAttribute('d', 'M1280 576v128q0 26 -19 45t-45 19h-320v320q0 26 -19 45t-45 19h-128q-26 0 -45 -19t-19 -45v-320h-320q-26 0 -45 -19t-19 -45v-128q0 -26 19 -45t45 -19h320v-320q0 -26 19 -45t45 -19h128q26 0 45 19t19 45v320h320q26 0 45 19t19 45zM1536 1120v-960 q0 -119 -84.5 -203.5t-203.5 -84.5h-960q-119 0 -203.5 84.5t-84.5 203.5v960q0 119 84.5 203.5t203.5 84.5h960q119 0 203.5 -84.5t84.5 -203.5z');\n    zoomInShape.setAttribute('class', 'svg-pan-zoom-control-element');\n    zoomIn.appendChild(zoomInShape);\n\n    return zoomIn\n  }\n\n, _createZoomReset: function(instance){\n    // reset\n    var resetPanZoomControl = document.createElementNS(SvgUtils.svgNS, 'g');\n    resetPanZoomControl.setAttribute('id', 'svg-pan-zoom-reset-pan-zoom');\n    resetPanZoomControl.setAttribute('transform', 'translate(5 35) scale(0.4)');\n    resetPanZoomControl.setAttribute('class', 'svg-pan-zoom-control');\n    resetPanZoomControl.addEventListener('click', function() {instance.getPublicInstance().reset()}, false);\n    resetPanZoomControl.addEventListener('touchstart', function() {instance.getPublicInstance().reset()}, false);\n\n    var resetPanZoomControlBackground = document.createElementNS(SvgUtils.svgNS, 'rect'); // TODO change these background space fillers to rounded rectangles so they look prettier\n    resetPanZoomControlBackground.setAttribute('x', '2');\n    resetPanZoomControlBackground.setAttribute('y', '2');\n    resetPanZoomControlBackground.setAttribute('width', '182'); // larger than expected because the whole group is transformed to scale down\n    resetPanZoomControlBackground.setAttribute('height', '58');\n    resetPanZoomControlBackground.setAttribute('class', 'svg-pan-zoom-control-background');\n    resetPanZoomControl.appendChild(resetPanZoomControlBackground);\n\n    var resetPanZoomControlShape1 = document.createElementNS(SvgUtils.svgNS, 'path');\n    resetPanZoomControlShape1.setAttribute('d', 'M33.051,20.632c-0.742-0.406-1.854-0.609-3.338-0.609h-7.969v9.281h7.769c1.543,0,2.701-0.188,3.473-0.562c1.365-0.656,2.048-1.953,2.048-3.891C35.032,22.757,34.372,21.351,33.051,20.632z');\n    resetPanZoomControlShape1.setAttribute('class', 'svg-pan-zoom-control-element');\n    resetPanZoomControl.appendChild(resetPanZoomControlShape1);\n\n    var resetPanZoomControlShape2 = document.createElementNS(SvgUtils.svgNS, 'path');\n    resetPanZoomControlShape2.setAttribute('d', 'M170.231,0.5H15.847C7.102,0.5,0.5,5.708,0.5,11.84v38.861C0.5,56.833,7.102,61.5,15.847,61.5h154.384c8.745,0,15.269-4.667,15.269-10.798V11.84C185.5,5.708,178.976,0.5,170.231,0.5z M42.837,48.569h-7.969c-0.219-0.766-0.375-1.383-0.469-1.852c-0.188-0.969-0.289-1.961-0.305-2.977l-0.047-3.211c-0.03-2.203-0.41-3.672-1.142-4.406c-0.732-0.734-2.103-1.102-4.113-1.102h-7.05v13.547h-7.055V14.022h16.524c2.361,0.047,4.178,0.344,5.45,0.891c1.272,0.547,2.351,1.352,3.234,2.414c0.731,0.875,1.31,1.844,1.737,2.906s0.64,2.273,0.64,3.633c0,1.641-0.414,3.254-1.242,4.84s-2.195,2.707-4.102,3.363c1.594,0.641,2.723,1.551,3.387,2.73s0.996,2.98,0.996,5.402v2.32c0,1.578,0.063,2.648,0.19,3.211c0.19,0.891,0.635,1.547,1.333,1.969V48.569z M75.579,48.569h-26.18V14.022h25.336v6.117H56.454v7.336h16.781v6H56.454v8.883h19.125V48.569z M104.497,46.331c-2.44,2.086-5.887,3.129-10.34,3.129c-4.548,0-8.125-1.027-10.731-3.082s-3.909-4.879-3.909-8.473h6.891c0.224,1.578,0.662,2.758,1.316,3.539c1.196,1.422,3.246,2.133,6.15,2.133c1.739,0,3.151-0.188,4.236-0.562c2.058-0.719,3.087-2.055,3.087-4.008c0-1.141-0.504-2.023-1.512-2.648c-1.008-0.609-2.607-1.148-4.796-1.617l-3.74-0.82c-3.676-0.812-6.201-1.695-7.576-2.648c-2.328-1.594-3.492-4.086-3.492-7.477c0-3.094,1.139-5.664,3.417-7.711s5.623-3.07,10.036-3.07c3.685,0,6.829,0.965,9.431,2.895c2.602,1.93,3.966,4.73,4.093,8.402h-6.938c-0.128-2.078-1.057-3.555-2.787-4.43c-1.154-0.578-2.587-0.867-4.301-0.867c-1.907,0-3.428,0.375-4.565,1.125c-1.138,0.75-1.706,1.797-1.706,3.141c0,1.234,0.561,2.156,1.682,2.766c0.721,0.406,2.25,0.883,4.589,1.43l6.063,1.43c2.657,0.625,4.648,1.461,5.975,2.508c2.059,1.625,3.089,3.977,3.089,7.055C108.157,41.624,106.937,44.245,104.497,46.331z M139.61,48.569h-26.18V14.022h25.336v6.117h-18.281v7.336h16.781v6h-16.781v8.883h19.125V48.569z M170.337,20.14h-10.336v28.43h-7.266V20.14h-10.383v-6.117h27.984V20.14z');\n    resetPanZoomControlShape2.setAttribute('class', 'svg-pan-zoom-control-element');\n    resetPanZoomControl.appendChild(resetPanZoomControlShape2);\n\n    return resetPanZoomControl\n  }\n\n, _createZoomOut: function(instance){\n    // zoom out\n    var zoomOut = document.createElementNS(SvgUtils.svgNS, 'g');\n    zoomOut.setAttribute('id', 'svg-pan-zoom-zoom-out');\n    zoomOut.setAttribute('transform', 'translate(30.5 70) scale(0.015)');\n    zoomOut.setAttribute('class', 'svg-pan-zoom-control');\n    zoomOut.addEventListener('click', function() {instance.getPublicInstance().zoomOut()}, false);\n    zoomOut.addEventListener('touchstart', function() {instance.getPublicInstance().zoomOut()}, false);\n\n    var zoomOutBackground = document.createElementNS(SvgUtils.svgNS, 'rect'); // TODO change these background space fillers to rounded rectangles so they look prettier\n    zoomOutBackground.setAttribute('x', '0');\n    zoomOutBackground.setAttribute('y', '0');\n    zoomOutBackground.setAttribute('width', '1500'); // larger than expected because the whole group is transformed to scale down\n    zoomOutBackground.setAttribute('height', '1400');\n    zoomOutBackground.setAttribute('class', 'svg-pan-zoom-control-background');\n    zoomOut.appendChild(zoomOutBackground);\n\n    var zoomOutShape = document.createElementNS(SvgUtils.svgNS, 'path');\n    zoomOutShape.setAttribute('d', 'M1280 576v128q0 26 -19 45t-45 19h-896q-26 0 -45 -19t-19 -45v-128q0 -26 19 -45t45 -19h896q26 0 45 19t19 45zM1536 1120v-960q0 -119 -84.5 -203.5t-203.5 -84.5h-960q-119 0 -203.5 84.5t-84.5 203.5v960q0 119 84.5 203.5t203.5 84.5h960q119 0 203.5 -84.5 t84.5 -203.5z');\n    zoomOutShape.setAttribute('class', 'svg-pan-zoom-control-element');\n    zoomOut.appendChild(zoomOutShape);\n\n    return zoomOut\n  }\n\n, disable: function(instance) {\n    if (instance.controlIcons) {\n      instance.controlIcons.parentNode.removeChild(instance.controlIcons)\n      instance.controlIcons = null\n    }\n  }\n}\n\n},{\"./svg-utilities\":5}],3:[function(require,module,exports){\nvar SvgUtils = require('./svg-utilities')\n  , Utils = require('./utilities')\n  ;\n\nvar ShadowViewport = function(viewport, options){\n  this.init(viewport, options)\n}\n\n/**\n * Initialization\n *\n * @param  {SVGElement} viewport\n * @param  {Object} options\n */\nShadowViewport.prototype.init = function(viewport, options) {\n  // DOM Elements\n  this.viewport = viewport\n  this.options = options\n\n  // State cache\n  this.originalState = {zoom: 1, x: 0, y: 0}\n  this.activeState = {zoom: 1, x: 0, y: 0}\n\n  this.updateCTMCached = Utils.proxy(this.updateCTM, this)\n\n  // Create a custom requestAnimationFrame taking in account refreshRate\n  this.requestAnimationFrame = Utils.createRequestAnimationFrame(this.options.refreshRate)\n\n  // ViewBox\n  this.viewBox = {x: 0, y: 0, width: 0, height: 0}\n  this.cacheViewBox()\n\n  // Process CTM\n  var newCTM = this.processCTM()\n\n  // Update viewport CTM and cache zoom and pan\n  this.setCTM(newCTM)\n\n  // Update CTM in this frame\n  this.updateCTM()\n}\n\n/**\n * Cache initial viewBox value\n * If no viewBox is defined, then use viewport size/position instead for viewBox values\n */\nShadowViewport.prototype.cacheViewBox = function() {\n  var svgViewBox = this.options.svg.getAttribute('viewBox')\n\n  if (svgViewBox) {\n    var viewBoxValues = svgViewBox.split(/[\\s\\,]/).filter(function(v){return v}).map(parseFloat)\n\n    // Cache viewbox x and y offset\n    this.viewBox.x = viewBoxValues[0]\n    this.viewBox.y = viewBoxValues[1]\n    this.viewBox.width = viewBoxValues[2]\n    this.viewBox.height = viewBoxValues[3]\n\n    var zoom = Math.min(this.options.width / this.viewBox.width, this.options.height / this.viewBox.height)\n\n    // Update active state\n    this.activeState.zoom = zoom\n    this.activeState.x = (this.options.width - this.viewBox.width * zoom) / 2\n    this.activeState.y = (this.options.height - this.viewBox.height * zoom) / 2\n\n    // Force updating CTM\n    this.updateCTMOnNextFrame()\n\n    this.options.svg.removeAttribute('viewBox')\n  } else {\n    this.simpleViewBoxCache()\n  }\n}\n\n/**\n * Recalculate viewport sizes and update viewBox cache\n */\nShadowViewport.prototype.simpleViewBoxCache = function() {\n  var bBox = this.viewport.getBBox()\n\n  this.viewBox.x = bBox.x\n  this.viewBox.y = bBox.y\n  this.viewBox.width = bBox.width\n  this.viewBox.height = bBox.height\n}\n\n/**\n * Returns a viewbox object. Safe to alter\n *\n * @return {Object} viewbox object\n */\nShadowViewport.prototype.getViewBox = function() {\n  return Utils.extend({}, this.viewBox)\n}\n\n/**\n * Get initial zoom and pan values. Save them into originalState\n * Parses viewBox attribute to alter initial sizes\n *\n * @return {CTM} CTM object based on options\n */\nShadowViewport.prototype.processCTM = function() {\n  var newCTM = this.getCTM()\n\n  if (this.options.fit || this.options.contain) {\n    var newScale;\n    if (this.options.fit) {\n      newScale = Math.min(this.options.width/this.viewBox.width, this.options.height/this.viewBox.height);\n    } else {\n      newScale = Math.max(this.options.width/this.viewBox.width, this.options.height/this.viewBox.height);\n    }\n\n    newCTM.a = newScale; //x-scale\n    newCTM.d = newScale; //y-scale\n    newCTM.e = -this.viewBox.x * newScale; //x-transform\n    newCTM.f = -this.viewBox.y * newScale; //y-transform\n  }\n\n  if (this.options.center) {\n    var offsetX = (this.options.width - (this.viewBox.width + this.viewBox.x * 2) * newCTM.a) * 0.5\n      , offsetY = (this.options.height - (this.viewBox.height + this.viewBox.y * 2) * newCTM.a) * 0.5\n\n    newCTM.e = offsetX\n    newCTM.f = offsetY\n  }\n\n  // Cache initial values. Based on activeState and fix+center opitons\n  this.originalState.zoom = newCTM.a\n  this.originalState.x = newCTM.e\n  this.originalState.y = newCTM.f\n\n  return newCTM\n}\n\n/**\n * Return originalState object. Safe to alter\n *\n * @return {Object}\n */\nShadowViewport.prototype.getOriginalState = function() {\n  return Utils.extend({}, this.originalState)\n}\n\n/**\n * Return actualState object. Safe to alter\n *\n * @return {Object}\n */\nShadowViewport.prototype.getState = function() {\n  return Utils.extend({}, this.activeState)\n}\n\n/**\n * Get zoom scale\n *\n * @return {Float} zoom scale\n */\nShadowViewport.prototype.getZoom = function() {\n  return this.activeState.zoom\n}\n\n/**\n * Get zoom scale for pubilc usage\n *\n * @return {Float} zoom scale\n */\nShadowViewport.prototype.getRelativeZoom = function() {\n  return this.activeState.zoom / this.originalState.zoom\n}\n\n/**\n * Compute zoom scale for pubilc usage\n *\n * @return {Float} zoom scale\n */\nShadowViewport.prototype.computeRelativeZoom = function(scale) {\n  return scale / this.originalState.zoom\n}\n\n/**\n * Get pan\n *\n * @return {Object}\n */\nShadowViewport.prototype.getPan = function() {\n  return {x: this.activeState.x, y: this.activeState.y}\n}\n\n/**\n * Return cached viewport CTM value that can be safely modified\n *\n * @return {SVGMatrix}\n */\nShadowViewport.prototype.getCTM = function() {\n  var safeCTM = this.options.svg.createSVGMatrix()\n\n  // Copy values manually as in FF they are not itterable\n  safeCTM.a = this.activeState.zoom\n  safeCTM.b = 0\n  safeCTM.c = 0\n  safeCTM.d = this.activeState.zoom\n  safeCTM.e = this.activeState.x\n  safeCTM.f = this.activeState.y\n\n  return safeCTM\n}\n\n/**\n * Set a new CTM\n *\n * @param {SVGMatrix} newCTM\n */\nShadowViewport.prototype.setCTM = function(newCTM) {\n  var willZoom = this.isZoomDifferent(newCTM)\n    , willPan = this.isPanDifferent(newCTM)\n\n  if (willZoom || willPan) {\n    // Before zoom\n    if (willZoom) {\n      // If returns false then cancel zooming\n      if (this.options.beforeZoom(this.getRelativeZoom(), this.computeRelativeZoom(newCTM.a)) === false) {\n        newCTM.a = newCTM.d = this.activeState.zoom\n        willZoom = false\n      } else {\n        this.updateCache(newCTM);\n        this.options.onZoom(this.getRelativeZoom())\n      }\n    }\n\n    // Before pan\n    if (willPan) {\n      var preventPan = this.options.beforePan(this.getPan(), {x: newCTM.e, y: newCTM.f})\n          // If prevent pan is an object\n        , preventPanX = false\n        , preventPanY = false\n\n      // If prevent pan is Boolean false\n      if (preventPan === false) {\n        // Set x and y same as before\n        newCTM.e = this.getPan().x\n        newCTM.f = this.getPan().y\n\n        preventPanX = preventPanY = true\n      } else if (Utils.isObject(preventPan)) {\n        // Check for X axes attribute\n        if (preventPan.x === false) {\n          // Prevent panning on x axes\n          newCTM.e = this.getPan().x\n          preventPanX = true\n        } else if (Utils.isNumber(preventPan.x)) {\n          // Set a custom pan value\n          newCTM.e = preventPan.x\n        }\n\n        // Check for Y axes attribute\n        if (preventPan.y === false) {\n          // Prevent panning on x axes\n          newCTM.f = this.getPan().y\n          preventPanY = true\n        } else if (Utils.isNumber(preventPan.y)) {\n          // Set a custom pan value\n          newCTM.f = preventPan.y\n        }\n      }\n\n      // Update willPan flag\n      // Check if newCTM is still different\n      if ((preventPanX && preventPanY) || !this.isPanDifferent(newCTM)) {\n        willPan = false\n      } else {\n        this.updateCache(newCTM);\n        this.options.onPan(this.getPan());\n      }\n    }\n\n    // Check again if should zoom or pan\n    if (willZoom || willPan) {\n      this.updateCTMOnNextFrame()\n    }\n  }\n}\n\nShadowViewport.prototype.isZoomDifferent = function(newCTM) {\n  return this.activeState.zoom !== newCTM.a\n}\n\nShadowViewport.prototype.isPanDifferent = function(newCTM) {\n  return this.activeState.x !== newCTM.e || this.activeState.y !== newCTM.f\n}\n\n\n/**\n * Update cached CTM and active state\n *\n * @param {SVGMatrix} newCTM\n */\nShadowViewport.prototype.updateCache = function(newCTM) {\n  this.activeState.zoom = newCTM.a\n  this.activeState.x = newCTM.e\n  this.activeState.y = newCTM.f\n}\n\nShadowViewport.prototype.pendingUpdate = false\n\n/**\n * Place a request to update CTM on next Frame\n */\nShadowViewport.prototype.updateCTMOnNextFrame = function() {\n  if (!this.pendingUpdate) {\n    // Lock\n    this.pendingUpdate = true\n\n    // Throttle next update\n    this.requestAnimationFrame.call(window, this.updateCTMCached)\n  }\n}\n\n/**\n * Update viewport CTM with cached CTM\n */\nShadowViewport.prototype.updateCTM = function() {\n  var ctm = this.getCTM()\n\n  // Updates SVG element\n  SvgUtils.setCTM(this.viewport, ctm, this.defs)\n\n  // Free the lock\n  this.pendingUpdate = false\n\n  // Notify about the update\n  if(this.options.onUpdatedCTM) {\n    this.options.onUpdatedCTM(ctm)\n  }\n}\n\nmodule.exports = function(viewport, options){\n  return new ShadowViewport(viewport, options)\n}\n\n},{\"./svg-utilities\":5,\"./utilities\":7}],4:[function(require,module,exports){\nvar Wheel = require('./uniwheel')\n, ControlIcons = require('./control-icons')\n, Utils = require('./utilities')\n, SvgUtils = require('./svg-utilities')\n, ShadowViewport = require('./shadow-viewport')\n\nvar SvgPanZoom = function(svg, options) {\n  this.init(svg, options)\n}\n\nvar optionsDefaults = {\n  viewportSelector: '.svg-pan-zoom_viewport' // Viewport selector. Can be querySelector string or SVGElement\n, panEnabled: true // enable or disable panning (default enabled)\n, controlIconsEnabled: false // insert icons to give user an option in addition to mouse events to control pan/zoom (default disabled)\n, zoomEnabled: true // enable or disable zooming (default enabled)\n, dblClickZoomEnabled: true // enable or disable zooming by double clicking (default enabled)\n, mouseWheelZoomEnabled: true // enable or disable zooming by mouse wheel (default enabled)\n, preventMouseEventsDefault: true // enable or disable preventDefault for mouse events\n, zoomScaleSensitivity: 0.1 // Zoom sensitivity\n, minZoom: 0.5 // Minimum Zoom level\n, maxZoom: 10 // Maximum Zoom level\n, fit: true // enable or disable viewport fit in SVG (default true)\n, contain: false // enable or disable viewport contain the svg (default false)\n, center: true // enable or disable viewport centering in SVG (default true)\n, refreshRate: 'auto' // Maximum number of frames per second (altering SVG's viewport)\n, beforeZoom: null\n, onZoom: null\n, beforePan: null\n, onPan: null\n, customEventsHandler: null\n, eventsListenerElement: null\n, onUpdatedCTM: null\n}\n\nSvgPanZoom.prototype.init = function(svg, options) {\n  var that = this\n\n  this.svg = svg\n  this.defs = svg.querySelector('defs')\n\n  // Add default attributes to SVG\n  SvgUtils.setupSvgAttributes(this.svg)\n\n  // Set options\n  this.options = Utils.extend(Utils.extend({}, optionsDefaults), options)\n\n  // Set default state\n  this.state = 'none'\n\n  // Get dimensions\n  var boundingClientRectNormalized = SvgUtils.getBoundingClientRectNormalized(svg)\n  this.width = boundingClientRectNormalized.width\n  this.height = boundingClientRectNormalized.height\n\n  // Init shadow viewport\n  this.viewport = ShadowViewport(SvgUtils.getOrCreateViewport(this.svg, this.options.viewportSelector), {\n    svg: this.svg\n  , width: this.width\n  , height: this.height\n  , fit: this.options.fit\n  , contain: this.options.contain\n  , center: this.options.center\n  , refreshRate: this.options.refreshRate\n  // Put callbacks into functions as they can change through time\n  , beforeZoom: function(oldScale, newScale) {\n      if (that.viewport && that.options.beforeZoom) {return that.options.beforeZoom(oldScale, newScale)}\n    }\n  , onZoom: function(scale) {\n      if (that.viewport && that.options.onZoom) {return that.options.onZoom(scale)}\n    }\n  , beforePan: function(oldPoint, newPoint) {\n      if (that.viewport && that.options.beforePan) {return that.options.beforePan(oldPoint, newPoint)}\n    }\n  , onPan: function(point) {\n      if (that.viewport && that.options.onPan) {return that.options.onPan(point)}\n    }\n  , onUpdatedCTM: function(ctm) {\n      if (that.viewport && that.options.onUpdatedCTM) {return that.options.onUpdatedCTM(ctm)}\n    }\n  })\n\n  // Wrap callbacks into public API context\n  var publicInstance = this.getPublicInstance()\n  publicInstance.setBeforeZoom(this.options.beforeZoom)\n  publicInstance.setOnZoom(this.options.onZoom)\n  publicInstance.setBeforePan(this.options.beforePan)\n  publicInstance.setOnPan(this.options.onPan)\n  publicInstance.setOnUpdatedCTM(this.options.onUpdatedCTM)\n\n  if (this.options.controlIconsEnabled) {\n    ControlIcons.enable(this)\n  }\n\n  // Init events handlers\n  this.lastMouseWheelEventTime = Date.now()\n  this.setupHandlers()\n}\n\n/**\n * Register event handlers\n */\nSvgPanZoom.prototype.setupHandlers = function() {\n  var that = this\n    , prevEvt = null // use for touchstart event to detect double tap\n    ;\n\n  this.eventListeners = {\n    // Mouse down group\n    mousedown: function(evt) {\n      var result = that.handleMouseDown(evt, prevEvt);\n      prevEvt = evt\n      return result;\n    }\n  , touchstart: function(evt) {\n      var result = that.handleMouseDown(evt, prevEvt);\n      prevEvt = evt\n      return result;\n    }\n\n    // Mouse up group\n  , mouseup: function(evt) {\n      return that.handleMouseUp(evt);\n    }\n  , touchend: function(evt) {\n      return that.handleMouseUp(evt);\n    }\n\n    // Mouse move group\n  , mousemove: function(evt) {\n      return that.handleMouseMove(evt);\n    }\n  , touchmove: function(evt) {\n      return that.handleMouseMove(evt);\n    }\n\n    // Mouse leave group\n  , mouseleave: function(evt) {\n      return that.handleMouseUp(evt);\n    }\n  , touchleave: function(evt) {\n      return that.handleMouseUp(evt);\n    }\n  , touchcancel: function(evt) {\n      return that.handleMouseUp(evt);\n    }\n  }\n\n  // Init custom events handler if available\n  if (this.options.customEventsHandler != null) { // jshint ignore:line\n    this.options.customEventsHandler.init({\n      svgElement: this.svg\n    , eventsListenerElement: this.options.eventsListenerElement\n    , instance: this.getPublicInstance()\n    })\n\n    // Custom event handler may halt builtin listeners\n    var haltEventListeners = this.options.customEventsHandler.haltEventListeners\n    if (haltEventListeners && haltEventListeners.length) {\n      for (var i = haltEventListeners.length - 1; i >= 0; i--) {\n        if (this.eventListeners.hasOwnProperty(haltEventListeners[i])) {\n          delete this.eventListeners[haltEventListeners[i]]\n        }\n      }\n    }\n  }\n\n  // Bind eventListeners\n  for (var event in this.eventListeners) {\n    // Attach event to eventsListenerElement or SVG if not available\n    (this.options.eventsListenerElement || this.svg)\n      .addEventListener(event, this.eventListeners[event], false)\n  }\n\n  // Zoom using mouse wheel\n  if (this.options.mouseWheelZoomEnabled) {\n    this.options.mouseWheelZoomEnabled = false // set to false as enable will set it back to true\n    this.enableMouseWheelZoom()\n  }\n}\n\n/**\n * Enable ability to zoom using mouse wheel\n */\nSvgPanZoom.prototype.enableMouseWheelZoom = function() {\n  if (!this.options.mouseWheelZoomEnabled) {\n    var that = this\n\n    // Mouse wheel listener\n    this.wheelListener = function(evt) {\n      return that.handleMouseWheel(evt);\n    }\n\n    // Bind wheelListener\n    Wheel.on(this.options.eventsListenerElement || this.svg, this.wheelListener, false)\n\n    this.options.mouseWheelZoomEnabled = true\n  }\n}\n\n/**\n * Disable ability to zoom using mouse wheel\n */\nSvgPanZoom.prototype.disableMouseWheelZoom = function() {\n  if (this.options.mouseWheelZoomEnabled) {\n    Wheel.off(this.options.eventsListenerElement || this.svg, this.wheelListener, false)\n    this.options.mouseWheelZoomEnabled = false\n  }\n}\n\n/**\n * Handle mouse wheel event\n *\n * @param  {Event} evt\n */\nSvgPanZoom.prototype.handleMouseWheel = function(evt) {\n  if (!this.options.zoomEnabled || this.state !== 'none') {\n    return;\n  }\n\n  if (this.options.preventMouseEventsDefault){\n    if (evt.preventDefault) {\n      evt.preventDefault();\n    } else {\n      evt.returnValue = false;\n    }\n  }\n\n  // Default delta in case that deltaY is not available\n  var delta = evt.deltaY || 1\n    , timeDelta = Date.now() - this.lastMouseWheelEventTime\n    , divider = 3 + Math.max(0, 30 - timeDelta)\n\n  // Update cache\n  this.lastMouseWheelEventTime = Date.now()\n\n  // Make empirical adjustments for browsers that give deltaY in pixels (deltaMode=0)\n  if ('deltaMode' in evt && evt.deltaMode === 0 && evt.wheelDelta) {\n    delta = evt.deltaY === 0 ? 0 :  Math.abs(evt.wheelDelta) / evt.deltaY\n  }\n\n  delta = -0.3 < delta && delta < 0.3 ? delta : (delta > 0 ? 1 : -1) * Math.log(Math.abs(delta) + 10) / divider\n\n  var inversedScreenCTM = this.svg.getScreenCTM().inverse()\n    , relativeMousePoint = SvgUtils.getEventPoint(evt, this.svg).matrixTransform(inversedScreenCTM)\n    , zoom = Math.pow(1 + this.options.zoomScaleSensitivity, (-1) * delta); // multiplying by neg. 1 so as to make zoom in/out behavior match Google maps behavior\n\n  this.zoomAtPoint(zoom, relativeMousePoint)\n}\n\n/**\n * Zoom in at a SVG point\n *\n * @param  {SVGPoint} point\n * @param  {Float} zoomScale    Number representing how much to zoom\n * @param  {Boolean} zoomAbsolute Default false. If true, zoomScale is treated as an absolute value.\n *                                Otherwise, zoomScale is treated as a multiplied (e.g. 1.10 would zoom in 10%)\n */\nSvgPanZoom.prototype.zoomAtPoint = function(zoomScale, point, zoomAbsolute) {\n  var originalState = this.viewport.getOriginalState()\n\n  if (!zoomAbsolute) {\n    // Fit zoomScale in set bounds\n    if (this.getZoom() * zoomScale < this.options.minZoom * originalState.zoom) {\n      zoomScale = (this.options.minZoom * originalState.zoom) / this.getZoom()\n    } else if (this.getZoom() * zoomScale > this.options.maxZoom * originalState.zoom) {\n      zoomScale = (this.options.maxZoom * originalState.zoom) / this.getZoom()\n    }\n  } else {\n    // Fit zoomScale in set bounds\n    zoomScale = Math.max(this.options.minZoom * originalState.zoom, Math.min(this.options.maxZoom * originalState.zoom, zoomScale))\n    // Find relative scale to achieve desired scale\n    zoomScale = zoomScale/this.getZoom()\n  }\n\n  var oldCTM = this.viewport.getCTM()\n    , relativePoint = point.matrixTransform(oldCTM.inverse())\n    , modifier = this.svg.createSVGMatrix().translate(relativePoint.x, relativePoint.y).scale(zoomScale).translate(-relativePoint.x, -relativePoint.y)\n    , newCTM = oldCTM.multiply(modifier)\n\n  if (newCTM.a !== oldCTM.a) {\n    this.viewport.setCTM(newCTM)\n  }\n}\n\n/**\n * Zoom at center point\n *\n * @param  {Float} scale\n * @param  {Boolean} absolute Marks zoom scale as relative or absolute\n */\nSvgPanZoom.prototype.zoom = function(scale, absolute) {\n  this.zoomAtPoint(scale, SvgUtils.getSvgCenterPoint(this.svg, this.width, this.height), absolute)\n}\n\n/**\n * Zoom used by public instance\n *\n * @param  {Float} scale\n * @param  {Boolean} absolute Marks zoom scale as relative or absolute\n */\nSvgPanZoom.prototype.publicZoom = function(scale, absolute) {\n  if (absolute) {\n    scale = this.computeFromRelativeZoom(scale)\n  }\n\n  this.zoom(scale, absolute)\n}\n\n/**\n * Zoom at point used by public instance\n *\n * @param  {Float} scale\n * @param  {SVGPoint|Object} point    An object that has x and y attributes\n * @param  {Boolean} absolute Marks zoom scale as relative or absolute\n */\nSvgPanZoom.prototype.publicZoomAtPoint = function(scale, point, absolute) {\n  if (absolute) {\n    // Transform zoom into a relative value\n    scale = this.computeFromRelativeZoom(scale)\n  }\n\n  // If not a SVGPoint but has x and y then create a SVGPoint\n  if (Utils.getType(point) !== 'SVGPoint') {\n    if('x' in point && 'y' in point) {\n      point = SvgUtils.createSVGPoint(this.svg, point.x, point.y)\n    } else {\n      throw new Error('Given point is invalid')\n    }\n  }\n\n  this.zoomAtPoint(scale, point, absolute)\n}\n\n/**\n * Get zoom scale\n *\n * @return {Float} zoom scale\n */\nSvgPanZoom.prototype.getZoom = function() {\n  return this.viewport.getZoom()\n}\n\n/**\n * Get zoom scale for public usage\n *\n * @return {Float} zoom scale\n */\nSvgPanZoom.prototype.getRelativeZoom = function() {\n  return this.viewport.getRelativeZoom()\n}\n\n/**\n * Compute actual zoom from public zoom\n *\n * @param  {Float} zoom\n * @return {Float} zoom scale\n */\nSvgPanZoom.prototype.computeFromRelativeZoom = function(zoom) {\n  return zoom * this.viewport.getOriginalState().zoom\n}\n\n/**\n * Set zoom to initial state\n */\nSvgPanZoom.prototype.resetZoom = function() {\n  var originalState = this.viewport.getOriginalState()\n\n  this.zoom(originalState.zoom, true);\n}\n\n/**\n * Set pan to initial state\n */\nSvgPanZoom.prototype.resetPan = function() {\n  this.pan(this.viewport.getOriginalState());\n}\n\n/**\n * Set pan and zoom to initial state\n */\nSvgPanZoom.prototype.reset = function() {\n  this.resetZoom()\n  this.resetPan()\n}\n\n/**\n * Handle double click event\n * See handleMouseDown() for alternate detection method\n *\n * @param {Event} evt\n */\nSvgPanZoom.prototype.handleDblClick = function(evt) {\n  if (this.options.preventMouseEventsDefault) {\n    if (evt.preventDefault) {\n      evt.preventDefault()\n    } else {\n      evt.returnValue = false\n    }\n  }\n\n  // Check if target was a control button\n  if (this.options.controlIconsEnabled) {\n    var targetClass = evt.target.getAttribute('class') || ''\n    if (targetClass.indexOf('svg-pan-zoom-control') > -1) {\n      return false\n    }\n  }\n\n  var zoomFactor\n\n  if (evt.shiftKey) {\n    zoomFactor = 1/((1 + this.options.zoomScaleSensitivity) * 2) // zoom out when shift key pressed\n  } else {\n    zoomFactor = (1 + this.options.zoomScaleSensitivity) * 2\n  }\n\n  var point = SvgUtils.getEventPoint(evt, this.svg).matrixTransform(this.svg.getScreenCTM().inverse())\n  this.zoomAtPoint(zoomFactor, point)\n}\n\n/**\n * Handle click event\n *\n * @param {Event} evt\n */\nSvgPanZoom.prototype.handleMouseDown = function(evt, prevEvt) {\n  if (this.options.preventMouseEventsDefault) {\n    if (evt.preventDefault) {\n      evt.preventDefault()\n    } else {\n      evt.returnValue = false\n    }\n  }\n\n  Utils.mouseAndTouchNormalize(evt, this.svg)\n\n  // Double click detection; more consistent than ondblclick\n  if (this.options.dblClickZoomEnabled && Utils.isDblClick(evt, prevEvt)){\n    this.handleDblClick(evt)\n  } else {\n    // Pan mode\n    this.state = 'pan'\n    this.firstEventCTM = this.viewport.getCTM()\n    this.stateOrigin = SvgUtils.getEventPoint(evt, this.svg).matrixTransform(this.firstEventCTM.inverse())\n  }\n}\n\n/**\n * Handle mouse move event\n *\n * @param  {Event} evt\n */\nSvgPanZoom.prototype.handleMouseMove = function(evt) {\n  if (this.options.preventMouseEventsDefault) {\n    if (evt.preventDefault) {\n      evt.preventDefault()\n    } else {\n      evt.returnValue = false\n    }\n  }\n\n  if (this.state === 'pan' && this.options.panEnabled) {\n    // Pan mode\n    var point = SvgUtils.getEventPoint(evt, this.svg).matrixTransform(this.firstEventCTM.inverse())\n      , viewportCTM = this.firstEventCTM.translate(point.x - this.stateOrigin.x, point.y - this.stateOrigin.y)\n\n    this.viewport.setCTM(viewportCTM)\n  }\n}\n\n/**\n * Handle mouse button release event\n *\n * @param {Event} evt\n */\nSvgPanZoom.prototype.handleMouseUp = function(evt) {\n  if (this.options.preventMouseEventsDefault) {\n    if (evt.preventDefault) {\n      evt.preventDefault()\n    } else {\n      evt.returnValue = false\n    }\n  }\n\n  if (this.state === 'pan') {\n    // Quit pan mode\n    this.state = 'none'\n  }\n}\n\n/**\n * Adjust viewport size (only) so it will fit in SVG\n * Does not center image\n */\nSvgPanZoom.prototype.fit = function() {\n  var viewBox = this.viewport.getViewBox()\n    , newScale = Math.min(this.width/viewBox.width, this.height/viewBox.height)\n\n  this.zoom(newScale, true)\n}\n\n/**\n * Adjust viewport size (only) so it will contain the SVG\n * Does not center image\n */\nSvgPanZoom.prototype.contain = function() {\n  var viewBox = this.viewport.getViewBox()\n    , newScale = Math.max(this.width/viewBox.width, this.height/viewBox.height)\n\n  this.zoom(newScale, true)\n}\n\n/**\n * Adjust viewport pan (only) so it will be centered in SVG\n * Does not zoom/fit/contain image\n */\nSvgPanZoom.prototype.center = function() {\n  var viewBox = this.viewport.getViewBox()\n    , offsetX = (this.width - (viewBox.width + viewBox.x * 2) * this.getZoom()) * 0.5\n    , offsetY = (this.height - (viewBox.height + viewBox.y * 2) * this.getZoom()) * 0.5\n\n  this.getPublicInstance().pan({x: offsetX, y: offsetY})\n}\n\n/**\n * Update content cached BorderBox\n * Use when viewport contents change\n */\nSvgPanZoom.prototype.updateBBox = function() {\n  this.viewport.simpleViewBoxCache()\n}\n\n/**\n * Pan to a rendered position\n *\n * @param  {Object} point {x: 0, y: 0}\n */\nSvgPanZoom.prototype.pan = function(point) {\n  var viewportCTM = this.viewport.getCTM()\n  viewportCTM.e = point.x\n  viewportCTM.f = point.y\n  this.viewport.setCTM(viewportCTM)\n}\n\n/**\n * Relatively pan the graph by a specified rendered position vector\n *\n * @param  {Object} point {x: 0, y: 0}\n */\nSvgPanZoom.prototype.panBy = function(point) {\n  var viewportCTM = this.viewport.getCTM()\n  viewportCTM.e += point.x\n  viewportCTM.f += point.y\n  this.viewport.setCTM(viewportCTM)\n}\n\n/**\n * Get pan vector\n *\n * @return {Object} {x: 0, y: 0}\n */\nSvgPanZoom.prototype.getPan = function() {\n  var state = this.viewport.getState()\n\n  return {x: state.x, y: state.y}\n}\n\n/**\n * Recalculates cached svg dimensions and controls position\n */\nSvgPanZoom.prototype.resize = function() {\n  // Get dimensions\n  var boundingClientRectNormalized = SvgUtils.getBoundingClientRectNormalized(this.svg)\n  this.width = boundingClientRectNormalized.width\n  this.height = boundingClientRectNormalized.height\n\n  // Recalculate original state\n  var viewport = this.viewport\n  viewport.options.width = this.width\n  viewport.options.height = this.height\n  viewport.processCTM()\n\n  // Reposition control icons by re-enabling them\n  if (this.options.controlIconsEnabled) {\n    this.getPublicInstance().disableControlIcons()\n    this.getPublicInstance().enableControlIcons()\n  }\n}\n\n/**\n * Unbind mouse events, free callbacks and destroy public instance\n */\nSvgPanZoom.prototype.destroy = function() {\n  var that = this\n\n  // Free callbacks\n  this.beforeZoom = null\n  this.onZoom = null\n  this.beforePan = null\n  this.onPan = null\n  this.onUpdatedCTM = null\n\n  // Destroy custom event handlers\n  if (this.options.customEventsHandler != null) { // jshint ignore:line\n    this.options.customEventsHandler.destroy({\n      svgElement: this.svg\n    , eventsListenerElement: this.options.eventsListenerElement\n    , instance: this.getPublicInstance()\n    })\n  }\n\n  // Unbind eventListeners\n  for (var event in this.eventListeners) {\n    (this.options.eventsListenerElement || this.svg)\n      .removeEventListener(event, this.eventListeners[event], false)\n  }\n\n  // Unbind wheelListener\n  this.disableMouseWheelZoom()\n\n  // Remove control icons\n  this.getPublicInstance().disableControlIcons()\n\n  // Reset zoom and pan\n  this.reset()\n\n  // Remove instance from instancesStore\n  instancesStore = instancesStore.filter(function(instance){\n    return instance.svg !== that.svg\n  })\n\n  // Delete options and its contents\n  delete this.options\n\n  // Delete viewport to make public shadow viewport functions uncallable\n  delete this.viewport\n\n  // Destroy public instance and rewrite getPublicInstance\n  delete this.publicInstance\n  delete this.pi\n  this.getPublicInstance = function(){\n    return null\n  }\n}\n\n/**\n * Returns a public instance object\n *\n * @return {Object} Public instance object\n */\nSvgPanZoom.prototype.getPublicInstance = function() {\n  var that = this\n\n  // Create cache\n  if (!this.publicInstance) {\n    this.publicInstance = this.pi = {\n      // Pan\n      enablePan: function() {that.options.panEnabled = true; return that.pi}\n    , disablePan: function() {that.options.panEnabled = false; return that.pi}\n    , isPanEnabled: function() {return !!that.options.panEnabled}\n    , pan: function(point) {that.pan(point); return that.pi}\n    , panBy: function(point) {that.panBy(point); return that.pi}\n    , getPan: function() {return that.getPan()}\n      // Pan event\n    , setBeforePan: function(fn) {that.options.beforePan = fn === null ? null : Utils.proxy(fn, that.publicInstance); return that.pi}\n    , setOnPan: function(fn) {that.options.onPan = fn === null ? null : Utils.proxy(fn, that.publicInstance); return that.pi}\n      // Zoom and Control Icons\n    , enableZoom: function() {that.options.zoomEnabled = true; return that.pi}\n    , disableZoom: function() {that.options.zoomEnabled = false; return that.pi}\n    , isZoomEnabled: function() {return !!that.options.zoomEnabled}\n    , enableControlIcons: function() {\n        if (!that.options.controlIconsEnabled) {\n          that.options.controlIconsEnabled = true\n          ControlIcons.enable(that)\n        }\n        return that.pi\n      }\n    , disableControlIcons: function() {\n        if (that.options.controlIconsEnabled) {\n          that.options.controlIconsEnabled = false;\n          ControlIcons.disable(that)\n        }\n        return that.pi\n      }\n    , isControlIconsEnabled: function() {return !!that.options.controlIconsEnabled}\n      // Double click zoom\n    , enableDblClickZoom: function() {that.options.dblClickZoomEnabled = true; return that.pi}\n    , disableDblClickZoom: function() {that.options.dblClickZoomEnabled = false; return that.pi}\n    , isDblClickZoomEnabled: function() {return !!that.options.dblClickZoomEnabled}\n      // Mouse wheel zoom\n    , enableMouseWheelZoom: function() {that.enableMouseWheelZoom(); return that.pi}\n    , disableMouseWheelZoom: function() {that.disableMouseWheelZoom(); return that.pi}\n    , isMouseWheelZoomEnabled: function() {return !!that.options.mouseWheelZoomEnabled}\n      // Zoom scale and bounds\n    , setZoomScaleSensitivity: function(scale) {that.options.zoomScaleSensitivity = scale; return that.pi}\n    , setMinZoom: function(zoom) {that.options.minZoom = zoom; return that.pi}\n    , setMaxZoom: function(zoom) {that.options.maxZoom = zoom; return that.pi}\n      // Zoom event\n    , setBeforeZoom: function(fn) {that.options.beforeZoom = fn === null ? null : Utils.proxy(fn, that.publicInstance); return that.pi}\n    , setOnZoom: function(fn) {that.options.onZoom = fn === null ? null : Utils.proxy(fn, that.publicInstance); return that.pi}\n      // Zooming\n    , zoom: function(scale) {that.publicZoom(scale, true); return that.pi}\n    , zoomBy: function(scale) {that.publicZoom(scale, false); return that.pi}\n    , zoomAtPoint: function(scale, point) {that.publicZoomAtPoint(scale, point, true); return that.pi}\n    , zoomAtPointBy: function(scale, point) {that.publicZoomAtPoint(scale, point, false); return that.pi}\n    , zoomIn: function() {this.zoomBy(1 + that.options.zoomScaleSensitivity); return that.pi}\n    , zoomOut: function() {this.zoomBy(1 / (1 + that.options.zoomScaleSensitivity)); return that.pi}\n    , getZoom: function() {return that.getRelativeZoom()}\n      // CTM update\n    , setOnUpdatedCTM: function(fn) {that.options.onUpdatedCTM = fn === null ? null : Utils.proxy(fn, that.publicInstance); return that.pi}\n      // Reset\n    , resetZoom: function() {that.resetZoom(); return that.pi}\n    , resetPan: function() {that.resetPan(); return that.pi}\n    , reset: function() {that.reset(); return that.pi}\n      // Fit, Contain and Center\n    , fit: function() {that.fit(); return that.pi}\n    , contain: function() {that.contain(); return that.pi}\n    , center: function() {that.center(); return that.pi}\n      // Size and Resize\n    , updateBBox: function() {that.updateBBox(); return that.pi}\n    , resize: function() {that.resize(); return that.pi}\n    , getSizes: function() {\n        return {\n          width: that.width\n        , height: that.height\n        , realZoom: that.getZoom()\n        , viewBox: that.viewport.getViewBox()\n        }\n      }\n      // Destroy\n    , destroy: function() {that.destroy(); return that.pi}\n    }\n  }\n\n  return this.publicInstance\n}\n\n/**\n * Stores pairs of instances of SvgPanZoom and SVG\n * Each pair is represented by an object {svg: SVGSVGElement, instance: SvgPanZoom}\n *\n * @type {Array}\n */\nvar instancesStore = []\n\nvar svgPanZoom = function(elementOrSelector, options){\n  var svg = Utils.getSvg(elementOrSelector)\n\n  if (svg === null) {\n    return null\n  } else {\n    // Look for existent instance\n    for(var i = instancesStore.length - 1; i >= 0; i--) {\n      if (instancesStore[i].svg === svg) {\n        return instancesStore[i].instance.getPublicInstance()\n      }\n    }\n\n    // If instance not found - create one\n    instancesStore.push({\n      svg: svg\n    , instance: new SvgPanZoom(svg, options)\n    })\n\n    // Return just pushed instance\n    return instancesStore[instancesStore.length - 1].instance.getPublicInstance()\n  }\n}\n\nmodule.exports = svgPanZoom;\n\n},{\"./control-icons\":2,\"./shadow-viewport\":3,\"./svg-utilities\":5,\"./uniwheel\":6,\"./utilities\":7}],5:[function(require,module,exports){\nvar Utils = require('./utilities')\n  , _browser = 'unknown'\n  ;\n\n// http://stackoverflow.com/questions/9847580/how-to-detect-safari-chrome-ie-firefox-and-opera-browser\nif (/*@cc_on!@*/false || !!document.documentMode) { // internet explorer\n  _browser = 'ie';\n}\n\nmodule.exports = {\n  svgNS:  'http://www.w3.org/2000/svg'\n, xmlNS:  'http://www.w3.org/XML/1998/namespace'\n, xmlnsNS:  'http://www.w3.org/2000/xmlns/'\n, xlinkNS:  'http://www.w3.org/1999/xlink'\n, evNS:  'http://www.w3.org/2001/xml-events'\n\n  /**\n   * Get svg dimensions: width and height\n   *\n   * @param  {SVGSVGElement} svg\n   * @return {Object}     {width: 0, height: 0}\n   */\n, getBoundingClientRectNormalized: function(svg) {\n    if (svg.clientWidth && svg.clientHeight) {\n      return {width: svg.clientWidth, height: svg.clientHeight}\n    } else if (!!svg.getBoundingClientRect()) {\n      return svg.getBoundingClientRect();\n    } else {\n      throw new Error('Cannot get BoundingClientRect for SVG.');\n    }\n  }\n\n  /**\n   * Gets g element with class of \"viewport\" or creates it if it doesn't exist\n   *\n   * @param  {SVGSVGElement} svg\n   * @return {SVGElement}     g (group) element\n   */\n, getOrCreateViewport: function(svg, selector) {\n    var viewport = null\n\n    if (Utils.isElement(selector)) {\n      viewport = selector\n    } else {\n      viewport = svg.querySelector(selector)\n    }\n\n    // Check if there is just one main group in SVG\n    if (!viewport) {\n      var childNodes = Array.prototype.slice.call(svg.childNodes || svg.children).filter(function(el){\n        return el.nodeName !== 'defs' && el.nodeName !== '#text'\n      })\n\n      // Node name should be SVGGElement and should have no transform attribute\n      // Groups with transform are not used as viewport because it involves parsing of all transform possibilities\n      if (childNodes.length === 1 && childNodes[0].nodeName === 'g' && childNodes[0].getAttribute('transform') === null) {\n        viewport = childNodes[0]\n      }\n    }\n\n    // If no favorable group element exists then create one\n    if (!viewport) {\n      var viewportId = 'viewport-' + new Date().toISOString().replace(/\\D/g, '');\n      viewport = document.createElementNS(this.svgNS, 'g');\n      viewport.setAttribute('id', viewportId);\n\n      // Internet Explorer (all versions?) can't use childNodes, but other browsers prefer (require?) using childNodes\n      var svgChildren = svg.childNodes || svg.children;\n      if (!!svgChildren && svgChildren.length > 0) {\n        for (var i = svgChildren.length; i > 0; i--) {\n          // Move everything into viewport except defs\n          if (svgChildren[svgChildren.length - i].nodeName !== 'defs') {\n            viewport.appendChild(svgChildren[svgChildren.length - i]);\n          }\n        }\n      }\n      svg.appendChild(viewport);\n    }\n\n    // Parse class names\n    var classNames = [];\n    if (viewport.getAttribute('class')) {\n      classNames = viewport.getAttribute('class').split(' ')\n    }\n\n    // Set class (if not set already)\n    if (!~classNames.indexOf('svg-pan-zoom_viewport')) {\n      classNames.push('svg-pan-zoom_viewport')\n      viewport.setAttribute('class', classNames.join(' '))\n    }\n\n    return viewport\n  }\n\n  /**\n   * Set SVG attributes\n   *\n   * @param  {SVGSVGElement} svg\n   */\n  , setupSvgAttributes: function(svg) {\n    // Setting default attributes\n    svg.setAttribute('xmlns', this.svgNS);\n    svg.setAttributeNS(this.xmlnsNS, 'xmlns:xlink', this.xlinkNS);\n    svg.setAttributeNS(this.xmlnsNS, 'xmlns:ev', this.evNS);\n\n    // Needed for Internet Explorer, otherwise the viewport overflows\n    if (svg.parentNode !== null) {\n      var style = svg.getAttribute('style') || '';\n      if (style.toLowerCase().indexOf('overflow') === -1) {\n        svg.setAttribute('style', 'overflow: hidden; ' + style);\n      }\n    }\n  }\n\n/**\n * How long Internet Explorer takes to finish updating its display (ms).\n */\n, internetExplorerRedisplayInterval: 300\n\n/**\n * Forces the browser to redisplay all SVG elements that rely on an\n * element defined in a 'defs' section. It works globally, for every\n * available defs element on the page.\n * The throttling is intentionally global.\n *\n * This is only needed for IE. It is as a hack to make markers (and 'use' elements?)\n * visible after pan/zoom when there are multiple SVGs on the page.\n * See bug report: https://connect.microsoft.com/IE/feedback/details/781964/\n * also see svg-pan-zoom issue: https://github.com/ariutta/svg-pan-zoom/issues/62\n */\n, refreshDefsGlobal: Utils.throttle(function() {\n    var allDefs = document.querySelectorAll('defs');\n    var allDefsCount = allDefs.length;\n    for (var i = 0; i < allDefsCount; i++) {\n      var thisDefs = allDefs[i];\n      thisDefs.parentNode.insertBefore(thisDefs, thisDefs);\n    }\n  }, this.internetExplorerRedisplayInterval)\n\n  /**\n   * Sets the current transform matrix of an element\n   *\n   * @param {SVGElement} element\n   * @param {SVGMatrix} matrix  CTM\n   * @param {SVGElement} defs\n   */\n, setCTM: function(element, matrix, defs) {\n    var that = this\n      , s = 'matrix(' + matrix.a + ',' + matrix.b + ',' + matrix.c + ',' + matrix.d + ',' + matrix.e + ',' + matrix.f + ')';\n\n    element.setAttributeNS(null, 'transform', s);\n    if ('transform' in element.style) {\n      element.style.transform = s;\n    } else if ('-ms-transform' in element.style) {\n      element.style['-ms-transform'] = s;\n    } else if ('-webkit-transform' in element.style) {\n      element.style['-webkit-transform'] = s;\n    }\n\n    // IE has a bug that makes markers disappear on zoom (when the matrix \"a\" and/or \"d\" elements change)\n    // see http://stackoverflow.com/questions/17654578/svg-marker-does-not-work-in-ie9-10\n    // and http://srndolha.wordpress.com/2013/11/25/svg-line-markers-may-disappear-in-internet-explorer-11/\n    if (_browser === 'ie' && !!defs) {\n      // this refresh is intended for redisplaying the SVG during zooming\n      defs.parentNode.insertBefore(defs, defs);\n      // this refresh is intended for redisplaying the other SVGs on a page when panning a given SVG\n      // it is also needed for the given SVG itself, on zoomEnd, if the SVG contains any markers that\n      // are located under any other element(s).\n      window.setTimeout(function() {\n        that.refreshDefsGlobal();\n      }, that.internetExplorerRedisplayInterval);\n    }\n  }\n\n  /**\n   * Instantiate an SVGPoint object with given event coordinates\n   *\n   * @param {Event} evt\n   * @param  {SVGSVGElement} svg\n   * @return {SVGPoint}     point\n   */\n, getEventPoint: function(evt, svg) {\n    var point = svg.createSVGPoint()\n\n    Utils.mouseAndTouchNormalize(evt, svg)\n\n    point.x = evt.clientX\n    point.y = evt.clientY\n\n    return point\n  }\n\n  /**\n   * Get SVG center point\n   *\n   * @param  {SVGSVGElement} svg\n   * @return {SVGPoint}\n   */\n, getSvgCenterPoint: function(svg, width, height) {\n    return this.createSVGPoint(svg, width / 2, height / 2)\n  }\n\n  /**\n   * Create a SVGPoint with given x and y\n   *\n   * @param  {SVGSVGElement} svg\n   * @param  {Number} x\n   * @param  {Number} y\n   * @return {SVGPoint}\n   */\n, createSVGPoint: function(svg, x, y) {\n    var point = svg.createSVGPoint()\n    point.x = x\n    point.y = y\n\n    return point\n  }\n}\n\n},{\"./utilities\":7}],6:[function(require,module,exports){\n// uniwheel 0.1.2 (customized)\n// A unified cross browser mouse wheel event handler\n// https://github.com/teemualap/uniwheel\n\nmodule.exports = (function(){\n\n  //Full details: https://developer.mozilla.org/en-US/docs/Web/Reference/Events/wheel\n\n  var prefix = \"\", _addEventListener, _removeEventListener, onwheel, support, fns = [];\n\n  // detect event model\n  if ( window.addEventListener ) {\n    _addEventListener = \"addEventListener\";\n    _removeEventListener = \"removeEventListener\";\n  } else {\n    _addEventListener = \"attachEvent\";\n    _removeEventListener = \"detachEvent\";\n    prefix = \"on\";\n  }\n\n  // detect available wheel event\n  support = \"onwheel\" in document.createElement(\"div\") ? \"wheel\" : // Modern browsers support \"wheel\"\n            document.onmousewheel !== undefined ? \"mousewheel\" : // Webkit and IE support at least \"mousewheel\"\n            \"DOMMouseScroll\"; // let's assume that remaining browsers are older Firefox\n\n\n  function createCallback(element,callback,capture) {\n\n    var fn = function(originalEvent) {\n\n      !originalEvent && ( originalEvent = window.event );\n\n      // create a normalized event object\n      var event = {\n        // keep a ref to the original event object\n        originalEvent: originalEvent,\n        target: originalEvent.target || originalEvent.srcElement,\n        type: \"wheel\",\n        deltaMode: originalEvent.type == \"MozMousePixelScroll\" ? 0 : 1,\n        deltaX: 0,\n        delatZ: 0,\n        preventDefault: function() {\n          originalEvent.preventDefault ?\n            originalEvent.preventDefault() :\n            originalEvent.returnValue = false;\n        }\n      };\n\n      // calculate deltaY (and deltaX) according to the event\n      if ( support == \"mousewheel\" ) {\n        event.deltaY = - 1/40 * originalEvent.wheelDelta;\n        // Webkit also support wheelDeltaX\n        originalEvent.wheelDeltaX && ( event.deltaX = - 1/40 * originalEvent.wheelDeltaX );\n      } else {\n        event.deltaY = originalEvent.detail;\n      }\n\n      // it's time to fire the callback\n      return callback( event );\n\n    };\n\n    fns.push({\n      element: element,\n      fn: fn,\n      capture: capture\n    });\n\n    return fn;\n  }\n\n  function getCallback(element,capture) {\n    for (var i = 0; i < fns.length; i++) {\n      if (fns[i].element === element && fns[i].capture === capture) {\n        return fns[i].fn;\n      }\n    }\n    return function(){};\n  }\n\n  function removeCallback(element,capture) {\n    for (var i = 0; i < fns.length; i++) {\n      if (fns[i].element === element && fns[i].capture === capture) {\n        return fns.splice(i,1);\n      }\n    }\n  }\n\n  function _addWheelListener( elem, eventName, callback, useCapture ) {\n\n    var cb;\n\n    if (support === \"wheel\") {\n      cb = callback;\n    } else {\n      cb = createCallback(elem,callback,useCapture);\n    }\n\n    elem[ _addEventListener ]( prefix + eventName, cb, useCapture || false );\n\n  }\n\n  function _removeWheelListener( elem, eventName, callback, useCapture ) {\n\n    var cb;\n\n    if (support === \"wheel\") {\n      cb = callback;\n    } else {\n      cb = getCallback(elem,useCapture);\n    }\n\n    elem[ _removeEventListener ]( prefix + eventName, cb, useCapture || false );\n\n    removeCallback(elem,useCapture);\n\n  }\n\n  function addWheelListener( elem, callback, useCapture ) {\n    _addWheelListener( elem, support, callback, useCapture );\n\n    // handle MozMousePixelScroll in older Firefox\n    if( support == \"DOMMouseScroll\" ) {\n        _addWheelListener( elem, \"MozMousePixelScroll\", callback, useCapture);\n    }\n  }\n\n  function removeWheelListener(elem,callback,useCapture){\n    _removeWheelListener(elem,support,callback,useCapture);\n\n    // handle MozMousePixelScroll in older Firefox\n    if( support == \"DOMMouseScroll\" ) {\n        _removeWheelListener(elem, \"MozMousePixelScroll\", callback, useCapture);\n    }\n  }\n\n  return {\n    on: addWheelListener,\n    off: removeWheelListener\n  };\n\n})();\n\n},{}],7:[function(require,module,exports){\nmodule.exports = {\n  /**\n   * Extends an object\n   *\n   * @param  {Object} target object to extend\n   * @param  {Object} source object to take properties from\n   * @return {Object}        extended object\n   */\n  extend: function(target, source) {\n    target = target || {};\n    for (var prop in source) {\n      // Go recursively\n      if (this.isObject(source[prop])) {\n        target[prop] = this.extend(target[prop], source[prop])\n      } else {\n        target[prop] = source[prop]\n      }\n    }\n    return target;\n  }\n\n  /**\n   * Checks if an object is a DOM element\n   *\n   * @param  {Object}  o HTML element or String\n   * @return {Boolean}   returns true if object is a DOM element\n   */\n, isElement: function(o){\n    return (\n      o instanceof HTMLElement || o instanceof SVGElement || o instanceof SVGSVGElement || //DOM2\n      (o && typeof o === 'object' && o !== null && o.nodeType === 1 && typeof o.nodeName === 'string')\n    );\n  }\n\n  /**\n   * Checks if an object is an Object\n   *\n   * @param  {Object}  o Object\n   * @return {Boolean}   returns true if object is an Object\n   */\n, isObject: function(o){\n    return Object.prototype.toString.call(o) === '[object Object]';\n  }\n\n  /**\n   * Checks if variable is Number\n   *\n   * @param  {Integer|Float}  n\n   * @return {Boolean}   returns true if variable is Number\n   */\n, isNumber: function(n) {\n    return !isNaN(parseFloat(n)) && isFinite(n);\n  }\n\n  /**\n   * Search for an SVG element\n   *\n   * @param  {Object|String} elementOrSelector DOM Element or selector String\n   * @return {Object|Null}                   SVG or null\n   */\n, getSvg: function(elementOrSelector) {\n    var element\n      , svg;\n\n    if (!this.isElement(elementOrSelector)) {\n      // If selector provided\n      if (typeof elementOrSelector === 'string' || elementOrSelector instanceof String) {\n        // Try to find the element\n        element = document.querySelector(elementOrSelector)\n\n        if (!element) {\n          throw new Error('Provided selector did not find any elements. Selector: ' + elementOrSelector)\n          return null\n        }\n      } else {\n        throw new Error('Provided selector is not an HTML object nor String')\n        return null\n      }\n    } else {\n      element = elementOrSelector\n    }\n\n    if (element.tagName.toLowerCase() === 'svg') {\n      svg = element;\n    } else {\n      if (element.tagName.toLowerCase() === 'object') {\n        svg = element.contentDocument.documentElement;\n      } else {\n        if (element.tagName.toLowerCase() === 'embed') {\n          svg = element.getSVGDocument().documentElement;\n        } else {\n          if (element.tagName.toLowerCase() === 'img') {\n            throw new Error('Cannot script an SVG in an \"img\" element. Please use an \"object\" element or an in-line SVG.');\n          } else {\n            throw new Error('Cannot get SVG.');\n          }\n          return null\n        }\n      }\n    }\n\n    return svg\n  }\n\n  /**\n   * Attach a given context to a function\n   * @param  {Function} fn      Function\n   * @param  {Object}   context Context\n   * @return {Function}           Function with certain context\n   */\n, proxy: function(fn, context) {\n    return function() {\n      return fn.apply(context, arguments)\n    }\n  }\n\n  /**\n   * Returns object type\n   * Uses toString that returns [object SVGPoint]\n   * And than parses object type from string\n   *\n   * @param  {Object} o Any object\n   * @return {String}   Object type\n   */\n, getType: function(o) {\n    return Object.prototype.toString.apply(o).replace(/^\\[object\\s/, '').replace(/\\]$/, '')\n  }\n\n  /**\n   * If it is a touch event than add clientX and clientY to event object\n   *\n   * @param  {Event} evt\n   * @param  {SVGSVGElement} svg\n   */\n, mouseAndTouchNormalize: function(evt, svg) {\n    // If no cilentX and but touch objects are available\n    if (evt.clientX === void 0 || evt.clientX === null) {\n      // Fallback\n      evt.clientX = 0\n      evt.clientY = 0\n\n      // If it is a touch event\n      if (evt.changedTouches !== void 0 && evt.changedTouches.length) {\n        // If touch event has changedTouches\n        if (evt.changedTouches[0].clientX !== void 0) {\n          evt.clientX = evt.changedTouches[0].clientX\n          evt.clientY = evt.changedTouches[0].clientY\n        }\n        // If changedTouches has pageX attribute\n        else if (evt.changedTouches[0].pageX !== void 0) {\n          var rect = svg.getBoundingClientRect();\n\n          evt.clientX = evt.changedTouches[0].pageX - rect.left\n          evt.clientY = evt.changedTouches[0].pageY - rect.top\n        }\n      // If it is a custom event\n      } else if (evt.originalEvent !== void 0) {\n        if (evt.originalEvent.clientX !== void 0) {\n          evt.clientX = evt.originalEvent.clientX\n          evt.clientY = evt.originalEvent.clientY\n        }\n      }\n    }\n  }\n\n  /**\n   * Check if an event is a double click/tap\n   * TODO: For touch gestures use a library (hammer.js) that takes in account other events\n   * (touchmove and touchend). It should take in account tap duration and traveled distance\n   *\n   * @param  {Event}  evt\n   * @param  {Event}  prevEvt Previous Event\n   * @return {Boolean}\n   */\n, isDblClick: function(evt, prevEvt) {\n    // Double click detected by browser\n    if (evt.detail === 2) {\n      return true;\n    }\n    // Try to compare events\n    else if (prevEvt !== void 0 && prevEvt !== null) {\n      var timeStampDiff = evt.timeStamp - prevEvt.timeStamp // should be lower than 250 ms\n        , touchesDistance = Math.sqrt(Math.pow(evt.clientX - prevEvt.clientX, 2) + Math.pow(evt.clientY - prevEvt.clientY, 2))\n\n      return timeStampDiff < 250 && touchesDistance < 10\n    }\n\n    // Nothing found\n    return false;\n  }\n\n  /**\n   * Returns current timestamp as an integer\n   *\n   * @return {Number}\n   */\n, now: Date.now || function() {\n    return new Date().getTime();\n  }\n\n  // From underscore.\n  // Returns a function, that, when invoked, will only be triggered at most once\n  // during a given window of time. Normally, the throttled function will run\n  // as much as it can, without ever going more than once per `wait` duration;\n  // but if you'd like to disable the execution on the leading edge, pass\n  // `{leading: false}`. To disable execution on the trailing edge, ditto.\n// jscs:disable\n// jshint ignore:start\n, throttle: function(func, wait, options) {\n    var that = this;\n    var context, args, result;\n    var timeout = null;\n    var previous = 0;\n    if (!options) options = {};\n    var later = function() {\n      previous = options.leading === false ? 0 : that.now();\n      timeout = null;\n      result = func.apply(context, args);\n      if (!timeout) context = args = null;\n    };\n    return function() {\n      var now = that.now();\n      if (!previous && options.leading === false) previous = now;\n      var remaining = wait - (now - previous);\n      context = this;\n      args = arguments;\n      if (remaining <= 0 || remaining > wait) {\n        clearTimeout(timeout);\n        timeout = null;\n        previous = now;\n        result = func.apply(context, args);\n        if (!timeout) context = args = null;\n      } else if (!timeout && options.trailing !== false) {\n        timeout = setTimeout(later, remaining);\n      }\n      return result;\n    };\n  }\n// jshint ignore:end\n// jscs:enable\n\n  /**\n   * Create a requestAnimationFrame simulation\n   *\n   * @param  {Number|String} refreshRate\n   * @return {Function}\n   */\n, createRequestAnimationFrame: function(refreshRate) {\n    var timeout = null\n\n    // Convert refreshRate to timeout\n    if (refreshRate !== 'auto' && refreshRate < 60 && refreshRate > 1) {\n      timeout = Math.floor(1000 / refreshRate)\n    }\n\n    if (timeout === null) {\n      return window.requestAnimationFrame || requestTimeout(33)\n    } else {\n      return requestTimeout(timeout)\n    }\n  }\n}\n\n/**\n * Create a callback that will execute after a given timeout\n *\n * @param  {Function} timeout\n * @return {Function}\n */\nfunction requestTimeout(timeout) {\n  return function(callback) {\n    window.setTimeout(callback, timeout)\n  }\n}\n\n},{}],8:[function(require,module,exports){\n\"use strict\";\nfunction __export(m) {\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\n}\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar nodecanvas_1 = require(\"./nodecanvas\");\nvar menu_1 = require(\"./menu\");\nvar CodeNodes = (function () {\n    function CodeNodes(types) {\n        this.nodesCount = 0;\n        var self = this;\n        this.canvas = new nodecanvas_1.NodeCanvas();\n        this.types = types.sort(function (a, b) {\n            return b.name.localeCompare(a.name);\n        }).reverse();\n        this.menu = new menu_1.CodeNodesMenu(this);\n        this.canvas.ondblclick = function (p, rawP) {\n            self.menuPoint = p;\n            self.menu.open(rawP.x + 20, rawP.y - 70);\n        };\n        this.canvas.onclick = function () {\n            self.menu.close();\n        };\n    }\n    ;\n    CodeNodes.prototype.getSVG = function () {\n        this.canvas.render();\n        return this.canvas.svg;\n    };\n    ;\n    CodeNodes.prototype.init = function () {\n        this.canvas.init();\n        this.canvas.svg.appendChild(this.menu.g);\n    };\n    ;\n    CodeNodes.prototype.center = function () {\n        this.canvas.center();\n    };\n    ;\n    CodeNodes.prototype.clear = function () {\n        this.canvas.clear();\n    };\n    CodeNodes.prototype.findType = function (tID) {\n        var i = 0, len = this.types.length;\n        for (; i < len; i++) {\n            if (this.types[i].id === tID)\n                return this.types[i];\n        }\n        return null;\n    };\n    CodeNodes.prototype.collectionTypeOf = function (t) {\n        return {\n            id: t.id,\n            name: t.name,\n            description: \"(Collection) \" + t.description,\n            builder: this.collectionBuilder,\n            clone: this.collectionClone,\n            clonable: t.clonable,\n            outputType: t.outputType,\n            outputMultiple: true,\n            schema: [\n                {\n                    name: \" - \" + t.name,\n                    type: t.id,\n                    mode: \"in\",\n                    options: null,\n                    multiple: false\n                }\n            ]\n        };\n    };\n    CodeNodes.prototype.addNode = function (name, type) {\n        var t = this.findType(type);\n        if (t) {\n            var outputType = t.outputType || type;\n            var ot = this.findType(outputType);\n            t[\"outputType\"] = outputType;\n            if (ot) {\n                var p = this.menuPoint || { x: 10, y: 10 };\n                this.canvas.addNode({\n                    id: this.nodesCount++,\n                    title: name,\n                    type: t,\n                    isCollection: false,\n                    x: p.x,\n                    y: p.y\n                });\n            }\n            else {\n                console.log(\"There is no type \" + outputType + \" registered. Can not assign output type.\");\n            }\n        }\n        else {\n            console.log(\"There is no type \" + type + \" registered\");\n        }\n    };\n    ;\n    CodeNodes.prototype.collectionBuilder = function () {\n        function flatten(arr) {\n            return arr.reduce(function (flat, toFlatten) {\n                return flat.concat(Array.isArray(toFlatten) ? flatten(toFlatten) : toFlatten);\n            }, []);\n        }\n        return flatten(arguments).filter(function (v) {\n            return typeof v !== \"undefined\";\n        });\n    };\n    ;\n    CodeNodes.prototype.collectionClone = function (arr) {\n        return arr;\n        // return arr.map(function (e) {\n        //     return e.clone()\n        // }); TODO: Arreglar això\n    };\n    ;\n    CodeNodes.prototype.addCollection = function (name, ofType) {\n        var t = this.findType(ofType);\n        if (t) {\n            var outputType = t.outputType || ofType;\n            var ot = this.findType(outputType);\n            t[\"outputType\"] = outputType;\n            if (ot) {\n                var p = this.menuPoint || { x: 10, y: 10 };\n                //name, this.collectionBuilder, collectionSchema, ofType, ot.clonable || false, this.collectionClone, true, outputType, p.x, p.y\n                this.canvas.addNode({\n                    id: this.nodesCount++,\n                    title: name,\n                    type: this.collectionTypeOf(t),\n                    isCollection: true,\n                    x: p.x,\n                    y: p.y\n                });\n            }\n            else {\n                console.log(\"There is no type \" + outputType + \" registered. Can not assign output type.\");\n            }\n        }\n        else {\n            console.log(\"There is no type \" + ofType + \" registered\");\n        }\n    };\n    ;\n    CodeNodes.prototype.serialize = function () {\n        return {\n            nodes: this.canvas.serialize(),\n            transform: this.canvas.getTransform()\n        };\n    };\n    ;\n    CodeNodes.prototype.parse = function (model) {\n        var self = this;\n        this.canvas.setTransform(model.transform);\n        self.canvas.parse(model.nodes);\n    };\n    CodeNodes.prototype.getOfType = function (type) {\n        return this.canvas.getOfType(type);\n    };\n    return CodeNodes;\n}());\nexports.CodeNodes = CodeNodes;\n__export(require(\"./nodecanvas\"));\n__export(require(\"./node\"));\n__export(require(\"./menu\"));\n__export(require(\"./point\"));\n__export(require(\"./nodeconnector\"));\n__export(require(\"./nodevalue\"));\n\n\n\n},{\"./menu\":9,\"./node\":10,\"./nodecanvas\":11,\"./nodeconnector\":12,\"./nodevalue\":13,\"./point\":14}],9:[function(require,module,exports){\n\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar namespace = \"http://www.w3.org/2000/svg\";\nvar CodeNodesMenu = (function () {\n    function CodeNodesMenu(main) {\n        var self = this;\n        var addMode = null;\n        this.main = main;\n        this.g = document.createElementNS(namespace, \"g\");\n        this.g.classList.add(\"menu-g\");\n        var selectedValue = null;\n        var popup = document.createElement(\"div\");\n        popup.classList.add(\"codenodes-menu-popup\");\n        this.popup = popup;\n        var popupLayer = document.createElement(\"div\");\n        popupLayer.classList.add(\"layer\");\n        var popupContent = document.createElement(\"div\");\n        popupContent.classList.add(\"content\");\n        var popupWraper = document.createElement(\"div\");\n        popupWraper.classList.add(\"wraper\");\n        var popupTitle = document.createElement(\"div\");\n        popupTitle.classList.add(\"title\");\n        var entitySelector = document.createElement(\"div\");\n        entitySelector.classList.add(\"select\");\n        var entitySelectorWrap = document.createElement(\"div\");\n        entitySelectorWrap.classList.add(\"entity-selector\");\n        var entityName = document.createElement(\"input\");\n        entityName.type = \"text\";\n        var entityNameWrap = document.createElement(\"div\");\n        entityNameWrap.classList.add(\"entity-name\");\n        var popupOK = document.createElement(\"div\");\n        popupOK.classList.add(\"ok\");\n        popup.appendChild(popupLayer);\n        popup.appendChild(popupWraper);\n        popupWraper.appendChild(popupContent);\n        entityNameWrap.appendChild(entityName);\n        popupContent.appendChild(entityNameWrap);\n        entitySelectorWrap.appendChild(entitySelector);\n        popupContent.appendChild(entitySelectorWrap);\n        popupContent.appendChild(popupOK);\n        document.body.appendChild(popup);\n        popupOK.addEventListener(\"click\", function () {\n            self.close();\n            switch (addMode) {\n                case \"node\":\n                    main.addNode(entityName.value, selectedValue);\n                    break;\n                case \"collection\":\n                    main.addCollection(entityName.value, selectedValue);\n                    break;\n            }\n        });\n        function fillEntitySelector() {\n            entitySelector.innerHTML = \"\";\n            self.main.types.forEach(function (t) {\n                var opt = document.createElement(\"div\");\n                opt.classList.add(\"option\");\n                var name = document.createElement(\"div\");\n                var desc = document.createElement(\"div\");\n                name.classList.add(\"name\");\n                desc.classList.add(\"desc\");\n                name.textContent = t.name;\n                desc.textContent = t.description;\n                opt.appendChild(name);\n                opt.appendChild(desc);\n                opt.addEventListener(\"click\", function () {\n                    [].forEach.call(entitySelector.querySelectorAll(\".option\"), function (o) {\n                        o.classList.remove(\"selected\");\n                    });\n                    opt.classList.add(\"selected\");\n                    selectedValue = t.id;\n                });\n                entitySelector.appendChild(opt);\n            });\n        }\n        var _loop_1 = function (i) {\n            var rect = document.createElementNS(namespace, \"rect\"), t = document.createElementNS(namespace, \"text\");\n            rect.classList.add(\"menu-rect\");\n            t.classList.add(\"menu-t\");\n            rect.setAttribute(\"x\", (5).toString());\n            rect.setAttribute(\"y\", (35 * i).toString());\n            t.setAttribute(\"x\", (10).toString());\n            t.setAttribute(\"y\", ((35 * i) + 19).toString());\n            self.g.appendChild(rect);\n            self.g.appendChild(t);\n            switch (i) {\n                case 0:\n                    t.textContent = \"Add node\";\n                    rect.addEventListener(\"click\", function (evt) {\n                        popupTitle.textContent = t.textContent;\n                        entityName.value = \"New node\";\n                        entityName.focus();\n                        fillEntitySelector();\n                        addMode = \"node\";\n                        popup.classList.add(\"visible\");\n                        evt.stopPropagation();\n                    });\n                    break;\n                case 1:\n                    t.textContent = \"Add collection\";\n                    rect.addEventListener(\"click\", function (evt) {\n                        popupTitle.textContent = t.textContent;\n                        entityName.value = \"New collection\";\n                        entityName.focus();\n                        fillEntitySelector();\n                        addMode = \"collection\";\n                        popup.classList.add(\"visible\");\n                        evt.stopPropagation();\n                    });\n                    break;\n                case 2:\n                    t.textContent = \"Center\";\n                    rect.addEventListener(\"click\", function (evt) {\n                        main.center();\n                        self.close();\n                        evt.stopPropagation();\n                    });\n                    break;\n                case 3:\n                    t.textContent = \"Reset\";\n                    rect.addEventListener(\"click\", function (evt) {\n                        main.clear();\n                        self.close();\n                        evt.stopPropagation();\n                    });\n                    break;\n            }\n        };\n        for (var i = 0; i < 4; i++) {\n            _loop_1(i);\n        }\n    }\n    CodeNodesMenu.prototype.open = function (x, y) {\n        this.g.classList.add(\"visible\");\n        this.g.setAttribute(\"transform\", \"translate(\" + x.toString() + \",\" + y.toString() + \")\");\n        this.g.classList.add(\"visible\");\n    };\n    CodeNodesMenu.prototype.close = function () {\n        this.popup.classList.remove(\"visible\");\n        this.g.classList.remove(\"visible\");\n    };\n    return CodeNodesMenu;\n}());\nexports.CodeNodesMenu = CodeNodesMenu;\n\n\n\n},{}],10:[function(require,module,exports){\n\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar nodevalue_1 = require(\"./nodevalue\");\nvar namespace = \"http://www.w3.org/2000/svg\";\nvar ROW_HEIGHT = 38;\nvar Node = (function () {\n    function Node(opts) {\n        var self = this;\n        this.options = opts;\n        this.values = [];\n        this.position = {\n            x: this.options.x,\n            y: this.options.y\n        };\n        this.nRows = this.options.type.schema.length + 2;\n        this.onmousedown = null;\n        this.outputConnectors = [];\n        this.options.type.schema.forEach(function (prop) {\n            self.setValueDefaults(prop);\n            var p = prop;\n            if (self.options.isCollection) {\n                p = self.collectionValueOf(p);\n            }\n            self.values.push(new nodevalue_1.NodeValue(p, self));\n        });\n    }\n    ;\n    Node.prototype.setValueDefaults = function (v) {\n        v.options = v.options || [];\n        v.multiple = v.multiple || false;\n        v.mode = v.mode || \"edit\";\n    };\n    Node.prototype.collectionValueOf = function (v) {\n        return {\n            id: v.id,\n            name: v.name + \" 0\",\n            type: v.type,\n            mode: v.mode,\n            options: v.options,\n            multiple: v.multiple\n        };\n    };\n    Node.prototype.render = function (parent) {\n        var self = this;\n        if (!this.g) {\n            this.g = document.createElementNS(namespace, \"g\");\n            this.g.setAttribute(\"transform\", \"translate(\" + this.position.x + \",\" + this.position.y + \")\");\n            this.g.setAttribute(\"class\", \"entity\");\n            this.outputOffset = {\n                x: 130,\n                y: (this.nRows * ROW_HEIGHT) - 10\n            };\n            this.rect = document.createElementNS(namespace, \"rect\");\n            this.rect.setAttribute(\"width\", this.outputOffset.x.toString());\n            this.rect.setAttribute(\"rx\", \"3\");\n            this.rect.setAttribute(\"height\", ((this.nRows * ROW_HEIGHT) + 2).toString());\n            this.rect.setAttribute(\"class\", \"draggable\");\n            this.rectDownHandler = function (evt) {\n                if (this.onmousedown instanceof Function) {\n                    this.onmousedown(evt, this);\n                }\n            }.bind(this);\n            this.rect.addEventListener(\"mousedown\", this.rectDownHandler);\n            var t = document.createElementNS(namespace, \"text\");\n            t.textContent = this.options.title;\n            t.classList.add(\"title\");\n            t.setAttribute(\"x\", \"5\");\n            t.setAttribute(\"y\", \"15\");\n            this.g.appendChild(this.rect);\n            this.g.appendChild(t);\n            var output = document.createElementNS(namespace, \"circle\");\n            this.output = output;\n            output.setAttribute(\"cx\", (this.outputOffset.x).toString());\n            output.setAttribute(\"cy\", (this.outputOffset.y).toString());\n            output.setAttribute(\"r\", \"6\");\n            output.setAttribute(\"class\", \"output\");\n            this.outputDownHandler = function (evt) {\n                if (this.outputMousedown instanceof Function) {\n                    this.outputMousedown(evt, this);\n                }\n            }.bind(this);\n            output.addEventListener(\"mousedown\", this.outputDownHandler);\n            var outputType = document.createElementNS(namespace, \"text\");\n            this.outputText = outputType;\n            if (this.options.type.outputMultiple) {\n                outputType.textContent = \"[\" + this.options.type.outputType + \"]\";\n            }\n            else {\n                outputType.textContent = this.options.type.outputType;\n            }\n            outputType.classList.add(\"output-type\");\n            outputType.setAttribute(\"x\", (this.outputOffset.x - 10).toString());\n            outputType.setAttribute(\"y\", (this.outputOffset.y).toString());\n            this.g.appendChild(output);\n            this.g.appendChild(outputType);\n            this.closeBtn = document.createElementNS(namespace, \"circle\");\n            this.closeBtn.classList.add(\"close-btn\");\n            this.closeBtn.setAttribute(\"cx\", (this.outputOffset.x - 10).toString());\n            this.closeBtn.setAttribute(\"r\", \"6\");\n            this.closeBtn.setAttribute(\"cy\", \"15\");\n            this.close = function () {\n                this.remove();\n            }.bind(this);\n            this.closeBtn.addEventListener(\"click\", this.close);\n            this.g.appendChild(this.closeBtn);\n            parent.appendChild(this.g);\n        }\n        var i = 1;\n        this.values.forEach(function (val) {\n            val.render(self.g, i++);\n        });\n    };\n    ;\n    Node.prototype.cloneLastValue = function () {\n        var self = this;\n        if (this.options.isCollection) {\n            var schema = this.options.type.schema, full = self.values.every(function (val) {\n                return val.inputConnector !== null;\n            });\n            if (full) {\n                var prop = JSON.parse(JSON.stringify(schema[schema.length - 1])), name_1 = prop.name + \" \" + schema.length;\n                schema.push(prop);\n                this.nRows++;\n                var newN = new nodevalue_1.NodeValue(prop, self);\n                self.values.push(newN);\n                newN.render(self.g, schema.length);\n                this.outputOffset.y = (this.nRows * ROW_HEIGHT) - 10;\n                this.output.setAttribute(\"cx\", (this.outputOffset.x).toString());\n                this.output.setAttribute(\"cy\", (this.outputOffset.y).toString());\n                this.outputText.setAttribute(\"y\", (this.outputOffset.y).toString());\n                this.rect.setAttribute(\"height\", ((this.nRows * ROW_HEIGHT) + 2).toString());\n            }\n        }\n    };\n    ;\n    Node.prototype.move = function (x, y) {\n        var self = this;\n        this.position = {\n            x: x,\n            y: y\n        };\n        this.outputConnectors.forEach(function (con) {\n            con.sp = {\n                x: x + self.outputOffset.x,\n                y: y + self.outputOffset.y\n            };\n            con.setPath();\n        });\n        this.values.forEach(function (val) {\n            val.updateConectorPosition();\n        });\n        this.g.setAttribute(\"transform\", \"translate(\" + this.position.x + \",\" + this.position.y + \")\");\n    };\n    ;\n    Node.prototype.serialize = function () {\n        var self = this, model = {\n            arguments: JSON.parse(JSON.stringify(this.options)),\n            values: this.values.map(function (v) {\n                return {\n                    valueID: v.options.id,\n                    value: v.__internalGetValue(true)\n                };\n            }),\n            outputConnectors: this.outputConnectors.map(function (c) {\n                return {\n                    nodeTo: c.end2.parentNode.options.id,\n                    valueTo: c.end2.options.id\n                };\n            })\n        };\n        model.arguments.x = this.position.x;\n        model.arguments.y = this.position.y;\n        return model;\n    };\n    ;\n    Node.prototype.findValue = function (id) {\n        var i, len = this.values.length;\n        for (i = 0; i < len; i += 1) {\n            if (this.values[i].options.id === id)\n                return this.values[i];\n        }\n        return null;\n    };\n    Node.prototype.setValues = function (vs) {\n        var self = this;\n        if (!this.options.isCollection) {\n            vs.forEach(function (v) {\n                var value = self.values.filter(function (val) {\n                    return val.options.id === v.valueID;\n                })[0];\n                if (value.__internalSetValue instanceof Function) {\n                    value.__internalSetValue(v.value);\n                }\n            });\n        }\n    };\n    ;\n    Node.prototype.build = function () {\n        if (!this.built) {\n            var schema = this.options.type.schema, valuesArr = [], self = this;\n            valuesArr = this.values.map(function (v) {\n                return v.getValue();\n            });\n            this.built = this.options.type.builder.apply(this, valuesArr);\n            return this.built;\n        }\n        else {\n            if (this.options.type.clonable) {\n                return this.options.type.clone(this.built);\n            }\n            else {\n                return this.built;\n            }\n        }\n    };\n    ;\n    Node.prototype.remove = function () {\n        var self = this;\n        this.values.forEach(function (val) {\n            val.remove();\n        });\n        this.values = null;\n        [].concat(this.outputConnectors).forEach(function (con) {\n            con.remove();\n        });\n        if (this.onremove instanceof Function) {\n            this.onremove();\n        }\n        this.closeBtn.removeEventListener(\"click\", this.close);\n        this.rect.removeEventListener(\"mousedown\", this.rectDownHandler);\n        this.output.addEventListener(\"mousedown\", this.outputDownHandler);\n    };\n    ;\n    return Node;\n}());\nexports.Node = Node;\n\n\n\n},{\"./nodevalue\":13}],11:[function(require,module,exports){\n\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar svgPanZoom = require(\"svg-pan-zoom\");\nvar node_1 = require(\"./node\");\nvar nodeconnector_1 = require(\"./nodeconnector\");\nvar namespace = \"http://www.w3.org/2000/svg\";\nvar NodeCanvas = (function () {\n    function NodeCanvas() {\n        this.svg = null;\n        this.g = null;\n        this.paths = null;\n        this.nodes = [];\n        this.pt = null;\n        this.draggingEntity = null;\n        this.currentConnector = null;\n        this.diff = null;\n    }\n    NodeCanvas.prototype.center = function () {\n        this.zoomingSvg.reset();\n    };\n    NodeCanvas.prototype.cursorPoint = function (evt) {\n        this.pt.x = evt.clientX;\n        this.pt.y = evt.clientY;\n        return this.pt.matrixTransform(this.svg.getScreenCTM().inverse());\n    };\n    ;\n    NodeCanvas.prototype.render = function () {\n        var self = this;\n        if (!this.svg) {\n            this.svg = document.createElementNS(namespace, \"svg\");\n            this.svg.setAttribute(\"class\", \"codenodes\");\n            this.pt = this.svg.createSVGPoint();\n            this.svg.setAttributeNS(\"http://www.w3.org/2000/xmlns/\", \"xmlns\", namespace);\n            this.svg.setAttributeNS(\"http://www.w3.org/2000/xmlns/\", \"xmlns:xlink\", \"http://www.w3.org/1999/xlink\");\n            this.svg.setAttribute(\"width\", \"100%\");\n            this.svg.setAttribute(\"height\", \"100%\");\n            this.g = document.createElementNS(namespace, \"g\");\n            this.paths = document.createElementNS(namespace, \"g\");\n            this.g.classList.add(\"svg-pan-zoom_viewport\");\n            this.g.setAttribute(\"transform\", \"matrix(1,1,1,1,0,0)\");\n            this.g.appendChild(this.paths);\n            this.svg.appendChild(this.g);\n            this.svg.addEventListener(\"dblclick\", function (evt) {\n                if (!(evt.target instanceof SVGSVGElement))\n                    return;\n                var p = self.cursorPoint(evt);\n                self.ctm = self.g.getCTM().inverse();\n                self.offset = self.svg.getBoundingClientRect();\n                self.ondblclick(self.convertCoords(p), p);\n            });\n            this.svg.addEventListener(\"click\", function (evt) {\n                self.onclick();\n            });\n        }\n        ;\n    };\n    ;\n    NodeCanvas.prototype.getTransform = function () {\n        var ctm = this.g.getCTM();\n        return {\n            pan: { x: ctm.e, y: ctm.f },\n            zoom: ctm.a\n        };\n    };\n    ;\n    NodeCanvas.prototype.setTransform = function (transform) {\n        this.zoomingSvg.zoom(transform.zoom);\n        this.zoomingSvg.pan(transform.pan);\n    };\n    NodeCanvas.prototype.convertCoords = function (o) {\n        var x = o.x, y = o.y;\n        return {\n            x: (this.ctm.a * x) + (this.ctm.c * y) + this.ctm.e,\n            y: (this.ctm.b * x) + (this.ctm.d * y) + this.ctm.f //- this.offset.top\n        };\n    };\n    NodeCanvas.prototype.addNode = function (opts) {\n        var n = new node_1.Node(opts), self = this;\n        function mouseMoveHandler(evt) {\n            if (self.draggingEntity) {\n                var p = self.cursorPoint(evt);\n                p.x = p.x - self.diff.x;\n                p.y = p.y - self.diff.y;\n                var p1 = self.convertCoords(p);\n                self.draggingEntity.move(p1.x, p1.y);\n            }\n        }\n        function mouseUpHandler(evt) {\n            self.svg.removeEventListener(\"mousemove\", mouseMoveHandler);\n            self.svg.removeEventListener(\"mouseup\", mouseUpHandler);\n            mouseMoveHandler(evt);\n            self.draggingEntity = null;\n        }\n        function mouseMoveConnectorHandler(evt) {\n            var p = self.convertCoords(self.cursorPoint(evt));\n            self.currentConnector.moveEndPoint(p);\n        }\n        function mouseUpConnectorHandler(evt) {\n            var p = self.convertCoords(self.cursorPoint(evt));\n            self.svg.removeEventListener(\"mousemove\", mouseMoveConnectorHandler);\n            self.svg.removeEventListener(\"mouseup\", mouseUpConnectorHandler);\n            var dots = [].slice.call(document.querySelectorAll(\".codenodes .dot\"));\n            var cc = self.currentConnector;\n            var candidates = dots.map(function (dot) {\n                var pos = dot.parentValue.getDotPosition();\n                var dist = Math.sqrt(Math.pow(p.x - pos.x, 2) + Math.pow(p.y - pos.y, 2));\n                return {\n                    dist: dist,\n                    dot: dot\n                };\n            }).filter(function (dot) {\n                return dot.dist <= 30;\n            }).sort(function (a, b) {\n                return a.dist - b.dist;\n            });\n            if (candidates.length > 0) {\n                var candidateDot = candidates[0].dot;\n                if (cc.end1 === candidateDot.parentValue.parentNode) {\n                    cc.remove();\n                    return;\n                }\n                if (candidateDot.parentValue.options.type !== \"any\" && (candidateDot.parentValue.options.type !== cc.end1.options.type.outputType ||\n                    (!candidateDot.parentValue.options.multiple && cc.end1.options.type.outputMultiple))) {\n                    cc.remove();\n                    return;\n                }\n                if (candidateDot.parentValue.inputConnector) {\n                    candidateDot.parentValue.inputConnector.remove();\n                }\n                candidateDot.parentValue.inputConnector = cc;\n                cc.end2 = candidateDot.parentValue;\n                if (cc.end2.parentNode.options.isCollection) {\n                    cc.end2.parentNode.cloneLastValue();\n                }\n                candidateDot.parentValue.updateConectorPosition();\n            }\n            else {\n                cc.remove();\n            }\n            self.currentConnector = null;\n        }\n        this.nodes.push(n);\n        n.outputMousedown = function (evt, entity) {\n            var p = self.cursorPoint(evt);\n            self.ctm = self.g.getCTM().inverse();\n            self.offset = self.svg.getBoundingClientRect();\n            var p1 = {\n                x: entity.position.x + parseInt(entity.outputOffset.x.toString()),\n                y: entity.position.y + parseInt(entity.outputOffset.y.toString())\n            };\n            self.currentConnector = new nodeconnector_1.NodeConnector(p1, entity);\n            entity.outputConnectors.push(self.currentConnector);\n            self.paths.appendChild(self.currentConnector.path);\n            self.svg.addEventListener(\"mousemove\", mouseMoveConnectorHandler);\n            self.svg.addEventListener(\"mouseup\", mouseUpConnectorHandler);\n            evt.stopPropagation();\n        };\n        n.onmousedown = function (evt, entity) {\n            var p = self.cursorPoint(evt);\n            self.ctm = self.g.getCTM();\n            self.offset = self.svg.getBoundingClientRect();\n            var entPos = self.convertCoords(entity.position);\n            self.diff = {\n                x: p.x - entPos.x,\n                y: p.y - entPos.y\n            };\n            self.ctm = self.ctm.inverse();\n            evt.stopPropagation();\n            self.draggingEntity = entity;\n            if (self.draggingEntity) {\n                self.svg.addEventListener(\"mousemove\", mouseMoveHandler);\n                self.svg.addEventListener(\"mouseup\", mouseUpHandler);\n            }\n        }.bind(this);\n        n.onremove = function () {\n            n.outputMousedown = null;\n            n.onmousedown = null;\n            var ind = self.nodes.indexOf(n);\n            if (ind >= 0) {\n                self.nodes.splice(ind, 1);\n            }\n            self.g.removeChild(n.g);\n        };\n        n.render(self.g);\n        return n;\n    };\n    ;\n    NodeCanvas.prototype.init = function () {\n        this.svg.setAttribute(\"viewBox\", \"0 0 \" + this.svg.clientWidth + \" \" + this.svg.clientHeight);\n        this.zoomingSvg = svgPanZoom(this.svg, {\n            zoomScaleSensitivity: 0.4,\n            dblClickZoomEnabled: false\n        });\n    };\n    ;\n    NodeCanvas.prototype.serialize = function () {\n        return this.nodes.map(function (n) {\n            return n.serialize();\n        });\n    };\n    NodeCanvas.prototype.findNode = function (id) {\n        var i, len = this.nodes.length;\n        for (i = 0; i < len; i += 1) {\n            if (this.nodes[i].options.id === id)\n                return this.nodes[i];\n        }\n        return null;\n    };\n    NodeCanvas.prototype.parse = function (nodes) {\n        var self = this;\n        nodes.forEach(function (nm) {\n            var n = self.addNode(nm.arguments);\n            n.setValues(nm.values);\n        });\n        nodes.forEach(function (nm) {\n            var n = self.findNode(nm.arguments.id);\n            nm.outputConnectors.forEach(function (cn) {\n                var end2 = self.findNode(cn.nodeTo);\n                var p1 = {\n                    x: n.position.x + parseInt(n.outputOffset.x.toString()),\n                    y: n.position.y + parseInt(n.outputOffset.y.toString())\n                };\n                var conn = new nodeconnector_1.NodeConnector(p1, n);\n                n.outputConnectors.push(conn);\n                self.paths.appendChild(conn.path);\n                if (end2.options.isCollection) {\n                    end2.cloneLastValue();\n                }\n                var val = end2.findValue(cn.valueTo);\n                val.inputConnector = conn;\n                conn.end2 = val;\n                val.updateConectorPosition();\n            });\n        });\n    };\n    NodeCanvas.prototype.clear = function () {\n        [].concat(this.nodes).forEach(function (node) {\n            node.remove();\n        });\n        this.paths.innerHTML = \"\";\n    };\n    ;\n    NodeCanvas.prototype.getTerminalNodes = function () {\n        return this.nodes.filter(function (n) {\n            return n.outputConnectors.length === 0;\n        });\n    };\n    ;\n    NodeCanvas.prototype.getOfType = function (type) {\n        return this.nodes.filter(function (n) {\n            return n.options.type.id === type;\n        });\n    };\n    return NodeCanvas;\n}());\nexports.NodeCanvas = NodeCanvas;\n\n\n\n},{\"./node\":10,\"./nodeconnector\":12,\"svg-pan-zoom\":1}],12:[function(require,module,exports){\n\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar namespace = \"http://www.w3.org/2000/svg\";\nvar NodeConnector = (function () {\n    function NodeConnector(sp, node) {\n        this.sp = sp;\n        this.ep = sp;\n        this.end1 = node;\n        this.end2 = null;\n        this.path = document.createElementNS(namespace, \"path\");\n        this.setPath();\n    }\n    ;\n    NodeConnector.prototype.setPath = function () {\n        var c1 = {\n            x: ((this.ep.x - this.sp.x) / 3) + this.sp.x,\n            y: this.sp.y\n        }, c2 = {\n            x: -((this.ep.x - this.sp.x) / 3) + this.ep.x,\n            y: this.ep.y\n        };\n        this.path.setAttribute(\"d\", \"M\" + this.sp.x + \",\" + this.sp.y + \" C\" + c1.x + \",\" + c1.y + \" \" + c2.x + \",\" + c2.y + \" \" + this.ep.x + \",\" + this.ep.y);\n    };\n    ;\n    NodeConnector.prototype.remove = function () {\n        if (this.end1) {\n            var ind = this.end1.outputConnectors.indexOf(this);\n            if (ind >= 0) {\n                this.end1.outputConnectors.splice(ind, 1);\n            }\n            this.end1 = null;\n        }\n        if (this.end2) {\n            this.end2.inputConnector = null;\n        }\n        if (this.path) {\n            this.path.remove();\n            this.path = null;\n        }\n    };\n    ;\n    NodeConnector.prototype.moveEndPoint = function (point) {\n        this.ep = point;\n        this.setPath();\n    };\n    return NodeConnector;\n}());\nexports.NodeConnector = NodeConnector;\n\n\n\n},{}],13:[function(require,module,exports){\n\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar namespace = \"http://www.w3.org/2000/svg\";\nvar ROW_HEIGHT = 38;\nvar NodeValue = (function () {\n    function NodeValue(opts, node) {\n        this.popup = null;\n        this.options = opts;\n        this.inputConnector = null;\n        this.__internalGetValue = null;\n        this.svgEntity = null;\n        this.gOffset = null;\n        this.parentNode = node;\n    }\n    NodeValue.prototype.render = function (parent, position) {\n        var self = this;\n        if (!this.svgEntity) {\n            var ent = document.createElementNS(namespace, \"g\");\n            this.gOffset = {\n                x: 1,\n                y: ((position * ROW_HEIGHT) + 1)\n            };\n            ent.setAttribute(\"transform\", \"translate(\" + this.gOffset.x + \", \" + this.gOffset.y + \")\");\n            ent.setAttribute(\"class\", \"row\");\n            if (this.options.mode === \"edit\") {\n                var rect = document.createElementNS(namespace, \"rect\"), fo = document.createElementNS(namespace, \"foreignObject\"), name_1 = document.createElementNS(namespace, \"text\"), div = document.createElementNS(\"http://www.w3.org/1999/xhtml\", \"div\");\n                name_1.textContent = this.options.name;\n                name_1.setAttribute(\"x\", \"10\");\n                name_1.setAttribute(\"y\", \"6\");\n                rect.setAttribute(\"x\", \"1\");\n                div.setAttribute(\"xmlns\", \"http://www.w3.org/1999/xhtml\");\n                var input_1 = document.createElement(\"input\");\n                switch (this.options.type) {\n                    case \"range\":\n                        input_1.min = this.options[0];\n                        input_1.max = this.options[1];\n                    case \"text\":\n                    case \"number\":\n                    case \"email\":\n                    case \"date\":\n                    case \"color\":\n                        this.__internalGetValue = function () {\n                            return input_1.value;\n                        };\n                        this.__internalSetValue = function (v) {\n                            input_1.value = v;\n                        };\n                        input_1.type = this.options.type;\n                        div.appendChild(input_1);\n                        break;\n                    case \"boolean\":\n                        this.__internalGetValue = function () {\n                            return input_1.checked;\n                        };\n                        this.__internalSetValue = function (v) {\n                            input_1.checked = v;\n                        };\n                        input_1.type = \"checkbox\";\n                        div.appendChild(input_1);\n                        break;\n                    case \"select\":\n                        var div_select_1 = document.createElement(\"select\");\n                        this.options.options.forEach(function (op) {\n                            var div_option = document.createElement(\"option\");\n                            div_option.textContent = op.show.toString();\n                            div_option.setAttribute(\"value\", op.save);\n                            div_select_1.appendChild(div_option);\n                        });\n                        this.__internalGetValue = function () {\n                            return div_select_1.value;\n                        };\n                        this.__internalSetValue = function (v) {\n                            input_1.value = v;\n                        };\n                        div.appendChild(div_select_1);\n                        break;\n                    case \"popup\":\n                        var btn = document.createElement(\"button\");\n                        btn.classList.add(\"popup-btn\");\n                        btn.textContent = \"*Edit\";\n                        var popup_1 = document.createElement(\"div\");\n                        popup_1.classList.add(\"codenodes-popup\");\n                        this.popup = popup_1;\n                        var popupLayer = document.createElement(\"div\");\n                        popupLayer.classList.add(\"layer\");\n                        var popupContent = document.createElement(\"div\");\n                        popupContent.classList.add(\"content\");\n                        var popupWraper = document.createElement(\"div\");\n                        popupWraper.classList.add(\"wraper\");\n                        var popupTextArea_1 = document.createElement(\"div\");\n                        popupTextArea_1.classList.add(\"text\");\n                        popupTextArea_1.setAttribute(\"contenteditable\", \"true\");\n                        var popupOK = document.createElement(\"div\");\n                        popupOK.classList.add(\"ok\");\n                        btn.addEventListener(\"click\", function () {\n                            popup_1.classList.add(\"visible\");\n                        });\n                        var fnClose = function () {\n                            popup_1.classList.remove(\"visible\");\n                        };\n                        popup_1.appendChild(popupLayer);\n                        popup_1.appendChild(popupWraper);\n                        popupWraper.appendChild(popupContent);\n                        popupContent.appendChild(popupTextArea_1);\n                        popupContent.appendChild(popupOK);\n                        popupOK.addEventListener(\"click\", fnClose);\n                        this.__internalGetValue = function () {\n                            return popupTextArea_1.textContent;\n                        };\n                        this.__internalSetValue = function (v) {\n                            popupTextArea_1.textContent = v;\n                        };\n                        document.body.appendChild(popup_1);\n                        div.appendChild(btn);\n                        break;\n                }\n                fo.appendChild(div);\n                fo.setAttribute(\"transform\", \"translate(0,13)\");\n                //ent.appendChild(rect);\n                ent.appendChild(name_1);\n                ent.appendChild(fo);\n            }\n            if (this.options.mode === \"in\") {\n                var name_2 = document.createElementNS(namespace, \"text\"), type = document.createElementNS(namespace, \"text\"), dot = document.createElementNS(namespace, \"circle\");\n                dot.setAttribute(\"cx\", \"-1\");\n                dot.setAttribute(\"cy\", \"16\");\n                dot.setAttribute(\"r\", \"4\");\n                dot.setAttribute(\"class\", \"dot\");\n                dot.addEventListener(\"click\", function (evt) {\n                    if (self.inputConnector) {\n                        self.inputConnector.remove();\n                    }\n                    evt.stopPropagation();\n                });\n                dot[\"parentValue\"] = this;\n                name_2.textContent = this.options.name;\n                name_2.setAttribute(\"x\", \"10\");\n                name_2.setAttribute(\"y\", \"8\");\n                if (this.options.multiple) {\n                    type.textContent = \"[\" + this.options.type + \"]\";\n                }\n                else {\n                    type.textContent = this.options.type;\n                }\n                type.classList.add(\"value-type\");\n                type.setAttribute(\"x\", \"10\");\n                type.setAttribute(\"y\", \"25\");\n                this.__internalGetValue = function (serializing) {\n                    if (!serializing && self.inputConnector) {\n                        var built = self.inputConnector.end1.build();\n                        if (self.options.multiple && !self.inputConnector.end1.options.type.outputMultiple) {\n                            return [built];\n                        }\n                        else {\n                            return built;\n                        }\n                    }\n                    return undefined;\n                };\n                ent.appendChild(name_2);\n                ent.appendChild(type);\n                ent.appendChild(dot);\n            }\n            this.svgEntity = ent;\n            parent.appendChild(ent);\n        }\n    };\n    ;\n    NodeValue.prototype.getSerializedValue = function () {\n        if (this.options.mode === \"edit\" && this.__internalGetValue instanceof Function) {\n            return this.__internalGetValue();\n        }\n        return null;\n    };\n    NodeValue.prototype.getDotPosition = function () {\n        return {\n            x: this.parentNode.position.x + this.gOffset.x - 1,\n            y: this.parentNode.position.y + this.gOffset.y + 16\n        };\n    };\n    ;\n    NodeValue.prototype.remove = function () {\n        if (this.inputConnector) {\n            this.inputConnector.remove();\n            this.inputConnector = null;\n        }\n        this.svgEntity.remove();\n        this.svgEntity = null;\n        if (this.popup) {\n            document.body.removeChild(this.popup);\n        }\n        this.parentNode = null;\n    };\n    NodeValue.prototype.updateConectorPosition = function () {\n        if (this.inputConnector) {\n            this.inputConnector.ep = this.getDotPosition();\n            this.inputConnector.setPath();\n        }\n    };\n    NodeValue.prototype.getValue = function () {\n        if (this.__internalGetValue instanceof Function) {\n            return this.__internalGetValue();\n        }\n        return null;\n    };\n    return NodeValue;\n}());\nexports.NodeValue = NodeValue;\n\n\n\n},{}],14:[function(require,module,exports){\n\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Point = (function () {\n    function Point(x, y) {\n        this.x = x;\n        this.y = y;\n    }\n    return Point;\n}());\nexports.Point = Point;\n\n\n\n},{}]},{},[8])(8)\n});"]}