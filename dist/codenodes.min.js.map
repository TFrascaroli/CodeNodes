{"version":3,"sources":["codenodes.min.js"],"names":["f","exports","module","define","amd","window","global","self","this","codenodes","e","t","n","r","s","o","u","a","require","i","Error","code","l","call","length","1","SvgPanZoom","./svg-pan-zoom.js","2","SvgUtils","enable","instance","defs","svg","querySelector","document","createElementNS","svgNS","appendChild","style","setAttribute","textContent","zoomGroup","width","height","_createZoomIn","_createZoomReset","_createZoomOut","controlIcons","zoomIn","addEventListener","getPublicInstance","zoomInBackground","zoomInShape","resetPanZoomControl","reset","resetPanZoomControlBackground","resetPanZoomControlShape1","resetPanZoomControlShape2","zoomOut","zoomOutBackground","zoomOutShape","disable","parentNode","removeChild","./svg-utilities","3","Utils","ShadowViewport","viewport","options","init","prototype","originalState","zoom","x","y","activeState","updateCTMCached","proxy","updateCTM","requestAnimationFrame","createRequestAnimationFrame","refreshRate","viewBox","cacheViewBox","newCTM","processCTM","setCTM","svgViewBox","getAttribute","viewBoxValues","split","filter","v","map","parseFloat","Math","min","updateCTMOnNextFrame","removeAttribute","simpleViewBoxCache","bBox","getBBox","getViewBox","extend","getCTM","fit","contain","newScale","max","d","center","offsetX","offsetY","getOriginalState","getState","getZoom","getRelativeZoom","computeRelativeZoom","scale","getPan","safeCTM","createSVGMatrix","b","c","willZoom","isZoomDifferent","willPan","isPanDifferent","beforeZoom","updateCache","onZoom","preventPan","beforePan","preventPanX","preventPanY","isObject","isNumber","onPan","pendingUpdate","ctm","onUpdatedCTM","./utilities","4","Wheel","ControlIcons","optionsDefaults","viewportSelector","panEnabled","controlIconsEnabled","zoomEnabled","dblClickZoomEnabled","mouseWheelZoomEnabled","preventMouseEventsDefault","zoomScaleSensitivity","minZoom","maxZoom","customEventsHandler","eventsListenerElement","restrictEventsListenerEvent","that","setupSvgAttributes","state","boundingClientRectNormalized","getBoundingClientRectNormalized","getOrCreateViewport","oldScale","oldPoint","newPoint","point","publicInstance","setBeforeZoom","setOnZoom","setBeforePan","setOnPan","setOnUpdatedCTM","lastMouseWheelEventTime","Date","now","setupHandlers","prevEvt","eventListeners","mousedown","evt","target","result","handleMouseDown","touchstart","mouseup","handleMouseUp","touchend","mousemove","handleMouseMove","touchmove","mouseleave","touchleave","touchcancel","svgElement","haltEventListeners","hasOwnProperty","event","enableMouseWheelZoom","wheelListener","handleMouseWheel","on","disableMouseWheelZoom","off","preventDefault","returnValue","delta","deltaY","timeDelta","divider","deltaMode","wheelDelta","abs","log","inversedScreenCTM","getScreenCTM","inverse","relativeMousePoint","getEventPoint","matrixTransform","pow","zoomAtPoint","zoomScale","zoomAbsolute","oldCTM","relativePoint","modifier","translate","multiply","absolute","getSvgCenterPoint","publicZoom","computeFromRelativeZoom","publicZoomAtPoint","getType","createSVGPoint","resetZoom","resetPan","pan","handleDblClick","indexOf","zoomFactor","shiftKey","mouseAndTouchNormalize","isDblClick","firstEventCTM","stateOrigin","viewportCTM","updateBBox","panBy","resize","disableControlIcons","enableControlIcons","destroy","removeEventListener","instancesStore","pi","enablePan","disablePan","isPanEnabled","fn","enableZoom","disableZoom","isZoomEnabled","isControlIconsEnabled","enableDblClickZoom","disableDblClickZoom","isDblClickZoomEnabled","isMouseWheelZoomEnabled","setZoomScaleSensitivity","setMinZoom","setMaxZoom","zoomBy","zoomAtPointBy","getSizes","realZoom","elementOrSelector","getSvg","push","./control-icons","./shadow-viewport","./uniwheel","5","_browser","documentMode","xmlNS","xmlnsNS","xlinkNS","evNS","clientWidth","clientHeight","getBoundingClientRect","selector","isElement","childNodes","Array","slice","children","el","nodeName","viewportId","toISOString","replace","svgChildren","classNames","join","setAttributeNS","toLowerCase","internetExplorerRedisplayInterval","refreshDefsGlobal","throttle","allDefs","querySelectorAll","allDefsCount","thisDefs","insertBefore","element","matrix","transform","setTimeout","clientX","clientY","6","createCallback","callback","capture","originalEvent","srcElement","type","deltaX","delatZ","support","wheelDeltaX","detail","fns","getCallback","removeCallback","splice","_addWheelListener","elem","eventName","useCapture","cb","_addEventListener","prefix","_removeWheelListener","_removeEventListener","createElement","undefined","onmousewheel","7","requestTimeout","timeout","source","prop","HTMLElement","SVGElement","SVGSVGElement","nodeType","Object","toString","isNaN","isFinite","String","tagName","contentDocument","documentElement","getSVGDocument","context","apply","arguments","changedTouches","pageX","rect","left","pageY","top","timeStampDiff","timeStamp","touchesDistance","sqrt","getTime","func","wait","args","previous","later","leading","remaining","clearTimeout","trailing","floor","8","defineProperty","value","nodecanvas_1","menu_1","CodeNodes","types","nodesCount","canvas","NodeCanvas","sort","name","localeCompare","reverse","menu","CodeNodesMenu","ondblclick","p","rawP","menuPoint","open","onclick","close","getSVG","render","g","clear","findType","tID","len","id","collectionTypeOf","description","builder","collectionBuilder","clone","collectionClone","clonable","outputType","outputMultiple","schema","mode","multiple","addNode","ot","title","isCollection","console","flatten","arr","reduce","flat","toFlatten","concat","isArray","addCollection","ofType","serialize","nodes","getTransform","parse","model","setTransform","getOfType","./menu","./nodecanvas","9","namespace","main","fillEntitySelector","entitySelector","innerHTML","forEach","opt","classList","add","desc","remove","selectedValue","addMode","popup","popupLayer","popupContent","popupWraper","popupTitle","entitySelectorWrap","entityName","entityNameWrap","popupOK","body","focus","stopPropagation","10","nodevalue_1","Node","opts","builtWith","values","position","nRows","onmousedown","outputConnectors","setValueDefaults","collectionValueOf","NodeValue","dropPreBuilt","ondrop","Function","built","parent","outputOffset","rectDownHandler","bind","output","outputDownHandler","outputMousedown","outputText","closeBtn","val","cloneLastValue","every","inputConnector","JSON","stringify","newN","move","con","sp","setPath","updateConectorPosition","valueID","__internalGetValue","nodeTo","end2","valueTo","findValue","setValues","vs","__internalSetValue","checkBuiltWithEquals","valuesArr","build","getValue","onremove","./nodevalue","11","svgPanZoom","node_1","nodeconnector_1","paths","pt","draggingEntity","currentConnector","diff","zoomingSvg","cursorPoint","offset","convertCoords","mouseMoveHandler","p1","mouseUpHandler","mouseMoveConnectorHandler","moveEndPoint","mouseUpConnectorHandler","dots","cc","candidates","dot","pos","parentValue","getDotPosition","dist","candidateDot","end1","entity","parseInt","NodeConnector","path","entPos","ind","findNode","_this","nm","cn","conn","node","getTerminalNodes","./node","./nodeconnector","svg-pan-zoom","12","ep","c1","c2","13","svgEntity","gOffset","ent","fo","name_1","div","input_1","checked","div_select_1","op","div_option","show","save","btn","popup_1","popupTextArea_1","name_2","serializing","getSerializedValue"],"mappings":"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","file":"codenodes.min.js","sourcesContent":["(function(f){if(typeof exports===\"object\"&&typeof module!==\"undefined\"){module.exports=f()}else if(typeof define===\"function\"&&define.amd){define([],f)}else{var g;if(typeof window!==\"undefined\"){g=window}else if(typeof global!==\"undefined\"){g=global}else if(typeof self!==\"undefined\"){g=self}else{g=this}g.codenodes = f()}})(function(){var define,module,exports;return (function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){\nvar SvgPanZoom = require('./svg-pan-zoom.js');\r\n\r\nmodule.exports = SvgPanZoom;\r\n\n},{\"./svg-pan-zoom.js\":4}],2:[function(require,module,exports){\nvar SvgUtils = require('./svg-utilities');\r\n\r\nmodule.exports = {\r\n  enable: function(instance) {\r\n    // Select (and create if necessary) defs\r\n    var defs = instance.svg.querySelector('defs')\r\n    if (!defs) {\r\n      defs = document.createElementNS(SvgUtils.svgNS, 'defs')\r\n      instance.svg.appendChild(defs)\r\n    }\r\n\r\n    // Check for style element, and create it if it doesn't exist\r\n    var styleEl = defs.querySelector('style#svg-pan-zoom-controls-styles');\r\n    if (!styleEl) {\r\n      var style = document.createElementNS(SvgUtils.svgNS, 'style')\r\n      style.setAttribute('id', 'svg-pan-zoom-controls-styles')\r\n      style.setAttribute('type', 'text/css')\r\n      style.textContent = '.svg-pan-zoom-control { cursor: pointer; fill: black; fill-opacity: 0.333; } .svg-pan-zoom-control:hover { fill-opacity: 0.8; } .svg-pan-zoom-control-background { fill: white; fill-opacity: 0.5; } .svg-pan-zoom-control-background { fill-opacity: 0.8; }'\r\n      defs.appendChild(style)\r\n    }\r\n\r\n    // Zoom Group\r\n    var zoomGroup = document.createElementNS(SvgUtils.svgNS, 'g');\r\n    zoomGroup.setAttribute('id', 'svg-pan-zoom-controls');\r\n    zoomGroup.setAttribute('transform', 'translate(' + ( instance.width - 70 ) + ' ' + ( instance.height - 76 ) + ') scale(0.75)');\r\n    zoomGroup.setAttribute('class', 'svg-pan-zoom-control');\r\n\r\n    // Control elements\r\n    zoomGroup.appendChild(this._createZoomIn(instance))\r\n    zoomGroup.appendChild(this._createZoomReset(instance))\r\n    zoomGroup.appendChild(this._createZoomOut(instance))\r\n\r\n    // Finally append created element\r\n    instance.svg.appendChild(zoomGroup)\r\n\r\n    // Cache control instance\r\n    instance.controlIcons = zoomGroup\r\n  }\r\n\r\n, _createZoomIn: function(instance) {\r\n    var zoomIn = document.createElementNS(SvgUtils.svgNS, 'g');\r\n    zoomIn.setAttribute('id', 'svg-pan-zoom-zoom-in');\r\n    zoomIn.setAttribute('transform', 'translate(30.5 5) scale(0.015)');\r\n    zoomIn.setAttribute('class', 'svg-pan-zoom-control');\r\n    zoomIn.addEventListener('click', function() {instance.getPublicInstance().zoomIn()}, false)\r\n    zoomIn.addEventListener('touchstart', function() {instance.getPublicInstance().zoomIn()}, false)\r\n\r\n    var zoomInBackground = document.createElementNS(SvgUtils.svgNS, 'rect'); // TODO change these background space fillers to rounded rectangles so they look prettier\r\n    zoomInBackground.setAttribute('x', '0');\r\n    zoomInBackground.setAttribute('y', '0');\r\n    zoomInBackground.setAttribute('width', '1500'); // larger than expected because the whole group is transformed to scale down\r\n    zoomInBackground.setAttribute('height', '1400');\r\n    zoomInBackground.setAttribute('class', 'svg-pan-zoom-control-background');\r\n    zoomIn.appendChild(zoomInBackground);\r\n\r\n    var zoomInShape = document.createElementNS(SvgUtils.svgNS, 'path');\r\n    zoomInShape.setAttribute('d', 'M1280 576v128q0 26 -19 45t-45 19h-320v320q0 26 -19 45t-45 19h-128q-26 0 -45 -19t-19 -45v-320h-320q-26 0 -45 -19t-19 -45v-128q0 -26 19 -45t45 -19h320v-320q0 -26 19 -45t45 -19h128q26 0 45 19t19 45v320h320q26 0 45 19t19 45zM1536 1120v-960 q0 -119 -84.5 -203.5t-203.5 -84.5h-960q-119 0 -203.5 84.5t-84.5 203.5v960q0 119 84.5 203.5t203.5 84.5h960q119 0 203.5 -84.5t84.5 -203.5z');\r\n    zoomInShape.setAttribute('class', 'svg-pan-zoom-control-element');\r\n    zoomIn.appendChild(zoomInShape);\r\n\r\n    return zoomIn\r\n  }\r\n\r\n, _createZoomReset: function(instance){\r\n    // reset\r\n    var resetPanZoomControl = document.createElementNS(SvgUtils.svgNS, 'g');\r\n    resetPanZoomControl.setAttribute('id', 'svg-pan-zoom-reset-pan-zoom');\r\n    resetPanZoomControl.setAttribute('transform', 'translate(5 35) scale(0.4)');\r\n    resetPanZoomControl.setAttribute('class', 'svg-pan-zoom-control');\r\n    resetPanZoomControl.addEventListener('click', function() {instance.getPublicInstance().reset()}, false);\r\n    resetPanZoomControl.addEventListener('touchstart', function() {instance.getPublicInstance().reset()}, false);\r\n\r\n    var resetPanZoomControlBackground = document.createElementNS(SvgUtils.svgNS, 'rect'); // TODO change these background space fillers to rounded rectangles so they look prettier\r\n    resetPanZoomControlBackground.setAttribute('x', '2');\r\n    resetPanZoomControlBackground.setAttribute('y', '2');\r\n    resetPanZoomControlBackground.setAttribute('width', '182'); // larger than expected because the whole group is transformed to scale down\r\n    resetPanZoomControlBackground.setAttribute('height', '58');\r\n    resetPanZoomControlBackground.setAttribute('class', 'svg-pan-zoom-control-background');\r\n    resetPanZoomControl.appendChild(resetPanZoomControlBackground);\r\n\r\n    var resetPanZoomControlShape1 = document.createElementNS(SvgUtils.svgNS, 'path');\r\n    resetPanZoomControlShape1.setAttribute('d', 'M33.051,20.632c-0.742-0.406-1.854-0.609-3.338-0.609h-7.969v9.281h7.769c1.543,0,2.701-0.188,3.473-0.562c1.365-0.656,2.048-1.953,2.048-3.891C35.032,22.757,34.372,21.351,33.051,20.632z');\r\n    resetPanZoomControlShape1.setAttribute('class', 'svg-pan-zoom-control-element');\r\n    resetPanZoomControl.appendChild(resetPanZoomControlShape1);\r\n\r\n    var resetPanZoomControlShape2 = document.createElementNS(SvgUtils.svgNS, 'path');\r\n    resetPanZoomControlShape2.setAttribute('d', 'M170.231,0.5H15.847C7.102,0.5,0.5,5.708,0.5,11.84v38.861C0.5,56.833,7.102,61.5,15.847,61.5h154.384c8.745,0,15.269-4.667,15.269-10.798V11.84C185.5,5.708,178.976,0.5,170.231,0.5z M42.837,48.569h-7.969c-0.219-0.766-0.375-1.383-0.469-1.852c-0.188-0.969-0.289-1.961-0.305-2.977l-0.047-3.211c-0.03-2.203-0.41-3.672-1.142-4.406c-0.732-0.734-2.103-1.102-4.113-1.102h-7.05v13.547h-7.055V14.022h16.524c2.361,0.047,4.178,0.344,5.45,0.891c1.272,0.547,2.351,1.352,3.234,2.414c0.731,0.875,1.31,1.844,1.737,2.906s0.64,2.273,0.64,3.633c0,1.641-0.414,3.254-1.242,4.84s-2.195,2.707-4.102,3.363c1.594,0.641,2.723,1.551,3.387,2.73s0.996,2.98,0.996,5.402v2.32c0,1.578,0.063,2.648,0.19,3.211c0.19,0.891,0.635,1.547,1.333,1.969V48.569z M75.579,48.569h-26.18V14.022h25.336v6.117H56.454v7.336h16.781v6H56.454v8.883h19.125V48.569z M104.497,46.331c-2.44,2.086-5.887,3.129-10.34,3.129c-4.548,0-8.125-1.027-10.731-3.082s-3.909-4.879-3.909-8.473h6.891c0.224,1.578,0.662,2.758,1.316,3.539c1.196,1.422,3.246,2.133,6.15,2.133c1.739,0,3.151-0.188,4.236-0.562c2.058-0.719,3.087-2.055,3.087-4.008c0-1.141-0.504-2.023-1.512-2.648c-1.008-0.609-2.607-1.148-4.796-1.617l-3.74-0.82c-3.676-0.812-6.201-1.695-7.576-2.648c-2.328-1.594-3.492-4.086-3.492-7.477c0-3.094,1.139-5.664,3.417-7.711s5.623-3.07,10.036-3.07c3.685,0,6.829,0.965,9.431,2.895c2.602,1.93,3.966,4.73,4.093,8.402h-6.938c-0.128-2.078-1.057-3.555-2.787-4.43c-1.154-0.578-2.587-0.867-4.301-0.867c-1.907,0-3.428,0.375-4.565,1.125c-1.138,0.75-1.706,1.797-1.706,3.141c0,1.234,0.561,2.156,1.682,2.766c0.721,0.406,2.25,0.883,4.589,1.43l6.063,1.43c2.657,0.625,4.648,1.461,5.975,2.508c2.059,1.625,3.089,3.977,3.089,7.055C108.157,41.624,106.937,44.245,104.497,46.331z M139.61,48.569h-26.18V14.022h25.336v6.117h-18.281v7.336h16.781v6h-16.781v8.883h19.125V48.569z M170.337,20.14h-10.336v28.43h-7.266V20.14h-10.383v-6.117h27.984V20.14z');\r\n    resetPanZoomControlShape2.setAttribute('class', 'svg-pan-zoom-control-element');\r\n    resetPanZoomControl.appendChild(resetPanZoomControlShape2);\r\n\r\n    return resetPanZoomControl\r\n  }\r\n\r\n, _createZoomOut: function(instance){\r\n    // zoom out\r\n    var zoomOut = document.createElementNS(SvgUtils.svgNS, 'g');\r\n    zoomOut.setAttribute('id', 'svg-pan-zoom-zoom-out');\r\n    zoomOut.setAttribute('transform', 'translate(30.5 70) scale(0.015)');\r\n    zoomOut.setAttribute('class', 'svg-pan-zoom-control');\r\n    zoomOut.addEventListener('click', function() {instance.getPublicInstance().zoomOut()}, false);\r\n    zoomOut.addEventListener('touchstart', function() {instance.getPublicInstance().zoomOut()}, false);\r\n\r\n    var zoomOutBackground = document.createElementNS(SvgUtils.svgNS, 'rect'); // TODO change these background space fillers to rounded rectangles so they look prettier\r\n    zoomOutBackground.setAttribute('x', '0');\r\n    zoomOutBackground.setAttribute('y', '0');\r\n    zoomOutBackground.setAttribute('width', '1500'); // larger than expected because the whole group is transformed to scale down\r\n    zoomOutBackground.setAttribute('height', '1400');\r\n    zoomOutBackground.setAttribute('class', 'svg-pan-zoom-control-background');\r\n    zoomOut.appendChild(zoomOutBackground);\r\n\r\n    var zoomOutShape = document.createElementNS(SvgUtils.svgNS, 'path');\r\n    zoomOutShape.setAttribute('d', 'M1280 576v128q0 26 -19 45t-45 19h-896q-26 0 -45 -19t-19 -45v-128q0 -26 19 -45t45 -19h896q26 0 45 19t19 45zM1536 1120v-960q0 -119 -84.5 -203.5t-203.5 -84.5h-960q-119 0 -203.5 84.5t-84.5 203.5v960q0 119 84.5 203.5t203.5 84.5h960q119 0 203.5 -84.5 t84.5 -203.5z');\r\n    zoomOutShape.setAttribute('class', 'svg-pan-zoom-control-element');\r\n    zoomOut.appendChild(zoomOutShape);\r\n\r\n    return zoomOut\r\n  }\r\n\r\n, disable: function(instance) {\r\n    if (instance.controlIcons) {\r\n      instance.controlIcons.parentNode.removeChild(instance.controlIcons)\r\n      instance.controlIcons = null\r\n    }\r\n  }\r\n}\r\n\n},{\"./svg-utilities\":5}],3:[function(require,module,exports){\nvar SvgUtils = require('./svg-utilities')\r\n  , Utils = require('./utilities')\r\n  ;\r\n\r\nvar ShadowViewport = function(viewport, options){\r\n  this.init(viewport, options)\r\n}\r\n\r\n/**\r\n * Initialization\r\n *\r\n * @param  {SVGElement} viewport\r\n * @param  {Object} options\r\n */\r\nShadowViewport.prototype.init = function(viewport, options) {\r\n  // DOM Elements\r\n  this.viewport = viewport\r\n  this.options = options\r\n\r\n  // State cache\r\n  this.originalState = {zoom: 1, x: 0, y: 0}\r\n  this.activeState = {zoom: 1, x: 0, y: 0}\r\n\r\n  this.updateCTMCached = Utils.proxy(this.updateCTM, this)\r\n\r\n  // Create a custom requestAnimationFrame taking in account refreshRate\r\n  this.requestAnimationFrame = Utils.createRequestAnimationFrame(this.options.refreshRate)\r\n\r\n  // ViewBox\r\n  this.viewBox = {x: 0, y: 0, width: 0, height: 0}\r\n  this.cacheViewBox()\r\n\r\n  // Process CTM\r\n  var newCTM = this.processCTM()\r\n\r\n  // Update viewport CTM and cache zoom and pan\r\n  this.setCTM(newCTM)\r\n\r\n  // Update CTM in this frame\r\n  this.updateCTM()\r\n}\r\n\r\n/**\r\n * Cache initial viewBox value\r\n * If no viewBox is defined, then use viewport size/position instead for viewBox values\r\n */\r\nShadowViewport.prototype.cacheViewBox = function() {\r\n  var svgViewBox = this.options.svg.getAttribute('viewBox')\r\n\r\n  if (svgViewBox) {\r\n    var viewBoxValues = svgViewBox.split(/[\\s\\,]/).filter(function(v){return v}).map(parseFloat)\r\n\r\n    // Cache viewbox x and y offset\r\n    this.viewBox.x = viewBoxValues[0]\r\n    this.viewBox.y = viewBoxValues[1]\r\n    this.viewBox.width = viewBoxValues[2]\r\n    this.viewBox.height = viewBoxValues[3]\r\n\r\n    var zoom = Math.min(this.options.width / this.viewBox.width, this.options.height / this.viewBox.height)\r\n\r\n    // Update active state\r\n    this.activeState.zoom = zoom\r\n    this.activeState.x = (this.options.width - this.viewBox.width * zoom) / 2\r\n    this.activeState.y = (this.options.height - this.viewBox.height * zoom) / 2\r\n\r\n    // Force updating CTM\r\n    this.updateCTMOnNextFrame()\r\n\r\n    this.options.svg.removeAttribute('viewBox')\r\n  } else {\r\n    this.simpleViewBoxCache()\r\n  }\r\n}\r\n\r\n/**\r\n * Recalculate viewport sizes and update viewBox cache\r\n */\r\nShadowViewport.prototype.simpleViewBoxCache = function() {\r\n  var bBox = this.viewport.getBBox()\r\n\r\n  this.viewBox.x = bBox.x\r\n  this.viewBox.y = bBox.y\r\n  this.viewBox.width = bBox.width\r\n  this.viewBox.height = bBox.height\r\n}\r\n\r\n/**\r\n * Returns a viewbox object. Safe to alter\r\n *\r\n * @return {Object} viewbox object\r\n */\r\nShadowViewport.prototype.getViewBox = function() {\r\n  return Utils.extend({}, this.viewBox)\r\n}\r\n\r\n/**\r\n * Get initial zoom and pan values. Save them into originalState\r\n * Parses viewBox attribute to alter initial sizes\r\n *\r\n * @return {CTM} CTM object based on options\r\n */\r\nShadowViewport.prototype.processCTM = function() {\r\n  var newCTM = this.getCTM()\r\n\r\n  if (this.options.fit || this.options.contain) {\r\n    var newScale;\r\n    if (this.options.fit) {\r\n      newScale = Math.min(this.options.width/this.viewBox.width, this.options.height/this.viewBox.height);\r\n    } else {\r\n      newScale = Math.max(this.options.width/this.viewBox.width, this.options.height/this.viewBox.height);\r\n    }\r\n\r\n    newCTM.a = newScale; //x-scale\r\n    newCTM.d = newScale; //y-scale\r\n    newCTM.e = -this.viewBox.x * newScale; //x-transform\r\n    newCTM.f = -this.viewBox.y * newScale; //y-transform\r\n  }\r\n\r\n  if (this.options.center) {\r\n    var offsetX = (this.options.width - (this.viewBox.width + this.viewBox.x * 2) * newCTM.a) * 0.5\r\n      , offsetY = (this.options.height - (this.viewBox.height + this.viewBox.y * 2) * newCTM.a) * 0.5\r\n\r\n    newCTM.e = offsetX\r\n    newCTM.f = offsetY\r\n  }\r\n\r\n  // Cache initial values. Based on activeState and fix+center opitons\r\n  this.originalState.zoom = newCTM.a\r\n  this.originalState.x = newCTM.e\r\n  this.originalState.y = newCTM.f\r\n\r\n  return newCTM\r\n}\r\n\r\n/**\r\n * Return originalState object. Safe to alter\r\n *\r\n * @return {Object}\r\n */\r\nShadowViewport.prototype.getOriginalState = function() {\r\n  return Utils.extend({}, this.originalState)\r\n}\r\n\r\n/**\r\n * Return actualState object. Safe to alter\r\n *\r\n * @return {Object}\r\n */\r\nShadowViewport.prototype.getState = function() {\r\n  return Utils.extend({}, this.activeState)\r\n}\r\n\r\n/**\r\n * Get zoom scale\r\n *\r\n * @return {Float} zoom scale\r\n */\r\nShadowViewport.prototype.getZoom = function() {\r\n  return this.activeState.zoom\r\n}\r\n\r\n/**\r\n * Get zoom scale for pubilc usage\r\n *\r\n * @return {Float} zoom scale\r\n */\r\nShadowViewport.prototype.getRelativeZoom = function() {\r\n  return this.activeState.zoom / this.originalState.zoom\r\n}\r\n\r\n/**\r\n * Compute zoom scale for pubilc usage\r\n *\r\n * @return {Float} zoom scale\r\n */\r\nShadowViewport.prototype.computeRelativeZoom = function(scale) {\r\n  return scale / this.originalState.zoom\r\n}\r\n\r\n/**\r\n * Get pan\r\n *\r\n * @return {Object}\r\n */\r\nShadowViewport.prototype.getPan = function() {\r\n  return {x: this.activeState.x, y: this.activeState.y}\r\n}\r\n\r\n/**\r\n * Return cached viewport CTM value that can be safely modified\r\n *\r\n * @return {SVGMatrix}\r\n */\r\nShadowViewport.prototype.getCTM = function() {\r\n  var safeCTM = this.options.svg.createSVGMatrix()\r\n\r\n  // Copy values manually as in FF they are not itterable\r\n  safeCTM.a = this.activeState.zoom\r\n  safeCTM.b = 0\r\n  safeCTM.c = 0\r\n  safeCTM.d = this.activeState.zoom\r\n  safeCTM.e = this.activeState.x\r\n  safeCTM.f = this.activeState.y\r\n\r\n  return safeCTM\r\n}\r\n\r\n/**\r\n * Set a new CTM\r\n *\r\n * @param {SVGMatrix} newCTM\r\n */\r\nShadowViewport.prototype.setCTM = function(newCTM) {\r\n  var willZoom = this.isZoomDifferent(newCTM)\r\n    , willPan = this.isPanDifferent(newCTM)\r\n\r\n  if (willZoom || willPan) {\r\n    // Before zoom\r\n    if (willZoom) {\r\n      // If returns false then cancel zooming\r\n      if (this.options.beforeZoom(this.getRelativeZoom(), this.computeRelativeZoom(newCTM.a)) === false) {\r\n        newCTM.a = newCTM.d = this.activeState.zoom\r\n        willZoom = false\r\n      } else {\r\n        this.updateCache(newCTM);\r\n        this.options.onZoom(this.getRelativeZoom())\r\n      }\r\n    }\r\n\r\n    // Before pan\r\n    if (willPan) {\r\n      var preventPan = this.options.beforePan(this.getPan(), {x: newCTM.e, y: newCTM.f})\r\n          // If prevent pan is an object\r\n        , preventPanX = false\r\n        , preventPanY = false\r\n\r\n      // If prevent pan is Boolean false\r\n      if (preventPan === false) {\r\n        // Set x and y same as before\r\n        newCTM.e = this.getPan().x\r\n        newCTM.f = this.getPan().y\r\n\r\n        preventPanX = preventPanY = true\r\n      } else if (Utils.isObject(preventPan)) {\r\n        // Check for X axes attribute\r\n        if (preventPan.x === false) {\r\n          // Prevent panning on x axes\r\n          newCTM.e = this.getPan().x\r\n          preventPanX = true\r\n        } else if (Utils.isNumber(preventPan.x)) {\r\n          // Set a custom pan value\r\n          newCTM.e = preventPan.x\r\n        }\r\n\r\n        // Check for Y axes attribute\r\n        if (preventPan.y === false) {\r\n          // Prevent panning on x axes\r\n          newCTM.f = this.getPan().y\r\n          preventPanY = true\r\n        } else if (Utils.isNumber(preventPan.y)) {\r\n          // Set a custom pan value\r\n          newCTM.f = preventPan.y\r\n        }\r\n      }\r\n\r\n      // Update willPan flag\r\n      // Check if newCTM is still different\r\n      if ((preventPanX && preventPanY) || !this.isPanDifferent(newCTM)) {\r\n        willPan = false\r\n      } else {\r\n        this.updateCache(newCTM);\r\n        this.options.onPan(this.getPan());\r\n      }\r\n    }\r\n\r\n    // Check again if should zoom or pan\r\n    if (willZoom || willPan) {\r\n      this.updateCTMOnNextFrame()\r\n    }\r\n  }\r\n}\r\n\r\nShadowViewport.prototype.isZoomDifferent = function(newCTM) {\r\n  return this.activeState.zoom !== newCTM.a\r\n}\r\n\r\nShadowViewport.prototype.isPanDifferent = function(newCTM) {\r\n  return this.activeState.x !== newCTM.e || this.activeState.y !== newCTM.f\r\n}\r\n\r\n\r\n/**\r\n * Update cached CTM and active state\r\n *\r\n * @param {SVGMatrix} newCTM\r\n */\r\nShadowViewport.prototype.updateCache = function(newCTM) {\r\n  this.activeState.zoom = newCTM.a\r\n  this.activeState.x = newCTM.e\r\n  this.activeState.y = newCTM.f\r\n}\r\n\r\nShadowViewport.prototype.pendingUpdate = false\r\n\r\n/**\r\n * Place a request to update CTM on next Frame\r\n */\r\nShadowViewport.prototype.updateCTMOnNextFrame = function() {\r\n  if (!this.pendingUpdate) {\r\n    // Lock\r\n    this.pendingUpdate = true\r\n\r\n    // Throttle next update\r\n    this.requestAnimationFrame.call(window, this.updateCTMCached)\r\n  }\r\n}\r\n\r\n/**\r\n * Update viewport CTM with cached CTM\r\n */\r\nShadowViewport.prototype.updateCTM = function() {\r\n  var ctm = this.getCTM()\r\n\r\n  // Updates SVG element\r\n  SvgUtils.setCTM(this.viewport, ctm, this.defs)\r\n\r\n  // Free the lock\r\n  this.pendingUpdate = false\r\n\r\n  // Notify about the update\r\n  if(this.options.onUpdatedCTM) {\r\n    this.options.onUpdatedCTM(ctm)\r\n  }\r\n}\r\n\r\nmodule.exports = function(viewport, options){\r\n  return new ShadowViewport(viewport, options)\r\n}\r\n\n},{\"./svg-utilities\":5,\"./utilities\":7}],4:[function(require,module,exports){\nvar Wheel = require('./uniwheel'),\r\n    ControlIcons = require('./control-icons'),\r\n    Utils = require('./utilities'),\r\n    SvgUtils = require('./svg-utilities'),\r\n    ShadowViewport = require('./shadow-viewport')\r\n\r\nvar SvgPanZoom = function(svg, options) {\r\n    this.init(svg, options)\r\n}\r\n\r\nvar optionsDefaults = {\r\n    viewportSelector: '.svg-pan-zoom_viewport', // Viewport selector. Can be querySelector string or SVGElement\r\n    panEnabled: true, // enable or disable panning (default enabled)\r\n    controlIconsEnabled: false, // insert icons to give user an option in addition to mouse events to control pan/zoom (default disabled)\r\n    zoomEnabled: true, // enable or disable zooming (default enabled)\r\n    dblClickZoomEnabled: true, // enable or disable zooming by double clicking (default enabled)\r\n    mouseWheelZoomEnabled: true, // enable or disable zooming by mouse wheel (default enabled)\r\n    preventMouseEventsDefault: true, // enable or disable preventDefault for mouse events\r\n    zoomScaleSensitivity: 0.1, // Zoom sensitivity\r\n    minZoom: 0.5, // Minimum Zoom level\r\n    maxZoom: 10, // Maximum Zoom level\r\n    fit: true, // enable or disable viewport fit in SVG (default true)\r\n    contain: false, // enable or disable viewport contain the svg (default false)\r\n    center: true, // enable or disable viewport centering in SVG (default true)\r\n    refreshRate: 'auto', // Maximum number of frames per second (altering SVG's viewport)\r\n    beforeZoom: null,\r\n    onZoom: null,\r\n    beforePan: null,\r\n    onPan: null,\r\n    customEventsHandler: null,\r\n    eventsListenerElement: null,\r\n    onUpdatedCTM: null,\r\n    restrictEventsListenerEvent: false\r\n}\r\n\r\nSvgPanZoom.prototype.init = function(svg, options) {\r\n    var that = this\r\n\r\n    this.svg = svg\r\n    this.defs = svg.querySelector('defs')\r\n\r\n    // Add default attributes to SVG\r\n    SvgUtils.setupSvgAttributes(this.svg)\r\n\r\n    // Set options\r\n    this.options = Utils.extend(Utils.extend({}, optionsDefaults), options)\r\n\r\n    //Check if eventsListenerElement, otherwise just set restrictEventsListenerEvent to false (ignore user)\r\n    if (this.options.eventsListenerElement === null) {\r\n        this.options.restrictEventsListenerEvent = false;\r\n    }\r\n\r\n    // Set default state\r\n    this.state = 'none'\r\n\r\n    // Get dimensions\r\n    var boundingClientRectNormalized = SvgUtils.getBoundingClientRectNormalized(svg)\r\n    this.width = boundingClientRectNormalized.width\r\n    this.height = boundingClientRectNormalized.height\r\n\r\n    // Init shadow viewport\r\n    this.viewport = ShadowViewport(SvgUtils.getOrCreateViewport(this.svg, this.options.viewportSelector), {\r\n        svg: this.svg,\r\n        width: this.width,\r\n        height: this.height,\r\n        fit: this.options.fit,\r\n        contain: this.options.contain,\r\n        center: this.options.center,\r\n        refreshRate: this.options.refreshRate\r\n            // Put callbacks into functions as they can change through time\r\n            ,\r\n        beforeZoom: function(oldScale, newScale) {\r\n            if (that.viewport && that.options.beforeZoom) { return that.options.beforeZoom(oldScale, newScale) }\r\n        },\r\n        onZoom: function(scale) {\r\n            if (that.viewport && that.options.onZoom) { return that.options.onZoom(scale) }\r\n        },\r\n        beforePan: function(oldPoint, newPoint) {\r\n            if (that.viewport && that.options.beforePan) { return that.options.beforePan(oldPoint, newPoint) }\r\n        },\r\n        onPan: function(point) {\r\n            if (that.viewport && that.options.onPan) { return that.options.onPan(point) }\r\n        },\r\n        onUpdatedCTM: function(ctm) {\r\n            if (that.viewport && that.options.onUpdatedCTM) { return that.options.onUpdatedCTM(ctm) }\r\n        }\r\n    })\r\n\r\n    // Wrap callbacks into public API context\r\n    var publicInstance = this.getPublicInstance()\r\n    publicInstance.setBeforeZoom(this.options.beforeZoom)\r\n    publicInstance.setOnZoom(this.options.onZoom)\r\n    publicInstance.setBeforePan(this.options.beforePan)\r\n    publicInstance.setOnPan(this.options.onPan)\r\n    publicInstance.setOnUpdatedCTM(this.options.onUpdatedCTM)\r\n\r\n    if (this.options.controlIconsEnabled) {\r\n        ControlIcons.enable(this)\r\n    }\r\n\r\n    // Init events handlers\r\n    this.lastMouseWheelEventTime = Date.now()\r\n    this.setupHandlers()\r\n}\r\n\r\n/**\r\n * Register event handlers\r\n */\r\nSvgPanZoom.prototype.setupHandlers = function() {\r\n    var that = this,\r\n        prevEvt = null // use for touchstart event to detect double tap\r\n    ;\r\n\r\n    this.eventListeners = {\r\n        // Mouse down group\r\n        mousedown: function(evt) {\r\n            if (that.options.restrictEventsListenerEvent && evt.target !== that.options.eventsListenerElement) return;\r\n            var result = that.handleMouseDown(evt, prevEvt);\r\n            prevEvt = evt\r\n            return result;\r\n        },\r\n        touchstart: function(evt) {\r\n            if (that.options.restrictEventsListenerEvent && evt.target !== that.options.eventsListenerElement) return;\r\n            var result = that.handleMouseDown(evt, prevEvt);\r\n            prevEvt = evt\r\n            return result;\r\n        }\r\n\r\n        // Mouse up group\r\n        ,\r\n        mouseup: function(evt) {\r\n            if (that.options.restrictEventsListenerEvent && evt.target !== that.options.eventsListenerElement) return;\r\n            return that.handleMouseUp(evt);\r\n        },\r\n        touchend: function(evt) {\r\n            if (that.options.restrictEventsListenerEvent && evt.target !== that.options.eventsListenerElement) return;\r\n            return that.handleMouseUp(evt);\r\n        }\r\n\r\n        // Mouse move group\r\n        ,\r\n        mousemove: function(evt) {\r\n            if (that.options.restrictEventsListenerEvent && evt.target !== that.options.eventsListenerElement) return;\r\n            return that.handleMouseMove(evt);\r\n        },\r\n        touchmove: function(evt) {\r\n            if (that.options.restrictEventsListenerEvent && evt.target !== that.options.eventsListenerElement) return;\r\n            return that.handleMouseMove(evt);\r\n        }\r\n\r\n        // Mouse leave group\r\n        ,\r\n        mouseleave: function(evt) {\r\n            if (that.options.restrictEventsListenerEvent && evt.target !== that.options.eventsListenerElement) return;\r\n            return that.handleMouseUp(evt);\r\n        },\r\n        touchleave: function(evt) {\r\n            if (that.options.restrictEventsListenerEvent && evt.target !== that.options.eventsListenerElement) return;\r\n            return that.handleMouseUp(evt);\r\n        },\r\n        touchcancel: function(evt) {\r\n            if (that.options.restrictEventsListenerEvent && evt.target !== that.options.eventsListenerElement) return;\r\n            return that.handleMouseUp(evt);\r\n        }\r\n    }\r\n\r\n    // Init custom events handler if available\r\n    if (this.options.customEventsHandler != null) { // jshint ignore:line\r\n        this.options.customEventsHandler.init({\r\n            svgElement: this.svg,\r\n            eventsListenerElement: this.options.eventsListenerElement,\r\n            instance: this.getPublicInstance()\r\n        })\r\n\r\n        // Custom event handler may halt builtin listeners\r\n        var haltEventListeners = this.options.customEventsHandler.haltEventListeners\r\n        if (haltEventListeners && haltEventListeners.length) {\r\n            for (var i = haltEventListeners.length - 1; i >= 0; i--) {\r\n                if (this.eventListeners.hasOwnProperty(haltEventListeners[i])) {\r\n                    delete this.eventListeners[haltEventListeners[i]]\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    // Bind eventListeners\r\n    for (var event in this.eventListeners) {\r\n        // Attach event to eventsListenerElement or SVG if not available\r\n        (this.options.eventsListenerElement || this.svg)\r\n        .addEventListener(event, this.eventListeners[event], false)\r\n    }\r\n\r\n    // Zoom using mouse wheel\r\n    if (this.options.mouseWheelZoomEnabled) {\r\n        this.options.mouseWheelZoomEnabled = false // set to false as enable will set it back to true\r\n        this.enableMouseWheelZoom()\r\n    }\r\n}\r\n\r\n/**\r\n * Enable ability to zoom using mouse wheel\r\n */\r\nSvgPanZoom.prototype.enableMouseWheelZoom = function() {\r\n    if (!this.options.mouseWheelZoomEnabled) {\r\n        var that = this\r\n\r\n        // Mouse wheel listener\r\n        this.wheelListener = function(evt) {\r\n            return that.handleMouseWheel(evt);\r\n        }\r\n\r\n        // Bind wheelListener\r\n        Wheel.on(this.options.eventsListenerElement || this.svg, this.wheelListener, false)\r\n\r\n        this.options.mouseWheelZoomEnabled = true\r\n    }\r\n}\r\n\r\n/**\r\n * Disable ability to zoom using mouse wheel\r\n */\r\nSvgPanZoom.prototype.disableMouseWheelZoom = function() {\r\n    if (this.options.mouseWheelZoomEnabled) {\r\n        Wheel.off(this.options.eventsListenerElement || this.svg, this.wheelListener, false)\r\n        this.options.mouseWheelZoomEnabled = false\r\n    }\r\n}\r\n\r\n/**\r\n * Handle mouse wheel event\r\n *\r\n * @param  {Event} evt\r\n */\r\nSvgPanZoom.prototype.handleMouseWheel = function(evt) {\r\n    if (!this.options.zoomEnabled || this.state !== 'none') {\r\n        return;\r\n    }\r\n\r\n    if (this.options.preventMouseEventsDefault) {\r\n        if (evt.preventDefault) {\r\n            evt.preventDefault();\r\n        } else {\r\n            evt.returnValue = false;\r\n        }\r\n    }\r\n\r\n    // Default delta in case that deltaY is not available\r\n    var delta = evt.deltaY || 1,\r\n        timeDelta = Date.now() - this.lastMouseWheelEventTime,\r\n        divider = 3 + Math.max(0, 30 - timeDelta)\r\n\r\n    // Update cache\r\n    this.lastMouseWheelEventTime = Date.now()\r\n\r\n    // Make empirical adjustments for browsers that give deltaY in pixels (deltaMode=0)\r\n    if ('deltaMode' in evt && evt.deltaMode === 0 && evt.wheelDelta) {\r\n        delta = evt.deltaY === 0 ? 0 : Math.abs(evt.wheelDelta) / evt.deltaY\r\n    }\r\n\r\n    delta = -0.3 < delta && delta < 0.3 ? delta : (delta > 0 ? 1 : -1) * Math.log(Math.abs(delta) + 10) / divider\r\n\r\n    var inversedScreenCTM = this.svg.getScreenCTM().inverse(),\r\n        relativeMousePoint = SvgUtils.getEventPoint(evt, this.svg).matrixTransform(inversedScreenCTM),\r\n        zoom = Math.pow(1 + this.options.zoomScaleSensitivity, (-1) * delta); // multiplying by neg. 1 so as to make zoom in/out behavior match Google maps behavior\r\n\r\n    this.zoomAtPoint(zoom, relativeMousePoint)\r\n}\r\n\r\n/**\r\n * Zoom in at a SVG point\r\n *\r\n * @param  {SVGPoint} point\r\n * @param  {Float} zoomScale    Number representing how much to zoom\r\n * @param  {Boolean} zoomAbsolute Default false. If true, zoomScale is treated as an absolute value.\r\n *                                Otherwise, zoomScale is treated as a multiplied (e.g. 1.10 would zoom in 10%)\r\n */\r\nSvgPanZoom.prototype.zoomAtPoint = function(zoomScale, point, zoomAbsolute) {\r\n    var originalState = this.viewport.getOriginalState()\r\n\r\n    if (!zoomAbsolute) {\r\n        // Fit zoomScale in set bounds\r\n        if (this.getZoom() * zoomScale < this.options.minZoom * originalState.zoom) {\r\n            zoomScale = (this.options.minZoom * originalState.zoom) / this.getZoom()\r\n        } else if (this.getZoom() * zoomScale > this.options.maxZoom * originalState.zoom) {\r\n            zoomScale = (this.options.maxZoom * originalState.zoom) / this.getZoom()\r\n        }\r\n    } else {\r\n        // Fit zoomScale in set bounds\r\n        zoomScale = Math.max(this.options.minZoom * originalState.zoom, Math.min(this.options.maxZoom * originalState.zoom, zoomScale))\r\n            // Find relative scale to achieve desired scale\r\n        zoomScale = zoomScale / this.getZoom()\r\n    }\r\n\r\n    var oldCTM = this.viewport.getCTM(),\r\n        relativePoint = point.matrixTransform(oldCTM.inverse()),\r\n        modifier = this.svg.createSVGMatrix().translate(relativePoint.x, relativePoint.y).scale(zoomScale).translate(-relativePoint.x, -relativePoint.y),\r\n        newCTM = oldCTM.multiply(modifier)\r\n\r\n    if (newCTM.a !== oldCTM.a) {\r\n        this.viewport.setCTM(newCTM)\r\n    }\r\n}\r\n\r\n/**\r\n * Zoom at center point\r\n *\r\n * @param  {Float} scale\r\n * @param  {Boolean} absolute Marks zoom scale as relative or absolute\r\n */\r\nSvgPanZoom.prototype.zoom = function(scale, absolute) {\r\n    this.zoomAtPoint(scale, SvgUtils.getSvgCenterPoint(this.svg, this.width, this.height), absolute)\r\n}\r\n\r\n/**\r\n * Zoom used by public instance\r\n *\r\n * @param  {Float} scale\r\n * @param  {Boolean} absolute Marks zoom scale as relative or absolute\r\n */\r\nSvgPanZoom.prototype.publicZoom = function(scale, absolute) {\r\n    if (absolute) {\r\n        scale = this.computeFromRelativeZoom(scale)\r\n    }\r\n\r\n    this.zoom(scale, absolute)\r\n}\r\n\r\n/**\r\n * Zoom at point used by public instance\r\n *\r\n * @param  {Float} scale\r\n * @param  {SVGPoint|Object} point    An object that has x and y attributes\r\n * @param  {Boolean} absolute Marks zoom scale as relative or absolute\r\n */\r\nSvgPanZoom.prototype.publicZoomAtPoint = function(scale, point, absolute) {\r\n    if (absolute) {\r\n        // Transform zoom into a relative value\r\n        scale = this.computeFromRelativeZoom(scale)\r\n    }\r\n\r\n    // If not a SVGPoint but has x and y then create a SVGPoint\r\n    if (Utils.getType(point) !== 'SVGPoint') {\r\n        if ('x' in point && 'y' in point) {\r\n            point = SvgUtils.createSVGPoint(this.svg, point.x, point.y)\r\n        } else {\r\n            throw new Error('Given point is invalid')\r\n        }\r\n    }\r\n\r\n    this.zoomAtPoint(scale, point, absolute)\r\n}\r\n\r\n/**\r\n * Get zoom scale\r\n *\r\n * @return {Float} zoom scale\r\n */\r\nSvgPanZoom.prototype.getZoom = function() {\r\n    return this.viewport.getZoom()\r\n}\r\n\r\n/**\r\n * Get zoom scale for public usage\r\n *\r\n * @return {Float} zoom scale\r\n */\r\nSvgPanZoom.prototype.getRelativeZoom = function() {\r\n    return this.viewport.getRelativeZoom()\r\n}\r\n\r\n/**\r\n * Compute actual zoom from public zoom\r\n *\r\n * @param  {Float} zoom\r\n * @return {Float} zoom scale\r\n */\r\nSvgPanZoom.prototype.computeFromRelativeZoom = function(zoom) {\r\n    return zoom * this.viewport.getOriginalState().zoom\r\n}\r\n\r\n/**\r\n * Set zoom to initial state\r\n */\r\nSvgPanZoom.prototype.resetZoom = function() {\r\n    var originalState = this.viewport.getOriginalState()\r\n\r\n    this.zoom(originalState.zoom, true);\r\n}\r\n\r\n/**\r\n * Set pan to initial state\r\n */\r\nSvgPanZoom.prototype.resetPan = function() {\r\n    this.pan(this.viewport.getOriginalState());\r\n}\r\n\r\n/**\r\n * Set pan and zoom to initial state\r\n */\r\nSvgPanZoom.prototype.reset = function() {\r\n    this.resetZoom()\r\n    this.resetPan()\r\n}\r\n\r\n/**\r\n * Handle double click event\r\n * See handleMouseDown() for alternate detection method\r\n *\r\n * @param {Event} evt\r\n */\r\nSvgPanZoom.prototype.handleDblClick = function(evt) {\r\n    if (this.options.preventMouseEventsDefault) {\r\n        if (evt.preventDefault) {\r\n            evt.preventDefault()\r\n        } else {\r\n            evt.returnValue = false\r\n        }\r\n    }\r\n\r\n    // Check if target was a control button\r\n    if (this.options.controlIconsEnabled) {\r\n        var targetClass = evt.target.getAttribute('class') || ''\r\n        if (targetClass.indexOf('svg-pan-zoom-control') > -1) {\r\n            return false\r\n        }\r\n    }\r\n\r\n    var zoomFactor\r\n\r\n    if (evt.shiftKey) {\r\n        zoomFactor = 1 / ((1 + this.options.zoomScaleSensitivity) * 2) // zoom out when shift key pressed\r\n    } else {\r\n        zoomFactor = (1 + this.options.zoomScaleSensitivity) * 2\r\n    }\r\n\r\n    var point = SvgUtils.getEventPoint(evt, this.svg).matrixTransform(this.svg.getScreenCTM().inverse())\r\n    this.zoomAtPoint(zoomFactor, point)\r\n}\r\n\r\n/**\r\n * Handle click event\r\n *\r\n * @param {Event} evt\r\n */\r\nSvgPanZoom.prototype.handleMouseDown = function(evt, prevEvt) {\r\n    if (this.options.preventMouseEventsDefault) {\r\n        if (evt.preventDefault) {\r\n            evt.preventDefault()\r\n        } else {\r\n            evt.returnValue = false\r\n        }\r\n    }\r\n\r\n    Utils.mouseAndTouchNormalize(evt, this.svg)\r\n\r\n    // Double click detection; more consistent than ondblclick\r\n    if (this.options.dblClickZoomEnabled && Utils.isDblClick(evt, prevEvt)) {\r\n        this.handleDblClick(evt)\r\n    } else {\r\n        // Pan mode\r\n        this.state = 'pan'\r\n        this.firstEventCTM = this.viewport.getCTM()\r\n        this.stateOrigin = SvgUtils.getEventPoint(evt, this.svg).matrixTransform(this.firstEventCTM.inverse())\r\n    }\r\n}\r\n\r\n/**\r\n * Handle mouse move event\r\n *\r\n * @param  {Event} evt\r\n */\r\nSvgPanZoom.prototype.handleMouseMove = function(evt) {\r\n    if (this.options.preventMouseEventsDefault) {\r\n        if (evt.preventDefault) {\r\n            evt.preventDefault()\r\n        } else {\r\n            evt.returnValue = false\r\n        }\r\n    }\r\n\r\n    if (this.state === 'pan' && this.options.panEnabled) {\r\n        // Pan mode\r\n        var point = SvgUtils.getEventPoint(evt, this.svg).matrixTransform(this.firstEventCTM.inverse()),\r\n            viewportCTM = this.firstEventCTM.translate(point.x - this.stateOrigin.x, point.y - this.stateOrigin.y)\r\n\r\n        this.viewport.setCTM(viewportCTM)\r\n    }\r\n}\r\n\r\n/**\r\n * Handle mouse button release event\r\n *\r\n * @param {Event} evt\r\n */\r\nSvgPanZoom.prototype.handleMouseUp = function(evt) {\r\n    if (this.options.preventMouseEventsDefault) {\r\n        if (evt.preventDefault) {\r\n            evt.preventDefault()\r\n        } else {\r\n            evt.returnValue = false\r\n        }\r\n    }\r\n\r\n    if (this.state === 'pan') {\r\n        // Quit pan mode\r\n        this.state = 'none'\r\n    }\r\n}\r\n\r\n/**\r\n * Adjust viewport size (only) so it will fit in SVG\r\n * Does not center image\r\n */\r\nSvgPanZoom.prototype.fit = function() {\r\n    var viewBox = this.viewport.getViewBox(),\r\n        newScale = Math.min(this.width / viewBox.width, this.height / viewBox.height)\r\n\r\n    this.zoom(newScale, true)\r\n}\r\n\r\n/**\r\n * Adjust viewport size (only) so it will contain the SVG\r\n * Does not center image\r\n */\r\nSvgPanZoom.prototype.contain = function() {\r\n    var viewBox = this.viewport.getViewBox(),\r\n        newScale = Math.max(this.width / viewBox.width, this.height / viewBox.height)\r\n\r\n    this.zoom(newScale, true)\r\n}\r\n\r\n/**\r\n * Adjust viewport pan (only) so it will be centered in SVG\r\n * Does not zoom/fit/contain image\r\n */\r\nSvgPanZoom.prototype.center = function() {\r\n    var viewBox = this.viewport.getViewBox(),\r\n        offsetX = (this.width - (viewBox.width + viewBox.x * 2) * this.getZoom()) * 0.5,\r\n        offsetY = (this.height - (viewBox.height + viewBox.y * 2) * this.getZoom()) * 0.5\r\n\r\n    this.getPublicInstance().pan({ x: offsetX, y: offsetY })\r\n}\r\n\r\n/**\r\n * Update content cached BorderBox\r\n * Use when viewport contents change\r\n */\r\nSvgPanZoom.prototype.updateBBox = function() {\r\n    this.viewport.simpleViewBoxCache()\r\n}\r\n\r\n/**\r\n * Pan to a rendered position\r\n *\r\n * @param  {Object} point {x: 0, y: 0}\r\n */\r\nSvgPanZoom.prototype.pan = function(point) {\r\n    var viewportCTM = this.viewport.getCTM()\r\n    viewportCTM.e = point.x\r\n    viewportCTM.f = point.y\r\n    this.viewport.setCTM(viewportCTM)\r\n}\r\n\r\n/**\r\n * Relatively pan the graph by a specified rendered position vector\r\n *\r\n * @param  {Object} point {x: 0, y: 0}\r\n */\r\nSvgPanZoom.prototype.panBy = function(point) {\r\n    var viewportCTM = this.viewport.getCTM()\r\n    viewportCTM.e += point.x\r\n    viewportCTM.f += point.y\r\n    this.viewport.setCTM(viewportCTM)\r\n}\r\n\r\n/**\r\n * Get pan vector\r\n *\r\n * @return {Object} {x: 0, y: 0}\r\n */\r\nSvgPanZoom.prototype.getPan = function() {\r\n    var state = this.viewport.getState()\r\n\r\n    return { x: state.x, y: state.y }\r\n}\r\n\r\n/**\r\n * Recalculates cached svg dimensions and controls position\r\n */\r\nSvgPanZoom.prototype.resize = function() {\r\n    // Get dimensions\r\n    var boundingClientRectNormalized = SvgUtils.getBoundingClientRectNormalized(this.svg)\r\n    this.width = boundingClientRectNormalized.width\r\n    this.height = boundingClientRectNormalized.height\r\n\r\n    // Recalculate original state\r\n    var viewport = this.viewport\r\n    viewport.options.width = this.width\r\n    viewport.options.height = this.height\r\n    viewport.processCTM()\r\n\r\n    // Reposition control icons by re-enabling them\r\n    if (this.options.controlIconsEnabled) {\r\n        this.getPublicInstance().disableControlIcons()\r\n        this.getPublicInstance().enableControlIcons()\r\n    }\r\n}\r\n\r\n/**\r\n * Unbind mouse events, free callbacks and destroy public instance\r\n */\r\nSvgPanZoom.prototype.destroy = function() {\r\n    var that = this\r\n\r\n    // Free callbacks\r\n    this.beforeZoom = null\r\n    this.onZoom = null\r\n    this.beforePan = null\r\n    this.onPan = null\r\n    this.onUpdatedCTM = null\r\n\r\n    // Destroy custom event handlers\r\n    if (this.options.customEventsHandler != null) { // jshint ignore:line\r\n        this.options.customEventsHandler.destroy({\r\n            svgElement: this.svg,\r\n            eventsListenerElement: this.options.eventsListenerElement,\r\n            instance: this.getPublicInstance()\r\n        })\r\n    }\r\n\r\n    // Unbind eventListeners\r\n    for (var event in this.eventListeners) {\r\n        (this.options.eventsListenerElement || this.svg)\r\n        .removeEventListener(event, this.eventListeners[event], false)\r\n    }\r\n\r\n    // Unbind wheelListener\r\n    this.disableMouseWheelZoom()\r\n\r\n    // Remove control icons\r\n    this.getPublicInstance().disableControlIcons()\r\n\r\n    // Reset zoom and pan\r\n    this.reset()\r\n\r\n    // Remove instance from instancesStore\r\n    instancesStore = instancesStore.filter(function(instance) {\r\n        return instance.svg !== that.svg\r\n    })\r\n\r\n    // Delete options and its contents\r\n    delete this.options\r\n\r\n    // Delete viewport to make public shadow viewport functions uncallable\r\n    delete this.viewport\r\n\r\n    // Destroy public instance and rewrite getPublicInstance\r\n    delete this.publicInstance\r\n    delete this.pi\r\n    this.getPublicInstance = function() {\r\n        return null\r\n    }\r\n}\r\n\r\n/**\r\n * Returns a public instance object\r\n *\r\n * @return {Object} Public instance object\r\n */\r\nSvgPanZoom.prototype.getPublicInstance = function() {\r\n    var that = this\r\n\r\n    // Create cache\r\n    if (!this.publicInstance) {\r\n        this.publicInstance = this.pi = {\r\n            // Pan\r\n            enablePan: function() { that.options.panEnabled = true; return that.pi },\r\n            disablePan: function() { that.options.panEnabled = false; return that.pi },\r\n            isPanEnabled: function() { return !!that.options.panEnabled },\r\n            pan: function(point) { that.pan(point); return that.pi },\r\n            panBy: function(point) { that.panBy(point); return that.pi },\r\n            getPan: function() { return that.getPan() }\r\n                // Pan event\r\n                ,\r\n            setBeforePan: function(fn) { that.options.beforePan = fn === null ? null : Utils.proxy(fn, that.publicInstance); return that.pi },\r\n            setOnPan: function(fn) { that.options.onPan = fn === null ? null : Utils.proxy(fn, that.publicInstance); return that.pi }\r\n                // Zoom and Control Icons\r\n                ,\r\n            enableZoom: function() { that.options.zoomEnabled = true; return that.pi },\r\n            disableZoom: function() { that.options.zoomEnabled = false; return that.pi },\r\n            isZoomEnabled: function() { return !!that.options.zoomEnabled },\r\n            enableControlIcons: function() {\r\n                if (!that.options.controlIconsEnabled) {\r\n                    that.options.controlIconsEnabled = true\r\n                    ControlIcons.enable(that)\r\n                }\r\n                return that.pi\r\n            },\r\n            disableControlIcons: function() {\r\n                if (that.options.controlIconsEnabled) {\r\n                    that.options.controlIconsEnabled = false;\r\n                    ControlIcons.disable(that)\r\n                }\r\n                return that.pi\r\n            },\r\n            isControlIconsEnabled: function() { return !!that.options.controlIconsEnabled }\r\n                // Double click zoom\r\n                ,\r\n            enableDblClickZoom: function() { that.options.dblClickZoomEnabled = true; return that.pi },\r\n            disableDblClickZoom: function() { that.options.dblClickZoomEnabled = false; return that.pi },\r\n            isDblClickZoomEnabled: function() { return !!that.options.dblClickZoomEnabled }\r\n                // Mouse wheel zoom\r\n                ,\r\n            enableMouseWheelZoom: function() { that.enableMouseWheelZoom(); return that.pi },\r\n            disableMouseWheelZoom: function() { that.disableMouseWheelZoom(); return that.pi },\r\n            isMouseWheelZoomEnabled: function() { return !!that.options.mouseWheelZoomEnabled }\r\n                // Zoom scale and bounds\r\n                ,\r\n            setZoomScaleSensitivity: function(scale) { that.options.zoomScaleSensitivity = scale; return that.pi },\r\n            setMinZoom: function(zoom) { that.options.minZoom = zoom; return that.pi },\r\n            setMaxZoom: function(zoom) { that.options.maxZoom = zoom; return that.pi }\r\n                // Zoom event\r\n                ,\r\n            setBeforeZoom: function(fn) { that.options.beforeZoom = fn === null ? null : Utils.proxy(fn, that.publicInstance); return that.pi },\r\n            setOnZoom: function(fn) { that.options.onZoom = fn === null ? null : Utils.proxy(fn, that.publicInstance); return that.pi }\r\n                // Zooming\r\n                ,\r\n            zoom: function(scale) { that.publicZoom(scale, true); return that.pi },\r\n            zoomBy: function(scale) { that.publicZoom(scale, false); return that.pi },\r\n            zoomAtPoint: function(scale, point) { that.publicZoomAtPoint(scale, point, true); return that.pi },\r\n            zoomAtPointBy: function(scale, point) { that.publicZoomAtPoint(scale, point, false); return that.pi },\r\n            zoomIn: function() { this.zoomBy(1 + that.options.zoomScaleSensitivity); return that.pi },\r\n            zoomOut: function() { this.zoomBy(1 / (1 + that.options.zoomScaleSensitivity)); return that.pi },\r\n            getZoom: function() { return that.getRelativeZoom() }\r\n                // CTM update\r\n                ,\r\n            setOnUpdatedCTM: function(fn) { that.options.onUpdatedCTM = fn === null ? null : Utils.proxy(fn, that.publicInstance); return that.pi }\r\n                // Reset\r\n                ,\r\n            resetZoom: function() { that.resetZoom(); return that.pi },\r\n            resetPan: function() { that.resetPan(); return that.pi },\r\n            reset: function() { that.reset(); return that.pi }\r\n                // Fit, Contain and Center\r\n                ,\r\n            fit: function() { that.fit(); return that.pi },\r\n            contain: function() { that.contain(); return that.pi },\r\n            center: function() { that.center(); return that.pi }\r\n                // Size and Resize\r\n                ,\r\n            updateBBox: function() { that.updateBBox(); return that.pi },\r\n            resize: function() { that.resize(); return that.pi },\r\n            getSizes: function() {\r\n                    return {\r\n                        width: that.width,\r\n                        height: that.height,\r\n                        realZoom: that.getZoom(),\r\n                        viewBox: that.viewport.getViewBox()\r\n                    }\r\n                }\r\n                // Destroy\r\n                ,\r\n            destroy: function() { that.destroy(); return that.pi }\r\n        }\r\n    }\r\n\r\n    return this.publicInstance\r\n}\r\n\r\n/**\r\n * Stores pairs of instances of SvgPanZoom and SVG\r\n * Each pair is represented by an object {svg: SVGSVGElement, instance: SvgPanZoom}\r\n *\r\n * @type {Array}\r\n */\r\nvar instancesStore = []\r\n\r\nvar svgPanZoom = function(elementOrSelector, options) {\r\n    var svg = Utils.getSvg(elementOrSelector)\r\n\r\n    if (svg === null) {\r\n        return null\r\n    } else {\r\n        // Look for existent instance\r\n        for (var i = instancesStore.length - 1; i >= 0; i--) {\r\n            if (instancesStore[i].svg === svg) {\r\n                return instancesStore[i].instance.getPublicInstance()\r\n            }\r\n        }\r\n\r\n        // If instance not found - create one\r\n        instancesStore.push({\r\n            svg: svg,\r\n            instance: new SvgPanZoom(svg, options)\r\n        })\r\n\r\n        // Return just pushed instance\r\n        return instancesStore[instancesStore.length - 1].instance.getPublicInstance()\r\n    }\r\n}\r\n\r\nmodule.exports = svgPanZoom;\n},{\"./control-icons\":2,\"./shadow-viewport\":3,\"./svg-utilities\":5,\"./uniwheel\":6,\"./utilities\":7}],5:[function(require,module,exports){\nvar Utils = require('./utilities')\r\n  , _browser = 'unknown'\r\n  ;\r\n\r\n// http://stackoverflow.com/questions/9847580/how-to-detect-safari-chrome-ie-firefox-and-opera-browser\r\nif (/*@cc_on!@*/false || !!document.documentMode) { // internet explorer\r\n  _browser = 'ie';\r\n}\r\n\r\nmodule.exports = {\r\n  svgNS:  'http://www.w3.org/2000/svg'\r\n, xmlNS:  'http://www.w3.org/XML/1998/namespace'\r\n, xmlnsNS:  'http://www.w3.org/2000/xmlns/'\r\n, xlinkNS:  'http://www.w3.org/1999/xlink'\r\n, evNS:  'http://www.w3.org/2001/xml-events'\r\n\r\n  /**\r\n   * Get svg dimensions: width and height\r\n   *\r\n   * @param  {SVGSVGElement} svg\r\n   * @return {Object}     {width: 0, height: 0}\r\n   */\r\n, getBoundingClientRectNormalized: function(svg) {\r\n    if (svg.clientWidth && svg.clientHeight) {\r\n      return {width: svg.clientWidth, height: svg.clientHeight}\r\n    } else if (!!svg.getBoundingClientRect()) {\r\n      return svg.getBoundingClientRect();\r\n    } else {\r\n      throw new Error('Cannot get BoundingClientRect for SVG.');\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Gets g element with class of \"viewport\" or creates it if it doesn't exist\r\n   *\r\n   * @param  {SVGSVGElement} svg\r\n   * @return {SVGElement}     g (group) element\r\n   */\r\n, getOrCreateViewport: function(svg, selector) {\r\n    var viewport = null\r\n\r\n    if (Utils.isElement(selector)) {\r\n      viewport = selector\r\n    } else {\r\n      viewport = svg.querySelector(selector)\r\n    }\r\n\r\n    // Check if there is just one main group in SVG\r\n    if (!viewport) {\r\n      var childNodes = Array.prototype.slice.call(svg.childNodes || svg.children).filter(function(el){\r\n        return el.nodeName !== 'defs' && el.nodeName !== '#text'\r\n      })\r\n\r\n      // Node name should be SVGGElement and should have no transform attribute\r\n      // Groups with transform are not used as viewport because it involves parsing of all transform possibilities\r\n      if (childNodes.length === 1 && childNodes[0].nodeName === 'g' && childNodes[0].getAttribute('transform') === null) {\r\n        viewport = childNodes[0]\r\n      }\r\n    }\r\n\r\n    // If no favorable group element exists then create one\r\n    if (!viewport) {\r\n      var viewportId = 'viewport-' + new Date().toISOString().replace(/\\D/g, '');\r\n      viewport = document.createElementNS(this.svgNS, 'g');\r\n      viewport.setAttribute('id', viewportId);\r\n\r\n      // Internet Explorer (all versions?) can't use childNodes, but other browsers prefer (require?) using childNodes\r\n      var svgChildren = svg.childNodes || svg.children;\r\n      if (!!svgChildren && svgChildren.length > 0) {\r\n        for (var i = svgChildren.length; i > 0; i--) {\r\n          // Move everything into viewport except defs\r\n          if (svgChildren[svgChildren.length - i].nodeName !== 'defs') {\r\n            viewport.appendChild(svgChildren[svgChildren.length - i]);\r\n          }\r\n        }\r\n      }\r\n      svg.appendChild(viewport);\r\n    }\r\n\r\n    // Parse class names\r\n    var classNames = [];\r\n    if (viewport.getAttribute('class')) {\r\n      classNames = viewport.getAttribute('class').split(' ')\r\n    }\r\n\r\n    // Set class (if not set already)\r\n    if (!~classNames.indexOf('svg-pan-zoom_viewport')) {\r\n      classNames.push('svg-pan-zoom_viewport')\r\n      viewport.setAttribute('class', classNames.join(' '))\r\n    }\r\n\r\n    return viewport\r\n  }\r\n\r\n  /**\r\n   * Set SVG attributes\r\n   *\r\n   * @param  {SVGSVGElement} svg\r\n   */\r\n  , setupSvgAttributes: function(svg) {\r\n    // Setting default attributes\r\n    svg.setAttribute('xmlns', this.svgNS);\r\n    svg.setAttributeNS(this.xmlnsNS, 'xmlns:xlink', this.xlinkNS);\r\n    svg.setAttributeNS(this.xmlnsNS, 'xmlns:ev', this.evNS);\r\n\r\n    // Needed for Internet Explorer, otherwise the viewport overflows\r\n    if (svg.parentNode !== null) {\r\n      var style = svg.getAttribute('style') || '';\r\n      if (style.toLowerCase().indexOf('overflow') === -1) {\r\n        svg.setAttribute('style', 'overflow: hidden; ' + style);\r\n      }\r\n    }\r\n  }\r\n\r\n/**\r\n * How long Internet Explorer takes to finish updating its display (ms).\r\n */\r\n, internetExplorerRedisplayInterval: 300\r\n\r\n/**\r\n * Forces the browser to redisplay all SVG elements that rely on an\r\n * element defined in a 'defs' section. It works globally, for every\r\n * available defs element on the page.\r\n * The throttling is intentionally global.\r\n *\r\n * This is only needed for IE. It is as a hack to make markers (and 'use' elements?)\r\n * visible after pan/zoom when there are multiple SVGs on the page.\r\n * See bug report: https://connect.microsoft.com/IE/feedback/details/781964/\r\n * also see svg-pan-zoom issue: https://github.com/ariutta/svg-pan-zoom/issues/62\r\n */\r\n, refreshDefsGlobal: Utils.throttle(function() {\r\n    var allDefs = document.querySelectorAll('defs');\r\n    var allDefsCount = allDefs.length;\r\n    for (var i = 0; i < allDefsCount; i++) {\r\n      var thisDefs = allDefs[i];\r\n      thisDefs.parentNode.insertBefore(thisDefs, thisDefs);\r\n    }\r\n  }, this.internetExplorerRedisplayInterval)\r\n\r\n  /**\r\n   * Sets the current transform matrix of an element\r\n   *\r\n   * @param {SVGElement} element\r\n   * @param {SVGMatrix} matrix  CTM\r\n   * @param {SVGElement} defs\r\n   */\r\n, setCTM: function(element, matrix, defs) {\r\n    var that = this\r\n      , s = 'matrix(' + matrix.a + ',' + matrix.b + ',' + matrix.c + ',' + matrix.d + ',' + matrix.e + ',' + matrix.f + ')';\r\n\r\n    element.setAttributeNS(null, 'transform', s);\r\n    if ('transform' in element.style) {\r\n      element.style.transform = s;\r\n    } else if ('-ms-transform' in element.style) {\r\n      element.style['-ms-transform'] = s;\r\n    } else if ('-webkit-transform' in element.style) {\r\n      element.style['-webkit-transform'] = s;\r\n    }\r\n\r\n    // IE has a bug that makes markers disappear on zoom (when the matrix \"a\" and/or \"d\" elements change)\r\n    // see http://stackoverflow.com/questions/17654578/svg-marker-does-not-work-in-ie9-10\r\n    // and http://srndolha.wordpress.com/2013/11/25/svg-line-markers-may-disappear-in-internet-explorer-11/\r\n    if (_browser === 'ie' && !!defs) {\r\n      // this refresh is intended for redisplaying the SVG during zooming\r\n      defs.parentNode.insertBefore(defs, defs);\r\n      // this refresh is intended for redisplaying the other SVGs on a page when panning a given SVG\r\n      // it is also needed for the given SVG itself, on zoomEnd, if the SVG contains any markers that\r\n      // are located under any other element(s).\r\n      window.setTimeout(function() {\r\n        that.refreshDefsGlobal();\r\n      }, that.internetExplorerRedisplayInterval);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Instantiate an SVGPoint object with given event coordinates\r\n   *\r\n   * @param {Event} evt\r\n   * @param  {SVGSVGElement} svg\r\n   * @return {SVGPoint}     point\r\n   */\r\n, getEventPoint: function(evt, svg) {\r\n    var point = svg.createSVGPoint()\r\n\r\n    Utils.mouseAndTouchNormalize(evt, svg)\r\n\r\n    point.x = evt.clientX\r\n    point.y = evt.clientY\r\n\r\n    return point\r\n  }\r\n\r\n  /**\r\n   * Get SVG center point\r\n   *\r\n   * @param  {SVGSVGElement} svg\r\n   * @return {SVGPoint}\r\n   */\r\n, getSvgCenterPoint: function(svg, width, height) {\r\n    return this.createSVGPoint(svg, width / 2, height / 2)\r\n  }\r\n\r\n  /**\r\n   * Create a SVGPoint with given x and y\r\n   *\r\n   * @param  {SVGSVGElement} svg\r\n   * @param  {Number} x\r\n   * @param  {Number} y\r\n   * @return {SVGPoint}\r\n   */\r\n, createSVGPoint: function(svg, x, y) {\r\n    var point = svg.createSVGPoint()\r\n    point.x = x\r\n    point.y = y\r\n\r\n    return point\r\n  }\r\n}\r\n\n},{\"./utilities\":7}],6:[function(require,module,exports){\n// uniwheel 0.1.2 (customized)\r\n// A unified cross browser mouse wheel event handler\r\n// https://github.com/teemualap/uniwheel\r\n\r\nmodule.exports = (function(){\r\n\r\n  //Full details: https://developer.mozilla.org/en-US/docs/Web/Reference/Events/wheel\r\n\r\n  var prefix = \"\", _addEventListener, _removeEventListener, onwheel, support, fns = [];\r\n\r\n  // detect event model\r\n  if ( window.addEventListener ) {\r\n    _addEventListener = \"addEventListener\";\r\n    _removeEventListener = \"removeEventListener\";\r\n  } else {\r\n    _addEventListener = \"attachEvent\";\r\n    _removeEventListener = \"detachEvent\";\r\n    prefix = \"on\";\r\n  }\r\n\r\n  // detect available wheel event\r\n  support = \"onwheel\" in document.createElement(\"div\") ? \"wheel\" : // Modern browsers support \"wheel\"\r\n            document.onmousewheel !== undefined ? \"mousewheel\" : // Webkit and IE support at least \"mousewheel\"\r\n            \"DOMMouseScroll\"; // let's assume that remaining browsers are older Firefox\r\n\r\n\r\n  function createCallback(element,callback,capture) {\r\n\r\n    var fn = function(originalEvent) {\r\n\r\n      !originalEvent && ( originalEvent = window.event );\r\n\r\n      // create a normalized event object\r\n      var event = {\r\n        // keep a ref to the original event object\r\n        originalEvent: originalEvent,\r\n        target: originalEvent.target || originalEvent.srcElement,\r\n        type: \"wheel\",\r\n        deltaMode: originalEvent.type == \"MozMousePixelScroll\" ? 0 : 1,\r\n        deltaX: 0,\r\n        delatZ: 0,\r\n        preventDefault: function() {\r\n          originalEvent.preventDefault ?\r\n            originalEvent.preventDefault() :\r\n            originalEvent.returnValue = false;\r\n        }\r\n      };\r\n\r\n      // calculate deltaY (and deltaX) according to the event\r\n      if ( support == \"mousewheel\" ) {\r\n        event.deltaY = - 1/40 * originalEvent.wheelDelta;\r\n        // Webkit also support wheelDeltaX\r\n        originalEvent.wheelDeltaX && ( event.deltaX = - 1/40 * originalEvent.wheelDeltaX );\r\n      } else {\r\n        event.deltaY = originalEvent.detail;\r\n      }\r\n\r\n      // it's time to fire the callback\r\n      return callback( event );\r\n\r\n    };\r\n\r\n    fns.push({\r\n      element: element,\r\n      fn: fn,\r\n      capture: capture\r\n    });\r\n\r\n    return fn;\r\n  }\r\n\r\n  function getCallback(element,capture) {\r\n    for (var i = 0; i < fns.length; i++) {\r\n      if (fns[i].element === element && fns[i].capture === capture) {\r\n        return fns[i].fn;\r\n      }\r\n    }\r\n    return function(){};\r\n  }\r\n\r\n  function removeCallback(element,capture) {\r\n    for (var i = 0; i < fns.length; i++) {\r\n      if (fns[i].element === element && fns[i].capture === capture) {\r\n        return fns.splice(i,1);\r\n      }\r\n    }\r\n  }\r\n\r\n  function _addWheelListener( elem, eventName, callback, useCapture ) {\r\n\r\n    var cb;\r\n\r\n    if (support === \"wheel\") {\r\n      cb = callback;\r\n    } else {\r\n      cb = createCallback(elem,callback,useCapture);\r\n    }\r\n\r\n    elem[ _addEventListener ]( prefix + eventName, cb, useCapture || false );\r\n\r\n  }\r\n\r\n  function _removeWheelListener( elem, eventName, callback, useCapture ) {\r\n\r\n    var cb;\r\n\r\n    if (support === \"wheel\") {\r\n      cb = callback;\r\n    } else {\r\n      cb = getCallback(elem,useCapture);\r\n    }\r\n\r\n    elem[ _removeEventListener ]( prefix + eventName, cb, useCapture || false );\r\n\r\n    removeCallback(elem,useCapture);\r\n\r\n  }\r\n\r\n  function addWheelListener( elem, callback, useCapture ) {\r\n    _addWheelListener( elem, support, callback, useCapture );\r\n\r\n    // handle MozMousePixelScroll in older Firefox\r\n    if( support == \"DOMMouseScroll\" ) {\r\n        _addWheelListener( elem, \"MozMousePixelScroll\", callback, useCapture);\r\n    }\r\n  }\r\n\r\n  function removeWheelListener(elem,callback,useCapture){\r\n    _removeWheelListener(elem,support,callback,useCapture);\r\n\r\n    // handle MozMousePixelScroll in older Firefox\r\n    if( support == \"DOMMouseScroll\" ) {\r\n        _removeWheelListener(elem, \"MozMousePixelScroll\", callback, useCapture);\r\n    }\r\n  }\r\n\r\n  return {\r\n    on: addWheelListener,\r\n    off: removeWheelListener\r\n  };\r\n\r\n})();\r\n\n},{}],7:[function(require,module,exports){\nmodule.exports = {\r\n  /**\r\n   * Extends an object\r\n   *\r\n   * @param  {Object} target object to extend\r\n   * @param  {Object} source object to take properties from\r\n   * @return {Object}        extended object\r\n   */\r\n  extend: function(target, source) {\r\n    target = target || {};\r\n    for (var prop in source) {\r\n      // Go recursively\r\n      if (this.isObject(source[prop])) {\r\n        target[prop] = this.extend(target[prop], source[prop])\r\n      } else {\r\n        target[prop] = source[prop]\r\n      }\r\n    }\r\n    return target;\r\n  }\r\n\r\n  /**\r\n   * Checks if an object is a DOM element\r\n   *\r\n   * @param  {Object}  o HTML element or String\r\n   * @return {Boolean}   returns true if object is a DOM element\r\n   */\r\n, isElement: function(o){\r\n    return (\r\n      o instanceof HTMLElement || o instanceof SVGElement || o instanceof SVGSVGElement || //DOM2\r\n      (o && typeof o === 'object' && o !== null && o.nodeType === 1 && typeof o.nodeName === 'string')\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Checks if an object is an Object\r\n   *\r\n   * @param  {Object}  o Object\r\n   * @return {Boolean}   returns true if object is an Object\r\n   */\r\n, isObject: function(o){\r\n    return Object.prototype.toString.call(o) === '[object Object]';\r\n  }\r\n\r\n  /**\r\n   * Checks if variable is Number\r\n   *\r\n   * @param  {Integer|Float}  n\r\n   * @return {Boolean}   returns true if variable is Number\r\n   */\r\n, isNumber: function(n) {\r\n    return !isNaN(parseFloat(n)) && isFinite(n);\r\n  }\r\n\r\n  /**\r\n   * Search for an SVG element\r\n   *\r\n   * @param  {Object|String} elementOrSelector DOM Element or selector String\r\n   * @return {Object|Null}                   SVG or null\r\n   */\r\n, getSvg: function(elementOrSelector) {\r\n    var element\r\n      , svg;\r\n\r\n    if (!this.isElement(elementOrSelector)) {\r\n      // If selector provided\r\n      if (typeof elementOrSelector === 'string' || elementOrSelector instanceof String) {\r\n        // Try to find the element\r\n        element = document.querySelector(elementOrSelector)\r\n\r\n        if (!element) {\r\n          throw new Error('Provided selector did not find any elements. Selector: ' + elementOrSelector)\r\n          return null\r\n        }\r\n      } else {\r\n        throw new Error('Provided selector is not an HTML object nor String')\r\n        return null\r\n      }\r\n    } else {\r\n      element = elementOrSelector\r\n    }\r\n\r\n    if (element.tagName.toLowerCase() === 'svg') {\r\n      svg = element;\r\n    } else {\r\n      if (element.tagName.toLowerCase() === 'object') {\r\n        svg = element.contentDocument.documentElement;\r\n      } else {\r\n        if (element.tagName.toLowerCase() === 'embed') {\r\n          svg = element.getSVGDocument().documentElement;\r\n        } else {\r\n          if (element.tagName.toLowerCase() === 'img') {\r\n            throw new Error('Cannot script an SVG in an \"img\" element. Please use an \"object\" element or an in-line SVG.');\r\n          } else {\r\n            throw new Error('Cannot get SVG.');\r\n          }\r\n          return null\r\n        }\r\n      }\r\n    }\r\n\r\n    return svg\r\n  }\r\n\r\n  /**\r\n   * Attach a given context to a function\r\n   * @param  {Function} fn      Function\r\n   * @param  {Object}   context Context\r\n   * @return {Function}           Function with certain context\r\n   */\r\n, proxy: function(fn, context) {\r\n    return function() {\r\n      return fn.apply(context, arguments)\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Returns object type\r\n   * Uses toString that returns [object SVGPoint]\r\n   * And than parses object type from string\r\n   *\r\n   * @param  {Object} o Any object\r\n   * @return {String}   Object type\r\n   */\r\n, getType: function(o) {\r\n    return Object.prototype.toString.apply(o).replace(/^\\[object\\s/, '').replace(/\\]$/, '')\r\n  }\r\n\r\n  /**\r\n   * If it is a touch event than add clientX and clientY to event object\r\n   *\r\n   * @param  {Event} evt\r\n   * @param  {SVGSVGElement} svg\r\n   */\r\n, mouseAndTouchNormalize: function(evt, svg) {\r\n    // If no cilentX and but touch objects are available\r\n    if (evt.clientX === void 0 || evt.clientX === null) {\r\n      // Fallback\r\n      evt.clientX = 0\r\n      evt.clientY = 0\r\n\r\n      // If it is a touch event\r\n      if (evt.changedTouches !== void 0 && evt.changedTouches.length) {\r\n        // If touch event has changedTouches\r\n        if (evt.changedTouches[0].clientX !== void 0) {\r\n          evt.clientX = evt.changedTouches[0].clientX\r\n          evt.clientY = evt.changedTouches[0].clientY\r\n        }\r\n        // If changedTouches has pageX attribute\r\n        else if (evt.changedTouches[0].pageX !== void 0) {\r\n          var rect = svg.getBoundingClientRect();\r\n\r\n          evt.clientX = evt.changedTouches[0].pageX - rect.left\r\n          evt.clientY = evt.changedTouches[0].pageY - rect.top\r\n        }\r\n      // If it is a custom event\r\n      } else if (evt.originalEvent !== void 0) {\r\n        if (evt.originalEvent.clientX !== void 0) {\r\n          evt.clientX = evt.originalEvent.clientX\r\n          evt.clientY = evt.originalEvent.clientY\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Check if an event is a double click/tap\r\n   * TODO: For touch gestures use a library (hammer.js) that takes in account other events\r\n   * (touchmove and touchend). It should take in account tap duration and traveled distance\r\n   *\r\n   * @param  {Event}  evt\r\n   * @param  {Event}  prevEvt Previous Event\r\n   * @return {Boolean}\r\n   */\r\n, isDblClick: function(evt, prevEvt) {\r\n    // Double click detected by browser\r\n    if (evt.detail === 2) {\r\n      return true;\r\n    }\r\n    // Try to compare events\r\n    else if (prevEvt !== void 0 && prevEvt !== null) {\r\n      var timeStampDiff = evt.timeStamp - prevEvt.timeStamp // should be lower than 250 ms\r\n        , touchesDistance = Math.sqrt(Math.pow(evt.clientX - prevEvt.clientX, 2) + Math.pow(evt.clientY - prevEvt.clientY, 2))\r\n\r\n      return timeStampDiff < 250 && touchesDistance < 10\r\n    }\r\n\r\n    // Nothing found\r\n    return false;\r\n  }\r\n\r\n  /**\r\n   * Returns current timestamp as an integer\r\n   *\r\n   * @return {Number}\r\n   */\r\n, now: Date.now || function() {\r\n    return new Date().getTime();\r\n  }\r\n\r\n  // From underscore.\r\n  // Returns a function, that, when invoked, will only be triggered at most once\r\n  // during a given window of time. Normally, the throttled function will run\r\n  // as much as it can, without ever going more than once per `wait` duration;\r\n  // but if you'd like to disable the execution on the leading edge, pass\r\n  // `{leading: false}`. To disable execution on the trailing edge, ditto.\r\n// jscs:disable\r\n// jshint ignore:start\r\n, throttle: function(func, wait, options) {\r\n    var that = this;\r\n    var context, args, result;\r\n    var timeout = null;\r\n    var previous = 0;\r\n    if (!options) options = {};\r\n    var later = function() {\r\n      previous = options.leading === false ? 0 : that.now();\r\n      timeout = null;\r\n      result = func.apply(context, args);\r\n      if (!timeout) context = args = null;\r\n    };\r\n    return function() {\r\n      var now = that.now();\r\n      if (!previous && options.leading === false) previous = now;\r\n      var remaining = wait - (now - previous);\r\n      context = this;\r\n      args = arguments;\r\n      if (remaining <= 0 || remaining > wait) {\r\n        clearTimeout(timeout);\r\n        timeout = null;\r\n        previous = now;\r\n        result = func.apply(context, args);\r\n        if (!timeout) context = args = null;\r\n      } else if (!timeout && options.trailing !== false) {\r\n        timeout = setTimeout(later, remaining);\r\n      }\r\n      return result;\r\n    };\r\n  }\r\n// jshint ignore:end\r\n// jscs:enable\r\n\r\n  /**\r\n   * Create a requestAnimationFrame simulation\r\n   *\r\n   * @param  {Number|String} refreshRate\r\n   * @return {Function}\r\n   */\r\n, createRequestAnimationFrame: function(refreshRate) {\r\n    var timeout = null\r\n\r\n    // Convert refreshRate to timeout\r\n    if (refreshRate !== 'auto' && refreshRate < 60 && refreshRate > 1) {\r\n      timeout = Math.floor(1000 / refreshRate)\r\n    }\r\n\r\n    if (timeout === null) {\r\n      return window.requestAnimationFrame || requestTimeout(33)\r\n    } else {\r\n      return requestTimeout(timeout)\r\n    }\r\n  }\r\n}\r\n\r\n/**\r\n * Create a callback that will execute after a given timeout\r\n *\r\n * @param  {Function} timeout\r\n * @return {Function}\r\n */\r\nfunction requestTimeout(timeout) {\r\n  return function(callback) {\r\n    window.setTimeout(callback, timeout)\r\n  }\r\n}\r\n\n},{}],8:[function(require,module,exports){\n\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar nodecanvas_1 = require(\"./nodecanvas\");\nvar menu_1 = require(\"./menu\");\nvar CodeNodes = (function () {\n    function CodeNodes(types) {\n        this.nodesCount = 0;\n        var self = this;\n        this.canvas = new nodecanvas_1.NodeCanvas();\n        this.types = types.sort(function (a, b) {\n            return b.name.localeCompare(a.name);\n        }).reverse();\n        this.menu = new menu_1.CodeNodesMenu(this);\n        this.canvas.ondblclick = function (p, rawP) {\n            self.menuPoint = p;\n            self.menu.open(rawP.x + 20, rawP.y - 70);\n        };\n        this.canvas.onclick = function () {\n            self.menu.close();\n        };\n    }\n    ;\n    CodeNodes.prototype.getSVG = function () {\n        this.canvas.render();\n        return this.canvas.svg;\n    };\n    ;\n    CodeNodes.prototype.init = function () {\n        this.canvas.init();\n        this.canvas.svg.appendChild(this.menu.g);\n    };\n    ;\n    CodeNodes.prototype.center = function () {\n        this.canvas.center();\n    };\n    ;\n    CodeNodes.prototype.clear = function () {\n        this.canvas.clear();\n    };\n    CodeNodes.prototype.findType = function (tID) {\n        var i = 0, len = this.types.length;\n        for (; i < len; i++) {\n            if (this.types[i].id === tID)\n                return this.types[i];\n        }\n        return null;\n    };\n    CodeNodes.prototype.collectionTypeOf = function (t) {\n        return {\n            id: t.id,\n            name: t.name,\n            description: \"(Collection) \" + t.description,\n            builder: this.collectionBuilder,\n            clone: this.collectionClone,\n            clonable: t.clonable,\n            outputType: t.outputType,\n            outputMultiple: true,\n            schema: [\n                {\n                    name: \" - \" + t.name,\n                    type: t.id,\n                    mode: \"in\",\n                    options: null,\n                    multiple: false\n                }\n            ]\n        };\n    };\n    CodeNodes.prototype.addNode = function (name, type) {\n        var t = this.findType(type);\n        if (t) {\n            var outputType = t.outputType || type;\n            var ot = this.findType(outputType);\n            t[\"outputType\"] = outputType;\n            if (ot) {\n                var p = this.menuPoint || { x: 10, y: 10 };\n                this.canvas.addNode({\n                    id: this.nodesCount++,\n                    title: name,\n                    type: t,\n                    isCollection: false,\n                    x: p.x,\n                    y: p.y\n                });\n            }\n            else {\n                console.log(\"There is no type \" + outputType + \" registered. Can not assign output type.\");\n            }\n        }\n        else {\n            console.log(\"There is no type \" + type + \" registered\");\n        }\n    };\n    ;\n    CodeNodes.prototype.collectionBuilder = function () {\n        function flatten(arr) {\n            return arr.reduce(function (flat, toFlatten) {\n                return flat.concat(Array.isArray(toFlatten) ? flatten(toFlatten) : toFlatten);\n            }, []);\n        }\n        return flatten(arguments).filter(function (v) {\n            return typeof v !== \"undefined\";\n        });\n    };\n    ;\n    CodeNodes.prototype.collectionClone = function (arr) {\n        return arr;\n        // return arr.map(function (e) {\n        //     return e.clone()\n        // }); TODO: Arreglar això\n    };\n    ;\n    CodeNodes.prototype.addCollection = function (name, ofType) {\n        var t = this.findType(ofType);\n        if (t) {\n            var outputType = t.outputType || ofType;\n            var ot = this.findType(outputType);\n            t[\"outputType\"] = outputType;\n            if (ot) {\n                var p = this.menuPoint || { x: 10, y: 10 };\n                //name, this.collectionBuilder, collectionSchema, ofType, ot.clonable || false, this.collectionClone, true, outputType, p.x, p.y\n                this.canvas.addNode({\n                    id: this.nodesCount++,\n                    title: name,\n                    type: this.collectionTypeOf(t),\n                    isCollection: true,\n                    x: p.x,\n                    y: p.y\n                });\n            }\n            else {\n                console.log(\"There is no type \" + outputType + \" registered. Can not assign output type.\");\n            }\n        }\n        else {\n            console.log(\"There is no type \" + ofType + \" registered\");\n        }\n    };\n    ;\n    CodeNodes.prototype.serialize = function () {\n        return {\n            nodes: this.canvas.serialize(),\n            transform: this.canvas.getTransform()\n        };\n    };\n    ;\n    CodeNodes.prototype.parse = function (model) {\n        var self = this;\n        this.canvas.setTransform(model.transform);\n        self.canvas.parse(model.nodes, this.types);\n    };\n    CodeNodes.prototype.getOfType = function (type) {\n        return this.canvas.getOfType(type);\n    };\n    return CodeNodes;\n}());\nexports.CodeNodes = CodeNodes;\n\n},{\"./menu\":9,\"./nodecanvas\":11}],9:[function(require,module,exports){\n\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar namespace = \"http://www.w3.org/2000/svg\";\nvar CodeNodesMenu = (function () {\n    function CodeNodesMenu(main) {\n        var self = this;\n        var addMode = null;\n        this.main = main;\n        this.g = document.createElementNS(namespace, \"g\");\n        this.g.classList.add(\"menu-g\");\n        var selectedValue = null;\n        var popup = document.createElement(\"div\");\n        popup.classList.add(\"codenodes-menu-popup\");\n        this.popup = popup;\n        var popupLayer = document.createElement(\"div\");\n        popupLayer.classList.add(\"layer\");\n        var popupContent = document.createElement(\"div\");\n        popupContent.classList.add(\"content\");\n        var popupWraper = document.createElement(\"div\");\n        popupWraper.classList.add(\"wraper\");\n        var popupTitle = document.createElement(\"div\");\n        popupTitle.classList.add(\"title\");\n        var entitySelector = document.createElement(\"div\");\n        entitySelector.classList.add(\"select\");\n        var entitySelectorWrap = document.createElement(\"div\");\n        entitySelectorWrap.classList.add(\"entity-selector\");\n        var entityName = document.createElement(\"input\");\n        entityName.type = \"text\";\n        var entityNameWrap = document.createElement(\"div\");\n        entityNameWrap.classList.add(\"entity-name\");\n        var popupOK = document.createElement(\"div\");\n        popupOK.classList.add(\"ok\");\n        popup.appendChild(popupLayer);\n        popup.appendChild(popupWraper);\n        popupWraper.appendChild(popupContent);\n        entityNameWrap.appendChild(entityName);\n        popupContent.appendChild(entityNameWrap);\n        entitySelectorWrap.appendChild(entitySelector);\n        popupContent.appendChild(entitySelectorWrap);\n        popupContent.appendChild(popupOK);\n        document.body.appendChild(popup);\n        popupOK.addEventListener(\"click\", function () {\n            self.close();\n            switch (addMode) {\n                case \"node\":\n                    main.addNode(entityName.value, selectedValue);\n                    break;\n                case \"collection\":\n                    main.addCollection(entityName.value, selectedValue);\n                    break;\n            }\n        });\n        function fillEntitySelector() {\n            entitySelector.innerHTML = \"\";\n            self.main.types.forEach(function (t) {\n                var opt = document.createElement(\"div\");\n                opt.classList.add(\"option\");\n                var name = document.createElement(\"div\");\n                var desc = document.createElement(\"div\");\n                name.classList.add(\"name\");\n                desc.classList.add(\"desc\");\n                name.textContent = t.name;\n                desc.textContent = t.description;\n                opt.appendChild(name);\n                opt.appendChild(desc);\n                opt.addEventListener(\"click\", function () {\n                    [].forEach.call(entitySelector.querySelectorAll(\".option\"), function (o) {\n                        o.classList.remove(\"selected\");\n                    });\n                    opt.classList.add(\"selected\");\n                    selectedValue = t.id;\n                });\n                entitySelector.appendChild(opt);\n            });\n        }\n        var _loop_1 = function (i) {\n            var rect = document.createElementNS(namespace, \"rect\"), t = document.createElementNS(namespace, \"text\");\n            rect.classList.add(\"menu-rect\");\n            t.classList.add(\"menu-t\");\n            rect.setAttribute(\"x\", (5).toString());\n            rect.setAttribute(\"y\", (35 * i).toString());\n            t.setAttribute(\"x\", (10).toString());\n            t.setAttribute(\"y\", ((35 * i) + 19).toString());\n            self.g.appendChild(rect);\n            self.g.appendChild(t);\n            switch (i) {\n                case 0:\n                    t.textContent = \"Add node\";\n                    rect.addEventListener(\"click\", function (evt) {\n                        popupTitle.textContent = t.textContent;\n                        entityName.value = \"New node\";\n                        entityName.focus();\n                        fillEntitySelector();\n                        addMode = \"node\";\n                        popup.classList.add(\"visible\");\n                        evt.stopPropagation();\n                    });\n                    break;\n                case 1:\n                    t.textContent = \"Add collection\";\n                    rect.addEventListener(\"click\", function (evt) {\n                        popupTitle.textContent = t.textContent;\n                        entityName.value = \"New collection\";\n                        entityName.focus();\n                        fillEntitySelector();\n                        addMode = \"collection\";\n                        popup.classList.add(\"visible\");\n                        evt.stopPropagation();\n                    });\n                    break;\n                case 2:\n                    t.textContent = \"Center\";\n                    rect.addEventListener(\"click\", function (evt) {\n                        main.center();\n                        self.close();\n                        evt.stopPropagation();\n                    });\n                    break;\n                case 3:\n                    t.textContent = \"Reset\";\n                    rect.addEventListener(\"click\", function (evt) {\n                        main.clear();\n                        self.close();\n                        evt.stopPropagation();\n                    });\n                    break;\n            }\n        };\n        for (var i = 0; i < 4; i++) {\n            _loop_1(i);\n        }\n    }\n    CodeNodesMenu.prototype.open = function (x, y) {\n        this.g.classList.add(\"visible\");\n        this.g.setAttribute(\"transform\", \"translate(\" + x.toString() + \",\" + y.toString() + \")\");\n        this.g.classList.add(\"visible\");\n    };\n    CodeNodesMenu.prototype.close = function () {\n        this.popup.classList.remove(\"visible\");\n        this.g.classList.remove(\"visible\");\n    };\n    return CodeNodesMenu;\n}());\nexports.CodeNodesMenu = CodeNodesMenu;\n\n},{}],10:[function(require,module,exports){\n\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar nodevalue_1 = require(\"./nodevalue\");\nvar namespace = \"http://www.w3.org/2000/svg\";\nvar ROW_HEIGHT = 38;\nvar Node = (function () {\n    function Node(opts) {\n        this.builtWith = [];\n        var self = this;\n        this.options = opts;\n        this.values = [];\n        this.position = {\n            x: this.options.x,\n            y: this.options.y\n        };\n        this.nRows = this.options.type.schema.length + 2;\n        this.onmousedown = null;\n        this.outputConnectors = [];\n        this.options.type.schema.forEach(function (prop) {\n            self.setValueDefaults(prop);\n            var p = prop;\n            if (self.options.isCollection) {\n                p = self.collectionValueOf(p);\n            }\n            self.values.push(new nodevalue_1.NodeValue(p, self));\n        });\n    }\n    ;\n    Node.prototype.setValueDefaults = function (v) {\n        v.options = v.options || [];\n        v.multiple = v.multiple || false;\n        v.mode = v.mode || \"edit\";\n    };\n    Node.prototype.collectionValueOf = function (v) {\n        return {\n            id: v.id,\n            name: v.name + \" 0\",\n            type: v.type,\n            mode: v.mode,\n            options: v.options,\n            multiple: v.multiple\n        };\n    };\n    Node.prototype.dropPreBuilt = function () {\n        if (this.options.type.ondrop instanceof Function) {\n            this.options.type.ondrop(this.built);\n        }\n        this.built = null;\n    };\n    Node.prototype.render = function (parent) {\n        var self = this;\n        if (!this.g) {\n            this.g = document.createElementNS(namespace, \"g\");\n            this.g.setAttribute(\"transform\", \"translate(\" + this.position.x + \",\" + this.position.y + \")\");\n            this.g.setAttribute(\"class\", \"entity\");\n            this.outputOffset = {\n                x: 130,\n                y: (this.nRows * ROW_HEIGHT) - 10\n            };\n            this.rect = document.createElementNS(namespace, \"rect\");\n            this.rect.setAttribute(\"width\", this.outputOffset.x.toString());\n            this.rect.setAttribute(\"rx\", \"3\");\n            this.rect.setAttribute(\"height\", ((this.nRows * ROW_HEIGHT) + 2).toString());\n            this.rect.setAttribute(\"class\", \"draggable\");\n            this.rectDownHandler = function (evt) {\n                if (this.onmousedown instanceof Function) {\n                    this.onmousedown(evt, this);\n                }\n            }.bind(this);\n            this.rect.addEventListener(\"mousedown\", this.rectDownHandler);\n            var t = document.createElementNS(namespace, \"text\");\n            t.textContent = this.options.title;\n            t.classList.add(\"title\");\n            t.setAttribute(\"x\", \"5\");\n            t.setAttribute(\"y\", \"15\");\n            this.g.appendChild(this.rect);\n            this.g.appendChild(t);\n            var output = document.createElementNS(namespace, \"circle\");\n            this.output = output;\n            output.setAttribute(\"cx\", (this.outputOffset.x).toString());\n            output.setAttribute(\"cy\", (this.outputOffset.y).toString());\n            output.setAttribute(\"r\", \"6\");\n            output.setAttribute(\"class\", \"output\");\n            this.outputDownHandler = function (evt) {\n                if (this.outputMousedown instanceof Function) {\n                    this.outputMousedown(evt, this);\n                }\n            }.bind(this);\n            output.addEventListener(\"mousedown\", this.outputDownHandler);\n            var outputType = document.createElementNS(namespace, \"text\");\n            this.outputText = outputType;\n            if (this.options.type.outputMultiple) {\n                outputType.textContent = \"[\" + this.options.type.outputType + \"]\";\n            }\n            else {\n                outputType.textContent = this.options.type.outputType;\n            }\n            outputType.classList.add(\"output-type\");\n            outputType.setAttribute(\"x\", (this.outputOffset.x - 10).toString());\n            outputType.setAttribute(\"y\", (this.outputOffset.y).toString());\n            this.g.appendChild(output);\n            this.g.appendChild(outputType);\n            this.closeBtn = document.createElementNS(namespace, \"circle\");\n            this.closeBtn.classList.add(\"close-btn\");\n            this.closeBtn.setAttribute(\"cx\", (this.outputOffset.x - 10).toString());\n            this.closeBtn.setAttribute(\"r\", \"6\");\n            this.closeBtn.setAttribute(\"cy\", \"15\");\n            this.close = function () {\n                this.remove();\n            }.bind(this);\n            this.closeBtn.addEventListener(\"click\", this.close);\n            this.g.appendChild(this.closeBtn);\n            parent.appendChild(this.g);\n        }\n        var i = 1;\n        this.values.forEach(function (val) {\n            val.render(self.g, i++);\n        });\n    };\n    ;\n    Node.prototype.cloneLastValue = function () {\n        var self = this;\n        if (this.options.isCollection) {\n            var schema = this.options.type.schema, full = self.values.every(function (val) {\n                return val.inputConnector !== null;\n            });\n            if (full) {\n                var prop = JSON.parse(JSON.stringify(schema[schema.length - 1])), name_1 = prop.name + \" \" + schema.length;\n                schema.push(prop);\n                this.nRows++;\n                var newN = new nodevalue_1.NodeValue(prop, self);\n                self.values.push(newN);\n                newN.render(self.g, schema.length);\n                this.outputOffset.y = (this.nRows * ROW_HEIGHT) - 10;\n                this.output.setAttribute(\"cx\", (this.outputOffset.x).toString());\n                this.output.setAttribute(\"cy\", (this.outputOffset.y).toString());\n                this.outputText.setAttribute(\"y\", (this.outputOffset.y).toString());\n                this.rect.setAttribute(\"height\", ((this.nRows * ROW_HEIGHT) + 2).toString());\n            }\n        }\n    };\n    ;\n    Node.prototype.move = function (x, y) {\n        var self = this;\n        this.position = {\n            x: x,\n            y: y\n        };\n        this.outputConnectors.forEach(function (con) {\n            con.sp = {\n                x: x + self.outputOffset.x,\n                y: y + self.outputOffset.y\n            };\n            con.setPath();\n        });\n        this.values.forEach(function (val) {\n            val.updateConectorPosition();\n        });\n        this.g.setAttribute(\"transform\", \"translate(\" + this.position.x + \",\" + this.position.y + \")\");\n    };\n    ;\n    Node.prototype.serialize = function () {\n        var self = this, model = {\n            arguments: JSON.parse(JSON.stringify(this.options)),\n            values: this.values.map(function (v) {\n                return {\n                    valueID: v.options.id,\n                    value: v.__internalGetValue(true)\n                };\n            }),\n            outputConnectors: this.outputConnectors.map(function (c) {\n                return {\n                    nodeTo: c.end2.parentNode.options.id,\n                    valueTo: c.end2.options.id\n                };\n            })\n        };\n        model.arguments.type = this.options.type.id;\n        model.arguments.x = this.position.x;\n        model.arguments.y = this.position.y;\n        return model;\n    };\n    ;\n    Node.prototype.findValue = function (id) {\n        var i, len = this.values.length;\n        for (i = 0; i < len; i += 1) {\n            if (this.values[i].options.id === id)\n                return this.values[i];\n        }\n        return null;\n    };\n    Node.prototype.setValues = function (vs) {\n        var self = this;\n        if (!this.options.isCollection) {\n            vs.forEach(function (v) {\n                var value = self.values.filter(function (val) {\n                    return val.options.id === v.valueID;\n                })[0];\n                if (value.__internalSetValue instanceof Function) {\n                    value.__internalSetValue(v.value);\n                }\n            });\n        }\n    };\n    ;\n    Node.prototype.checkBuiltWithEquals = function (valuesArr) {\n        if (this.builtWith.length === 0)\n            return false;\n        return this.builtWith.every(function (v, i) {\n            return v === valuesArr[i];\n        });\n    };\n    Node.prototype.build = function () {\n        var schema = this.options.type.schema, valuesArr = [], self = this;\n        valuesArr = this.values.map(function (v) {\n            return v.getValue();\n        });\n        if (!this.checkBuiltWithEquals(valuesArr) && this.built) {\n            this.dropPreBuilt();\n        }\n        if (!this.built || !this.checkBuiltWithEquals(valuesArr)) {\n            this.built = this.options.type.builder.apply(this, valuesArr);\n            this.builtWith = valuesArr;\n            return this.built;\n        }\n        else {\n            if (this.options.type.clonable) {\n                return this.options.type.clone(this.built);\n            }\n            else {\n                return this.built;\n            }\n        }\n    };\n    ;\n    Node.prototype.remove = function () {\n        var self = this;\n        this.values.forEach(function (val) {\n            val.remove();\n        });\n        this.values = null;\n        [].concat(this.outputConnectors).forEach(function (con) {\n            con.remove();\n        });\n        if (this.onremove instanceof Function) {\n            this.onremove();\n        }\n        this.closeBtn.removeEventListener(\"click\", this.close);\n        this.rect.removeEventListener(\"mousedown\", this.rectDownHandler);\n        this.output.addEventListener(\"mousedown\", this.outputDownHandler);\n    };\n    ;\n    return Node;\n}());\nexports.Node = Node;\n\n},{\"./nodevalue\":13}],11:[function(require,module,exports){\n\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar svgPanZoom = require(\"svg-pan-zoom\");\nvar node_1 = require(\"./node\");\nvar nodeconnector_1 = require(\"./nodeconnector\");\nvar namespace = \"http://www.w3.org/2000/svg\";\nvar NodeCanvas = (function () {\n    function NodeCanvas() {\n        this.svg = null;\n        this.g = null;\n        this.paths = null;\n        this.nodes = [];\n        this.pt = null;\n        this.draggingEntity = null;\n        this.currentConnector = null;\n        this.diff = null;\n    }\n    NodeCanvas.prototype.center = function () {\n        this.zoomingSvg.reset();\n    };\n    NodeCanvas.prototype.cursorPoint = function (evt) {\n        this.pt.x = evt.clientX;\n        this.pt.y = evt.clientY;\n        return this.pt.matrixTransform(this.svg.getScreenCTM().inverse());\n    };\n    ;\n    NodeCanvas.prototype.render = function () {\n        var self = this;\n        if (!this.svg) {\n            this.svg = document.createElementNS(namespace, \"svg\");\n            this.svg.setAttribute(\"class\", \"codenodes\");\n            this.pt = this.svg.createSVGPoint();\n            this.svg.setAttributeNS(\"http://www.w3.org/2000/xmlns/\", \"xmlns\", namespace);\n            this.svg.setAttributeNS(\"http://www.w3.org/2000/xmlns/\", \"xmlns:xlink\", \"http://www.w3.org/1999/xlink\");\n            this.svg.setAttribute(\"width\", \"100%\");\n            this.svg.setAttribute(\"height\", \"100%\");\n            this.g = document.createElementNS(namespace, \"g\");\n            this.paths = document.createElementNS(namespace, \"g\");\n            this.g.classList.add(\"svg-pan-zoom_viewport\");\n            this.g.setAttribute(\"transform\", \"matrix(1,1,1,1,0,0)\");\n            this.g.appendChild(this.paths);\n            this.svg.appendChild(this.g);\n            this.svg.addEventListener(\"dblclick\", function (evt) {\n                if (!(evt.target instanceof SVGSVGElement))\n                    return;\n                var p = self.cursorPoint(evt);\n                self.ctm = self.g.getCTM().inverse();\n                self.offset = self.svg.getBoundingClientRect();\n                self.ondblclick(self.convertCoords(p), p);\n            });\n            this.svg.addEventListener(\"click\", function (evt) {\n                self.onclick();\n            });\n        }\n        ;\n    };\n    ;\n    NodeCanvas.prototype.getTransform = function () {\n        var ctm = this.g.getCTM();\n        return {\n            pan: { x: ctm.e, y: ctm.f },\n            zoom: ctm.a\n        };\n    };\n    ;\n    NodeCanvas.prototype.setTransform = function (transform) {\n        this.zoomingSvg.zoom(transform.zoom);\n        this.zoomingSvg.pan(transform.pan);\n    };\n    NodeCanvas.prototype.convertCoords = function (o) {\n        var x = o.x, y = o.y;\n        return {\n            x: (this.ctm.a * x) + (this.ctm.c * y) + this.ctm.e,\n            y: (this.ctm.b * x) + (this.ctm.d * y) + this.ctm.f //- this.offset.top\n        };\n    };\n    NodeCanvas.prototype.addNode = function (opts) {\n        var n = new node_1.Node(opts), self = this;\n        function mouseMoveHandler(evt) {\n            if (self.draggingEntity) {\n                var p = self.cursorPoint(evt);\n                p.x = p.x - self.diff.x;\n                p.y = p.y - self.diff.y;\n                var p1 = self.convertCoords(p);\n                self.draggingEntity.move(p1.x, p1.y);\n            }\n        }\n        function mouseUpHandler(evt) {\n            self.svg.removeEventListener(\"mousemove\", mouseMoveHandler);\n            self.svg.removeEventListener(\"mouseup\", mouseUpHandler);\n            mouseMoveHandler(evt);\n            self.draggingEntity = null;\n        }\n        function mouseMoveConnectorHandler(evt) {\n            var p = self.convertCoords(self.cursorPoint(evt));\n            self.currentConnector.moveEndPoint(p);\n        }\n        function mouseUpConnectorHandler(evt) {\n            var p = self.convertCoords(self.cursorPoint(evt));\n            self.svg.removeEventListener(\"mousemove\", mouseMoveConnectorHandler);\n            self.svg.removeEventListener(\"mouseup\", mouseUpConnectorHandler);\n            var dots = [].slice.call(document.querySelectorAll(\".codenodes .dot\"));\n            var cc = self.currentConnector;\n            var candidates = dots.map(function (dot) {\n                var pos = dot.parentValue.getDotPosition();\n                var dist = Math.sqrt(Math.pow(p.x - pos.x, 2) + Math.pow(p.y - pos.y, 2));\n                return {\n                    dist: dist,\n                    dot: dot\n                };\n            }).filter(function (dot) {\n                return dot.dist <= 30;\n            }).sort(function (a, b) {\n                return a.dist - b.dist;\n            });\n            if (candidates.length > 0) {\n                var candidateDot = candidates[0].dot;\n                if (cc.end1 === candidateDot.parentValue.parentNode) {\n                    cc.remove();\n                    return;\n                }\n                if (candidateDot.parentValue.options.type !== \"any\" && (candidateDot.parentValue.options.type !== cc.end1.options.type.outputType ||\n                    (!candidateDot.parentValue.options.multiple && cc.end1.options.type.outputMultiple))) {\n                    cc.remove();\n                    return;\n                }\n                if (candidateDot.parentValue.inputConnector) {\n                    candidateDot.parentValue.inputConnector.remove();\n                }\n                candidateDot.parentValue.inputConnector = cc;\n                cc.end2 = candidateDot.parentValue;\n                if (cc.end2.parentNode.options.isCollection) {\n                    cc.end2.parentNode.cloneLastValue();\n                }\n                candidateDot.parentValue.updateConectorPosition();\n            }\n            else {\n                cc.remove();\n            }\n            self.currentConnector = null;\n        }\n        this.nodes.push(n);\n        n.outputMousedown = function (evt, entity) {\n            var p = self.cursorPoint(evt);\n            self.ctm = self.g.getCTM().inverse();\n            self.offset = self.svg.getBoundingClientRect();\n            var p1 = {\n                x: entity.position.x + parseInt(entity.outputOffset.x.toString()),\n                y: entity.position.y + parseInt(entity.outputOffset.y.toString())\n            };\n            self.currentConnector = new nodeconnector_1.NodeConnector(p1, entity);\n            entity.outputConnectors.push(self.currentConnector);\n            self.paths.appendChild(self.currentConnector.path);\n            self.svg.addEventListener(\"mousemove\", mouseMoveConnectorHandler);\n            self.svg.addEventListener(\"mouseup\", mouseUpConnectorHandler);\n            evt.stopPropagation();\n        };\n        n.onmousedown = function (evt, entity) {\n            var p = self.cursorPoint(evt);\n            self.ctm = self.g.getCTM();\n            self.offset = self.svg.getBoundingClientRect();\n            var entPos = self.convertCoords(entity.position);\n            self.diff = {\n                x: p.x - entPos.x,\n                y: p.y - entPos.y\n            };\n            self.ctm = self.ctm.inverse();\n            evt.stopPropagation();\n            self.draggingEntity = entity;\n            if (self.draggingEntity) {\n                self.svg.addEventListener(\"mousemove\", mouseMoveHandler);\n                self.svg.addEventListener(\"mouseup\", mouseUpHandler);\n            }\n        }.bind(this);\n        n.onremove = function () {\n            n.outputMousedown = null;\n            n.onmousedown = null;\n            var ind = self.nodes.indexOf(n);\n            if (ind >= 0) {\n                self.nodes.splice(ind, 1);\n            }\n            self.g.removeChild(n.g);\n        };\n        n.render(self.g);\n        return n;\n    };\n    ;\n    NodeCanvas.prototype.init = function () {\n        this.svg.setAttribute(\"viewBox\", \"0 0 \" + this.svg.clientWidth + \" \" + this.svg.clientHeight);\n        this.zoomingSvg = svgPanZoom(this.svg, {\n            zoomScaleSensitivity: 0.4,\n            dblClickZoomEnabled: false,\n            eventsListenerElement: this.svg,\n            restrictEventsListenerEvent: true\n        });\n    };\n    ;\n    NodeCanvas.prototype.serialize = function () {\n        return this.nodes.map(function (n) {\n            return n.serialize();\n        });\n    };\n    NodeCanvas.prototype.findNode = function (id) {\n        var i, len = this.nodes.length;\n        for (i = 0; i < len; i += 1) {\n            if (this.nodes[i].options.id === id)\n                return this.nodes[i];\n        }\n        return null;\n    };\n    NodeCanvas.prototype.findType = function (id, types) {\n        var i = 0, len = types.length;\n        for (; i < len; i++) {\n            if (types[i].id === id)\n                return types[i];\n        }\n        return null;\n    };\n    NodeCanvas.prototype.parse = function (nodes, types) {\n        var _this = this;\n        var self = this;\n        nodes.forEach(function (nm) {\n            var t = _this.findType(nm.arguments.type, types);\n            if (t) {\n                var args = {\n                    id: nm.arguments.id,\n                    title: nm.arguments.title,\n                    type: t,\n                    isCollection: nm.arguments.isCollection,\n                    x: nm.arguments.x,\n                    y: nm.arguments.y\n                };\n                var n = self.addNode(args);\n                n.setValues(nm.values);\n            }\n        });\n        nodes.forEach(function (nm) {\n            var n = self.findNode(nm.arguments.id);\n            nm.outputConnectors.forEach(function (cn) {\n                var end2 = self.findNode(cn.nodeTo);\n                var p1 = {\n                    x: n.position.x + parseInt(n.outputOffset.x.toString()),\n                    y: n.position.y + parseInt(n.outputOffset.y.toString())\n                };\n                var conn = new nodeconnector_1.NodeConnector(p1, n);\n                n.outputConnectors.push(conn);\n                self.paths.appendChild(conn.path);\n                if (end2.options.isCollection) {\n                    end2.cloneLastValue();\n                }\n                var val = end2.findValue(cn.valueTo);\n                val.inputConnector = conn;\n                conn.end2 = val;\n                val.updateConectorPosition();\n            });\n        });\n    };\n    NodeCanvas.prototype.clear = function () {\n        [].concat(this.nodes).forEach(function (node) {\n            node.remove();\n        });\n        this.paths.innerHTML = \"\";\n    };\n    ;\n    NodeCanvas.prototype.getTerminalNodes = function () {\n        return this.nodes.filter(function (n) {\n            return n.outputConnectors.length === 0;\n        });\n    };\n    ;\n    NodeCanvas.prototype.getOfType = function (type) {\n        return this.nodes.filter(function (n) {\n            return n.options.type.id === type;\n        });\n    };\n    return NodeCanvas;\n}());\nexports.NodeCanvas = NodeCanvas;\n\n},{\"./node\":10,\"./nodeconnector\":12,\"svg-pan-zoom\":1}],12:[function(require,module,exports){\n\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar namespace = \"http://www.w3.org/2000/svg\";\nvar NodeConnector = (function () {\n    function NodeConnector(sp, node) {\n        this.sp = sp;\n        this.ep = sp;\n        this.end1 = node;\n        this.end2 = null;\n        this.path = document.createElementNS(namespace, \"path\");\n        this.setPath();\n    }\n    ;\n    NodeConnector.prototype.setPath = function () {\n        var c1 = {\n            x: ((this.ep.x - this.sp.x) / 3) + this.sp.x,\n            y: this.sp.y\n        }, c2 = {\n            x: -((this.ep.x - this.sp.x) / 3) + this.ep.x,\n            y: this.ep.y\n        };\n        this.path.setAttribute(\"d\", \"M\" + this.sp.x + \",\" + this.sp.y + \" C\" + c1.x + \",\" + c1.y + \" \" + c2.x + \",\" + c2.y + \" \" + this.ep.x + \",\" + this.ep.y);\n    };\n    ;\n    NodeConnector.prototype.remove = function () {\n        if (this.end1) {\n            var ind = this.end1.outputConnectors.indexOf(this);\n            if (ind >= 0) {\n                this.end1.outputConnectors.splice(ind, 1);\n            }\n            this.end1 = null;\n        }\n        if (this.end2) {\n            this.end2.inputConnector = null;\n        }\n        if (this.path) {\n            this.path.remove();\n            this.path = null;\n        }\n    };\n    ;\n    NodeConnector.prototype.moveEndPoint = function (point) {\n        this.ep = point;\n        this.setPath();\n    };\n    return NodeConnector;\n}());\nexports.NodeConnector = NodeConnector;\n\n},{}],13:[function(require,module,exports){\n\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar namespace = \"http://www.w3.org/2000/svg\";\nvar ROW_HEIGHT = 38;\nvar NodeValue = (function () {\n    function NodeValue(opts, node) {\n        this.popup = null;\n        this.options = opts;\n        this.inputConnector = null;\n        this.__internalGetValue = null;\n        this.svgEntity = null;\n        this.gOffset = null;\n        this.parentNode = node;\n    }\n    NodeValue.prototype.render = function (parent, position) {\n        var self = this;\n        if (!this.svgEntity) {\n            var ent = document.createElementNS(namespace, \"g\");\n            this.gOffset = {\n                x: 1,\n                y: ((position * ROW_HEIGHT) + 1)\n            };\n            ent.setAttribute(\"transform\", \"translate(\" + this.gOffset.x + \", \" + this.gOffset.y + \")\");\n            ent.setAttribute(\"class\", \"row\");\n            if (this.options.mode === \"edit\") {\n                var rect = document.createElementNS(namespace, \"rect\"), fo = document.createElementNS(namespace, \"foreignObject\"), name_1 = document.createElementNS(namespace, \"text\"), div = document.createElementNS(\"http://www.w3.org/1999/xhtml\", \"div\");\n                name_1.textContent = this.options.name;\n                name_1.setAttribute(\"x\", \"10\");\n                name_1.setAttribute(\"y\", \"6\");\n                rect.setAttribute(\"x\", \"1\");\n                div.setAttribute(\"xmlns\", \"http://www.w3.org/1999/xhtml\");\n                var input_1 = document.createElement(\"input\");\n                switch (this.options.type) {\n                    case \"range\":\n                        input_1.min = this.options[0];\n                        input_1.max = this.options[1];\n                    case \"text\":\n                    case \"number\":\n                    case \"email\":\n                    case \"date\":\n                    case \"color\":\n                        this.__internalGetValue = function () {\n                            return input_1.value;\n                        };\n                        this.__internalSetValue = function (v) {\n                            input_1.value = v;\n                        };\n                        input_1.type = this.options.type;\n                        div.appendChild(input_1);\n                        break;\n                    case \"checkbox\":\n                        this.__internalGetValue = function () {\n                            return input_1.checked;\n                        };\n                        this.__internalSetValue = function (v) {\n                            input_1.checked = v;\n                        };\n                        input_1.type = \"checkbox\";\n                        div.appendChild(input_1);\n                        break;\n                    case \"select\":\n                        var div_select_1 = document.createElement(\"select\");\n                        this.options.options.forEach(function (op) {\n                            var div_option = document.createElement(\"option\");\n                            div_option.textContent = op.show.toString();\n                            div_option.setAttribute(\"value\", op.save);\n                            div_select_1.appendChild(div_option);\n                        });\n                        this.__internalGetValue = function () {\n                            return div_select_1.value;\n                        };\n                        this.__internalSetValue = function (v) {\n                            input_1.value = v;\n                        };\n                        div.appendChild(div_select_1);\n                        break;\n                    case \"popup\":\n                        var btn = document.createElement(\"button\");\n                        btn.classList.add(\"popup-btn\");\n                        btn.textContent = \"*Edit\";\n                        var popup_1 = document.createElement(\"div\");\n                        popup_1.classList.add(\"codenodes-popup\");\n                        this.popup = popup_1;\n                        var popupLayer = document.createElement(\"div\");\n                        popupLayer.classList.add(\"layer\");\n                        var popupContent = document.createElement(\"div\");\n                        popupContent.classList.add(\"content\");\n                        var popupWraper = document.createElement(\"div\");\n                        popupWraper.classList.add(\"wraper\");\n                        var popupTextArea_1 = document.createElement(\"div\");\n                        popupTextArea_1.classList.add(\"text\");\n                        popupTextArea_1.setAttribute(\"contenteditable\", \"true\");\n                        var popupOK = document.createElement(\"div\");\n                        popupOK.classList.add(\"ok\");\n                        btn.addEventListener(\"click\", function () {\n                            popup_1.classList.add(\"visible\");\n                        });\n                        var fnClose = function () {\n                            popup_1.classList.remove(\"visible\");\n                        };\n                        popup_1.appendChild(popupLayer);\n                        popup_1.appendChild(popupWraper);\n                        popupWraper.appendChild(popupContent);\n                        popupContent.appendChild(popupTextArea_1);\n                        popupContent.appendChild(popupOK);\n                        popupOK.addEventListener(\"click\", fnClose);\n                        this.__internalGetValue = function () {\n                            return popupTextArea_1.textContent;\n                        };\n                        this.__internalSetValue = function (v) {\n                            popupTextArea_1.textContent = v;\n                        };\n                        document.body.appendChild(popup_1);\n                        div.appendChild(btn);\n                        break;\n                }\n                fo.appendChild(div);\n                fo.setAttribute(\"transform\", \"translate(0,13)\");\n                //ent.appendChild(rect);\n                ent.appendChild(name_1);\n                ent.appendChild(fo);\n            }\n            if (this.options.mode === \"in\") {\n                var name_2 = document.createElementNS(namespace, \"text\"), type = document.createElementNS(namespace, \"text\"), dot = document.createElementNS(namespace, \"circle\");\n                dot.setAttribute(\"cx\", \"-1\");\n                dot.setAttribute(\"cy\", \"16\");\n                dot.setAttribute(\"r\", \"4\");\n                dot.setAttribute(\"class\", \"dot\");\n                dot.addEventListener(\"click\", function (evt) {\n                    if (self.inputConnector) {\n                        self.inputConnector.remove();\n                    }\n                    evt.stopPropagation();\n                });\n                dot[\"parentValue\"] = this;\n                name_2.textContent = this.options.name;\n                name_2.setAttribute(\"x\", \"10\");\n                name_2.setAttribute(\"y\", \"8\");\n                if (this.options.multiple) {\n                    type.textContent = \"[\" + this.options.type + \"]\";\n                }\n                else {\n                    type.textContent = this.options.type;\n                }\n                type.classList.add(\"value-type\");\n                type.setAttribute(\"x\", \"10\");\n                type.setAttribute(\"y\", \"25\");\n                this.__internalGetValue = function (serializing) {\n                    if (!serializing && self.inputConnector) {\n                        var built = self.inputConnector.end1.build();\n                        if (self.options.multiple && !self.inputConnector.end1.options.type.outputMultiple) {\n                            return [built];\n                        }\n                        else {\n                            return built;\n                        }\n                    }\n                    return undefined;\n                };\n                ent.appendChild(name_2);\n                ent.appendChild(type);\n                ent.appendChild(dot);\n            }\n            this.svgEntity = ent;\n            parent.appendChild(ent);\n        }\n    };\n    ;\n    NodeValue.prototype.getSerializedValue = function () {\n        if (this.options.mode === \"edit\" && this.__internalGetValue instanceof Function) {\n            return this.__internalGetValue();\n        }\n        return null;\n    };\n    NodeValue.prototype.getDotPosition = function () {\n        return {\n            x: this.parentNode.position.x + this.gOffset.x - 1,\n            y: this.parentNode.position.y + this.gOffset.y + 16\n        };\n    };\n    ;\n    NodeValue.prototype.remove = function () {\n        if (this.inputConnector) {\n            this.inputConnector.remove();\n            this.inputConnector = null;\n        }\n        this.svgEntity.remove();\n        this.svgEntity = null;\n        if (this.popup) {\n            document.body.removeChild(this.popup);\n        }\n        this.parentNode = null;\n    };\n    NodeValue.prototype.updateConectorPosition = function () {\n        if (this.inputConnector) {\n            this.inputConnector.ep = this.getDotPosition();\n            this.inputConnector.setPath();\n        }\n    };\n    NodeValue.prototype.getValue = function () {\n        if (this.__internalGetValue instanceof Function) {\n            return this.__internalGetValue();\n        }\n        return null;\n    };\n    return NodeValue;\n}());\nexports.NodeValue = NodeValue;\n\n},{}]},{},[8])(8)\n});"]}