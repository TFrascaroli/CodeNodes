{"version":3,"sources":["node.ts"],"names":[],"mappings":";;AAAA,yCAAsC;AAMtC,IAAM,SAAS,GAAG,4BAA4B,CAAC;AAC/C,IAAM,UAAU,GAAG,EAAE,CAAC;AAEtB;IA6BI,cAAY,KAAa,EAAE,OAAO,EAAE,MAAM,EAAE,IAAI,EAAE,QAAQ,EAAE,OAAO,EAAE,QAAQ,EAAE,UAAU,EAAE,CAAC,EAAE,CAAC;QAC3F,IAAI,IAAI,GAAG,IAAI,CAAC;QAChB,IAAI,CAAC,KAAK,GAAG,KAAK,CAAC;QACnB,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC;QACjB,IAAI,CAAC,MAAM,GAAG,EAAE,CAAC;QACjB,IAAI,CAAC,OAAO,GAAG,OAAO,CAAC;QACvB,IAAI,CAAC,QAAQ,GAAG,QAAQ,CAAC;QACzB,IAAI,CAAC,QAAQ,GAAG,QAAQ,CAAC;QACzB,IAAI,CAAC,UAAU,GAAG,UAAU,CAAC;QAC7B,IAAI,CAAC,OAAO,GAAG,OAAO,CAAC;QACvB,IAAI,CAAC,QAAQ,GAAG;YACZ,CAAC,EAAE,CAAC;YACJ,CAAC,EAAE,CAAC;SACP,CAAC;QACF,IAAI,CAAC,MAAM,GAAG,MAAM,CAAC;QACrB,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC,MAAM,CAAC,MAAM,GAAG,CAAC,CAAC;QACpC,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC;QACxB,IAAI,CAAC,gBAAgB,GAAG,EAAE,CAAC;QAC3B,IAAI,CAAC,MAAM,CAAC,OAAO,CAAC,UAAS,IAAI;YAC7B,IAAI,IAAI,GAAG,IAAI,CAAC,IAAI,CAAC;YACrB,EAAE,CAAC,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC,CAAC;gBAChB,IAAI,IAAI,IAAI,CAAC;YACjB,CAAC;YACD,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,GAAG,IAAI,qBAAS,CAAC,IAAI,EAAE,IAAI,CAAC,IAAI,EAAE,IAAI,CAAC,IAAI,EAAE,IAAI,EAAE,IAAI,CAAC,OAAO,IAAI,EAAE,EAAE,IAAI,CAAC,QAAQ,IAAI,KAAK,CAAC,CAAC;QACpH,CAAC,CAAC,CAAC;IACP,CAAC;IAAA,CAAC;IAEF,qBAAM,GAAN,UAAO,MAAkB;QACrB,IAAI,IAAI,GAAG,IAAI,CAAC;QAChB,EAAE,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC;YACV,IAAI,CAAC,CAAC,GAAG,QAAQ,CAAC,eAAe,CAAC,SAAS,EAAE,GAAG,CAAC,CAAC;YAClD,IAAI,CAAC,CAAC,CAAC,YAAY,CAAC,WAAW,EAAE,YAAY,GAAG,IAAI,CAAC,QAAQ,CAAC,CAAC,GAAG,GAAG,GAAG,IAAI,CAAC,QAAQ,CAAC,CAAC,GAAG,GAAG,CAAC,CAAC;YAC/F,IAAI,CAAC,CAAC,CAAC,YAAY,CAAC,OAAO,EAAE,QAAQ,CAAC,CAAC;YAEvC,IAAI,CAAC,YAAY,GAAG;gBAChB,CAAC,EAAE,GAAG;gBACN,CAAC,EAAE,CAAC,IAAI,CAAC,KAAK,GAAG,UAAU,CAAC,GAAG,EAAE;aACpC,CAAC;YAEF,IAAI,CAAC,IAAI,GAAG,QAAQ,CAAC,eAAe,CAAC,SAAS,EAAE,MAAM,CAAC,CAAC;YACxD,IAAI,CAAC,IAAI,CAAC,YAAY,CAAC,OAAO,EAAE,IAAI,CAAC,YAAY,CAAC,CAAC,CAAC,QAAQ,EAAE,CAAC,CAAC;YAChE,IAAI,CAAC,IAAI,CAAC,YAAY,CAAC,IAAI,EAAE,GAAG,CAAC,CAAC;YAClC,IAAI,CAAC,IAAI,CAAC,YAAY,CAAC,QAAQ,EAAE,CAAC,CAAC,IAAI,CAAC,KAAK,GAAG,UAAU,CAAC,GAAG,CAAC,CAAC,CAAC,QAAQ,EAAE,CAAC,CAAC;YAC7E,IAAI,CAAC,IAAI,CAAC,YAAY,CAAC,OAAO,EAAE,WAAW,CAAC,CAAC;YAC7C,IAAI,CAAC,eAAe,GAAG,UAAS,GAAG;gBAC/B,EAAE,CAAC,CAAC,IAAI,CAAC,WAAW,YAAY,QAAQ,CAAC,CAAC,CAAC;oBACvC,IAAI,CAAC,WAAW,CAAC,GAAG,EAAE,IAAI,CAAC,CAAC;gBAChC,CAAC;YACL,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;YACb,IAAI,CAAC,IAAI,CAAC,gBAAgB,CAAC,WAAW,EAAE,IAAI,CAAC,eAAe,CAAC,CAAC;YAG9D,IAAI,CAAC,GAAG,QAAQ,CAAC,eAAe,CAAC,SAAS,EAAE,MAAM,CAAC,CAAC;YACpD,CAAC,CAAC,WAAW,GAAG,IAAI,CAAC,KAAK,CAAC;YAC3B,CAAC,CAAC,SAAS,CAAC,GAAG,CAAC,OAAO,CAAC,CAAC;YACzB,CAAC,CAAC,YAAY,CAAC,GAAG,EAAE,GAAG,CAAC,CAAC;YACzB,CAAC,CAAC,YAAY,CAAC,GAAG,EAAE,IAAI,CAAC,CAAC;YAE1B,IAAI,CAAC,CAAC,CAAC,WAAW,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;YAC9B,IAAI,CAAC,CAAC,CAAC,WAAW,CAAC,CAAC,CAAC,CAAC;YAEtB,IAAI,MAAM,GAAG,QAAQ,CAAC,eAAe,CAAC,SAAS,EAAE,QAAQ,CAAC,CAAC;YAC3D,IAAI,CAAC,MAAM,GAAG,MAAM,CAAC;YACrB,MAAM,CAAC,YAAY,CAAC,IAAI,EAAE,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC,CAAC,CAAC,QAAQ,EAAE,CAAC,CAAC;YAC5D,MAAM,CAAC,YAAY,CAAC,IAAI,EAAE,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC,CAAC,CAAC,QAAQ,EAAE,CAAC,CAAC;YAC5D,MAAM,CAAC,YAAY,CAAC,GAAG,EAAE,GAAG,CAAC,CAAC;YAC9B,MAAM,CAAC,YAAY,CAAC,OAAO,EAAE,QAAQ,CAAC,CAAC;YACvC,IAAI,CAAC,iBAAiB,GAAG,UAAS,GAAG;gBACjC,EAAE,CAAC,CAAC,IAAI,CAAC,eAAe,YAAY,QAAQ,CAAC,CAAC,CAAC;oBAC3C,IAAI,CAAC,eAAe,CAAC,GAAG,EAAE,IAAI,CAAC,CAAC;gBACpC,CAAC;YACL,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;YACb,MAAM,CAAC,gBAAgB,CAAC,WAAW,EAAE,IAAI,CAAC,iBAAiB,CAAC,CAAC;YAC7D,IAAI,UAAU,GAAG,QAAQ,CAAC,eAAe,CAAC,SAAS,EAAE,MAAM,CAAC,CAAC;YAC7D,IAAI,CAAC,UAAU,GAAG,UAAU,CAAC;YAC7B,EAAE,CAAC,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC,CAAC;gBAChB,UAAU,CAAC,WAAW,GAAG,GAAG,GAAG,IAAI,CAAC,UAAU,GAAG,GAAG,CAAC;YACzD,CAAC;YAAC,IAAI,CAAC,CAAC;gBACJ,UAAU,CAAC,WAAW,GAAG,IAAI,CAAC,UAAU,CAAC;YAC7C,CAAC;YACD,UAAU,CAAC,SAAS,CAAC,GAAG,CAAC,aAAa,CAAC,CAAC;YACxC,UAAU,CAAC,YAAY,CAAC,GAAG,EAAE,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC,GAAG,EAAE,CAAC,CAAC,QAAQ,EAAE,CAAC,CAAC;YACpE,UAAU,CAAC,YAAY,CAAC,GAAG,EAAE,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC,CAAC,CAAC,QAAQ,EAAE,CAAC,CAAC;YAC/D,IAAI,CAAC,CAAC,CAAC,WAAW,CAAC,MAAM,CAAC,CAAC;YAC3B,IAAI,CAAC,CAAC,CAAC,WAAW,CAAC,UAAU,CAAC,CAAC;YAG/B,IAAI,CAAC,QAAQ,GAAG,QAAQ,CAAC,eAAe,CAAC,SAAS,EAAE,QAAQ,CAAC,CAAC;YAC9D,IAAI,CAAC,QAAQ,CAAC,SAAS,CAAC,GAAG,CAAC,WAAW,CAAC,CAAC;YACzC,IAAI,CAAC,QAAQ,CAAC,YAAY,CAAC,IAAI,EAAE,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC,GAAG,EAAE,CAAC,CAAC,QAAQ,EAAE,CAAC,CAAC;YACxE,IAAI,CAAC,QAAQ,CAAC,YAAY,CAAC,GAAG,EAAE,GAAG,CAAC,CAAC;YACrC,IAAI,CAAC,QAAQ,CAAC,YAAY,CAAC,IAAI,EAAE,IAAI,CAAC,CAAC;YAC1C,IAAI,CAAC,KAAK,GAAG;gBAClB,IAAI,CAAC,MAAM,EAAE,CAAC;YACN,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;YACb,IAAI,CAAC,QAAQ,CAAC,gBAAgB,CAAC,OAAO,EAAE,IAAI,CAAC,KAAK,CAAC,CAAC;YACpD,IAAI,CAAC,CAAC,CAAC,WAAW,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;YAElC,MAAM,CAAC,WAAW,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;QAC/B,CAAC;QACD,IAAI,CAAC,GAAG,CAAC,CAAC;QAEV,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC,OAAO,CAAC,UAAS,CAAC;YACvC,EAAE,CAAC,CAAC,IAAI,CAAC,MAAM,CAAC,cAAc,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;gBAChC,IAAI,GAAG,GAAG,IAAI,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC;gBACzB,GAAG,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;YAC5B,CAAC;QACL,CAAC,CAAC,CAAC;IACP,CAAC;IAAA,CAAC;IACF,6BAAc,GAAd;QACI,IAAI,IAAI,GAAG,IAAI,CAAC;QAChB,EAAE,CAAC,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC,CAAC;YAChB,IAAI,IAAI,GAAG,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC,KAAK,CAAC,UAAC,CAAS;gBAChD,IAAI,GAAG,GAAc,IAAI,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC;gBACpC,MAAM,CAAC,CAAC,IAAI,CAAC,MAAM,CAAC,cAAc,CAAC,CAAC,CAAC,IAAI,GAAG,CAAC,cAAc,KAAK,IAAI,CAAC;YACzE,CAAC,CAAC,CAAC;YACH,EAAE,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC;gBACP,IAAI,IAAI,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC,CAAC,EACtE,MAAI,GAAG,IAAI,CAAC,IAAI,GAAG,GAAG,GAAG,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC;gBAChD,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;gBACvB,IAAI,CAAC,KAAK,EAAE,CAAC;gBACb,IAAI,CAAC,MAAM,CAAC,MAAI,CAAC,GAAG,IAAI,qBAAS,CAAC,MAAI,EAAE,IAAI,CAAC,IAAI,EAAE,IAAI,CAAC,IAAI,EAAE,IAAI,EAAE,IAAI,CAAC,OAAO,IAAI,EAAE,EAAE,IAAI,CAAC,QAAQ,IAAI,KAAK,CAAC,CAAC;gBAChH,IAAI,CAAC,MAAM,CAAC,MAAI,CAAC,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC,EAAE,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC;gBACrD,IAAI,CAAC,YAAY,CAAC,CAAC,GAAG,CAAC,IAAI,CAAC,KAAK,GAAG,UAAU,CAAC,GAAG,EAAE,CAAC;gBAErD,IAAI,CAAC,MAAM,CAAC,YAAY,CAAC,IAAI,EAAE,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC,CAAC,CAAC,QAAQ,EAAE,CAAC,CAAC;gBACjE,IAAI,CAAC,MAAM,CAAC,YAAY,CAAC,IAAI,EAAE,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC,CAAC,CAAC,QAAQ,EAAE,CAAC,CAAC;gBACjE,IAAI,CAAC,UAAU,CAAC,YAAY,CAAC,GAAG,EAAE,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC,CAAC,CAAC,QAAQ,EAAE,CAAC,CAAC;gBACpE,IAAI,CAAC,IAAI,CAAC,YAAY,CAAC,QAAQ,EAAE,CAAC,CAAC,IAAI,CAAC,KAAK,GAAG,UAAU,CAAC,GAAG,CAAC,CAAC,CAAC,QAAQ,EAAE,CAAC,CAAC;YACjF,CAAC;QACL,CAAC;IACL,CAAC;IAAA,CAAC;IACF,mBAAI,GAAJ,UAAK,CAAC,EAAE,CAAC;QACL,IAAI,IAAI,GAAG,IAAI,CAAC;QAChB,IAAI,CAAC,QAAQ,GAAG;YACZ,CAAC,EAAE,CAAC;YACJ,CAAC,EAAE,CAAC;SACP,CAAC;QACF,IAAI,CAAC,gBAAgB,CAAC,OAAO,CAAC,UAAS,GAAG;YACtC,GAAG,CAAC,EAAE,GAAG;gBACL,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,YAAY,CAAC,CAAC;gBAC1B,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,YAAY,CAAC,CAAC;aAC7B,CAAC;YACF,GAAG,CAAC,OAAO,EAAE,CAAC;QAClB,CAAC,CAAC,CAAC;QAEH,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC,OAAO,CAAC,UAAS,CAAC;YACvC,EAAE,CAAC,CAAC,IAAI,CAAC,MAAM,CAAC,cAAc,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;gBAChC,IAAI,GAAG,GAAG,IAAI,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC;gBACzB,GAAG,CAAC,sBAAsB,EAAE,CAAC;YACjC,CAAC;QACL,CAAC,CAAC,CAAC;QACH,IAAI,CAAC,CAAC,CAAC,YAAY,CAAC,WAAW,EAAE,YAAY,GAAG,IAAI,CAAC,QAAQ,CAAC,CAAC,GAAG,GAAG,GAAG,IAAI,CAAC,QAAQ,CAAC,CAAC,GAAG,GAAG,CAAC,CAAC;IACnG,CAAC;IAAA,CAAC;IAEF,oBAAK,GAAL;QACI,EAAE,CAAC,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC;YACvB,IAAI,SAAS,GAAG,EAAE,EACjB,YAAY,GAAG,EAAE,EACjB,IAAI,GAAG,IAAI,CAAC;YACb,YAAY,GAAG,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC,UAAS,CAAC;gBAC3C,MAAM,CAAC,CAAC,CAAC,OAAO,CAAC;YAClB,CAAC,CAAC,CAAC;YACH,SAAS,GAAG,YAAY,CAAC,GAAG,CAAC,UAAS,CAAC;gBACtC,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,QAAQ,EAAE,CAAC;YACvC,CAAC,CAAC,CAAC;YACH,IAAI,CAAC,KAAK,GAAI,IAAI,CAAC,OAAO,CAAC,KAAK,CAAC,IAAI,EAAE,SAAS,CAAC,CAAC;YAClD,MAAM,CAAC,IAAI,CAAC,KAAK,CAAC;QACnB,CAAC;QAAC,IAAI,CAAC,CAAC;YACP,EAAE,CAAC,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC,CAAC;gBACnB,MAAM,CAAC,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;YACjC,CAAC;YAAC,IAAI,CAAC,CAAC;gBACP,MAAM,CAAC,IAAI,CAAC,KAAK,CAAC;YACnB,CAAC;QACF,CAAC;IACC,CAAC;IAAA,CAAC;IAEF,qBAAM,GAAN;QACI,IAAI,IAAI,GAAG,IAAI,CAAC;QAChB,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC,OAAO,CAAC,UAAS,CAAC;YACvC,EAAE,CAAC,CAAC,IAAI,CAAC,MAAM,CAAC,cAAc,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;gBAChC,IAAI,GAAG,GAAG,IAAI,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC;gBACzB,EAAE,CAAC,CAAC,GAAG,CAAC,cAAc,CAAC,CAAC,CAAC;oBACrB,GAAG,CAAC,cAAc,CAAC,MAAM,EAAE,CAAC;gBAChC,CAAC;gBAAA,CAAC;YACN,CAAC;QACL,CAAC,CAAC,CAAC;QACH,EAAE,CAAC,MAAM,CAAC,IAAI,CAAC,gBAAgB,CAAC,CAAC,OAAO,CAAC,UAAS,GAAG;YACjD,GAAG,CAAC,MAAM,EAAE,CAAC;QACjB,CAAC,CAAC,CAAC;QACT,EAAE,CAAC,CAAC,IAAI,CAAC,QAAQ,YAAY,QAAQ,CAAC,CAAC,CAAC;YACvC,IAAI,CAAC,QAAQ,EAAE,CAAC;QACjB,CAAC;QACK,IAAI,CAAC,QAAQ,CAAC,mBAAmB,CAAC,OAAO,EAAE,IAAI,CAAC,KAAK,CAAC,CAAC;QACvD,IAAI,CAAC,IAAI,CAAC,mBAAmB,CAAC,WAAW,EAAE,IAAI,CAAC,eAAe,CAAC,CAAC;QACjE,IAAI,CAAC,MAAM,CAAC,gBAAgB,CAAC,WAAW,EAAE,IAAI,CAAC,iBAAiB,CAAC,CAAC;IACtE,CAAC;IAAA,CAAC;IACN,WAAC;AAAD,CAlOA,AAkOC,IAAA;AAlOY,oBAAI","file":"node.js","sourcesContent":["import {NodeValue} from \"./nodevalue\";\r\nimport {NodeConnector} from \"./nodeconnector\";\r\nimport {Point} from \"./point\";\r\nimport {ICodeNodesValueSchema} from \"./ICodeNodesValueSchema\";\r\n\r\n\r\nconst namespace = \"http://www.w3.org/2000/svg\";\r\nconst ROW_HEIGHT = 38;\r\n\r\nexport class Node {\r\n\r\n    private title: string;\r\n    private rect: SVGRectElement;\r\n    public g: SVGGElement;\r\n    private output: SVGCircleElement;\r\n    private closeBtn: SVGCircleElement;\r\n    private built: any;\r\n    private builder: Function;\r\n    private clonefn: Function;\r\n    private clonable: boolean;\r\n    public multiple: boolean;\r\n    private outputOffset: Point;\r\n    public type: string;\r\n    public outputType: string;\r\n    private outputText: SVGTextElement;\r\n    private values: {[valueName:string]:NodeValue};\r\n    public position: Point;\r\n    private schema: Array<ICodeNodesValueSchema>; // Canviar això a l'interfície correcta.\r\n    private nRows: number;\r\n    public onmousedown: Function;\r\n    public outputMousedown: Function;\r\n    public rectDownHandler: EventListenerOrEventListenerObject;\r\n    public outputConnectors: Array<NodeConnector>;\r\n    public outputDownHandler: EventListenerOrEventListenerObject;\r\n    private close: EventListenerOrEventListenerObject;\r\n    public onremove: Function;\r\n\r\n\r\n    constructor(title: string, builder, schema, type, clonable, clonefn, multiple, outputType, x, y) {\r\n        let self = this;\r\n        this.title = title;\r\n        this.type = type;\r\n        this.values = {};\r\n        this.clonefn = clonefn;\r\n        this.clonable = clonable;\r\n        this.multiple = multiple;\r\n        this.outputType = outputType;\r\n        this.builder = builder;\r\n        this.position = {\r\n            x: x,\r\n            y: y\r\n        };\r\n        this.schema = schema;\r\n        this.nRows = this.schema.length + 2;\r\n        this.onmousedown = null;\r\n        this.outputConnectors = [];\r\n        this.schema.forEach(function(prop) {\r\n            let name = prop.name;\r\n            if (self.multiple) {\r\n                name += \" 0\";\r\n            }\r\n            self.values[name] = new NodeValue(name, prop.type, prop.mode, self, prop.options || [], prop.multiple || false);\r\n        });\r\n    };\r\n\r\n    render(parent: SVGElement) {\r\n        let self = this;\r\n        if (!this.g) {\r\n            this.g = document.createElementNS(namespace, \"g\");\r\n            this.g.setAttribute(\"transform\", \"translate(\" + this.position.x + \",\" + this.position.y + \")\");\r\n            this.g.setAttribute(\"class\", \"entity\");\r\n\r\n            this.outputOffset = {\r\n                x: 130,\r\n                y: (this.nRows * ROW_HEIGHT) - 10\r\n            };\r\n\r\n            this.rect = document.createElementNS(namespace, \"rect\");\r\n            this.rect.setAttribute(\"width\", this.outputOffset.x.toString());\r\n            this.rect.setAttribute(\"rx\", \"3\");\r\n            this.rect.setAttribute(\"height\", ((this.nRows * ROW_HEIGHT) + 2).toString());\r\n            this.rect.setAttribute(\"class\", \"draggable\");\r\n            this.rectDownHandler = function(evt) {\r\n                if (this.onmousedown instanceof Function) {\r\n                    this.onmousedown(evt, this);\r\n                }\r\n            }.bind(this);\r\n            this.rect.addEventListener(\"mousedown\", this.rectDownHandler);\r\n\r\n\r\n            let t = document.createElementNS(namespace, \"text\");\r\n            t.textContent = this.title;\r\n            t.classList.add(\"title\");\r\n            t.setAttribute(\"x\", \"5\");\r\n            t.setAttribute(\"y\", \"15\");\r\n\r\n            this.g.appendChild(this.rect);\r\n            this.g.appendChild(t);\r\n\r\n            let output = document.createElementNS(namespace, \"circle\");\r\n            this.output = output;\r\n            output.setAttribute(\"cx\", (this.outputOffset.x).toString());\r\n            output.setAttribute(\"cy\", (this.outputOffset.y).toString());\r\n            output.setAttribute(\"r\", \"6\");\r\n            output.setAttribute(\"class\", \"output\");\r\n            this.outputDownHandler = function(evt) {\r\n                if (this.outputMousedown instanceof Function) {\r\n                    this.outputMousedown(evt, this);\r\n                }\r\n            }.bind(this);\r\n            output.addEventListener(\"mousedown\", this.outputDownHandler);\r\n            let outputType = document.createElementNS(namespace, \"text\");\r\n            this.outputText = outputType;\r\n            if (this.multiple) {  \r\n                outputType.textContent = \"[\" + this.outputType + \"]\";\r\n            } else {\r\n                outputType.textContent = this.outputType;\r\n            }\r\n            outputType.classList.add(\"output-type\");\r\n            outputType.setAttribute(\"x\", (this.outputOffset.x - 10).toString());\r\n            outputType.setAttribute(\"y\", (this.outputOffset.y).toString());\r\n            this.g.appendChild(output);\r\n            this.g.appendChild(outputType);\r\n\r\n\r\n            this.closeBtn = document.createElementNS(namespace, \"circle\");\r\n            this.closeBtn.classList.add(\"close-btn\");\r\n            this.closeBtn.setAttribute(\"cx\", (this.outputOffset.x - 10).toString());\r\n            this.closeBtn.setAttribute(\"r\", \"6\");\r\n            this.closeBtn.setAttribute(\"cy\", \"15\");\r\n        \tthis.close = function() {\r\n\t\t\t\tthis.remove();\r\n            }.bind(this);\r\n            this.closeBtn.addEventListener(\"click\", this.close);\r\n            this.g.appendChild(this.closeBtn);\r\n\r\n            parent.appendChild(this.g);\r\n        }\r\n        let i = 1;\r\n\r\n        Object.keys(this.values).forEach(function(k) {\r\n            if (self.values.hasOwnProperty(k)) {\r\n                let val = self.values[k];\r\n                val.render(self.g, i++);\r\n            }\r\n        });\r\n    };\r\n    cloneLastValue () {\r\n        let self = this;\r\n        if (this.multiple) {\r\n            let full = Object.keys(self.values).every((k: string):boolean => {\r\n                let val: NodeValue = self.values[k];\r\n                return !self.values.hasOwnProperty(k) || val.inputConnector !== null;\r\n            });\r\n            if (full) {\r\n                let prop = JSON.parse(JSON.stringify(this.schema[this.schema.length - 1])),\r\n                    name = prop.name + \" \" + this.schema.length;\r\n                this.schema.push(prop);\r\n                this.nRows++;\r\n                self.values[name] = new NodeValue(name, prop.type, prop.mode, self, prop.options || [], prop.multiple || false);\r\n                self.values[name].render(self.g, this.schema.length);\r\n                this.outputOffset.y = (this.nRows * ROW_HEIGHT) - 10;\r\n                \r\n                this.output.setAttribute(\"cx\", (this.outputOffset.x).toString());\r\n                this.output.setAttribute(\"cy\", (this.outputOffset.y).toString());\r\n                this.outputText.setAttribute(\"y\", (this.outputOffset.y).toString());\r\n                this.rect.setAttribute(\"height\", ((this.nRows * ROW_HEIGHT) + 2).toString());\r\n            }\r\n        }\r\n    };\r\n    move(x, y) {\r\n        let self = this;\r\n        this.position = {\r\n            x: x,\r\n            y: y\r\n        };\r\n        this.outputConnectors.forEach(function(con) {\r\n            con.sp = {\r\n                x: x + self.outputOffset.x,\r\n                y: y + self.outputOffset.y\r\n            };\r\n            con.setPath();\r\n        });\r\n\r\n        Object.keys(this.values).forEach(function(k) {\r\n            if (self.values.hasOwnProperty(k)) {\r\n                let val = self.values[k];\r\n                val.updateConectorPosition();\r\n            }\r\n        });\r\n        this.g.setAttribute(\"transform\", \"translate(\" + this.position.x + \",\" + this.position.y + \")\");\r\n    };\r\n\r\n    build() {\r\n        if (!this.built) {\r\n\t\t\tvar valuesArr = [],\r\n\t\t\t\tpropsOnBuild = [],\r\n\t\t\t\tself = this;\r\n\t\t\tpropsOnBuild = this.schema.filter(function(p) {\r\n\t\t\t\treturn p.onBuild;\r\n\t\t\t});\r\n\t\t\tvaluesArr = propsOnBuild.map(function(p) {\r\n\t\t\t\treturn self.values[p.name].getValue();\r\n\t\t\t});\r\n\t\t\tthis.built =  this.builder.apply(this, valuesArr);\r\n\t\t\treturn this.built;\r\n\t\t} else {\r\n\t\t\tif (this.clonable) {\r\n\t\t\t\treturn this.clonefn(this.built);\r\n\t\t\t} else {\r\n\t\t\t\treturn this.built;\r\n\t\t\t}\r\n\t\t}\r\n    };\r\n\r\n    remove() {\r\n        let self = this;\r\n        Object.keys(this.values).forEach(function(k) {\r\n            if (self.values.hasOwnProperty(k)) {\r\n                let val = self.values[k];\r\n                if (val.inputConnector) {\r\n                    val.inputConnector.remove();\r\n                };\r\n            }\r\n        });\r\n        [].concat(this.outputConnectors).forEach(function(con) {\r\n            con.remove();\r\n        });\r\n\t\tif (this.onremove instanceof Function) {\r\n\t\t\tthis.onremove();\r\n\t\t}\r\n        this.closeBtn.removeEventListener(\"click\", this.close);\r\n        this.rect.removeEventListener(\"mousedown\", this.rectDownHandler);\r\n        this.output.addEventListener(\"mousedown\", this.outputDownHandler);\r\n    };\r\n}"]}